{"remainingRequest":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\babel-loader\\lib\\index.js!E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\src\\components\\Ebook\\EbookReader.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\src\\components\\Ebook\\EbookReader.vue","mtime":1588147537659},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5qb2luIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5tYXRjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yIjsKaW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJFOlxcSm9kUHJlcGFyYXRpb25cXFByYWN0aWNlXFxcdTk4NzlcdTc2RUVcXGh1aWh1by1lYm9va1xcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgRXB1YiBmcm9tICdlcHVianMnOwppbXBvcnQgeyBlYm9va01peGluIH0gZnJvbSAnLi4vLi4vdXRpbHMvbWl4aW4nOwppbXBvcnQgeyBnZXRGb250RmFtaWx5LCBzYXZlRm9udEZhbWlseSwgZ2V0Rm9udFNpemUsIHNhdmVGb250U2l6ZSwgZ2V0VGhlbWUsIHNhdmVUaGVtZSwgZ2V0TG9jYXRpb24gfSBmcm9tICcuLi8uLi91dGlscy9sb2NhbFN0b3JhZ2UnOwpnbG9iYWwuZVB1YiA9IEVwdWI7CmV4cG9ydCBkZWZhdWx0IHsKICBtaXhpbnM6IFtlYm9va01peGluXSwKICBtZXRob2RzOiB7CiAgICBtb3ZlOiBmdW5jdGlvbiBtb3ZlKGUpIHsKICAgICAgdmFyIG9mZnNldFkgPSAwOwoKICAgICAgaWYgKHRoaXMuZmlyc3RPZmZzZXRZKSB7CiAgICAgICAgb2Zmc2V0WSA9IGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WSAtIHRoaXMuZmlyc3RPZmZzZXRZOwogICAgICAgIHRoaXMuc2V0T2Zmc2V0WShvZmZzZXRZKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmZpcnN0T2Zmc2V0WSA9IGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WTsKICAgICAgfQoKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgfSwKICAgIG1vdmVFbmQ6IGZ1bmN0aW9uIG1vdmVFbmQoZSkgewogICAgICB0aGlzLnNldE9mZnNldFkoMCk7CiAgICAgIHRoaXMuZmlyc3RPZmZzZXRZID0gMDsKICAgIH0sCiAgICBvbk1vdXNlRW50ZXI6IGZ1bmN0aW9uIG9uTW91c2VFbnRlcihlKSB7CiAgICAgIHRoaXMubW91c2VNb3ZlID0gMTsKICAgICAgdGhpcy5tb3VzZVN0YXJ0VGltZSA9IGUudGltZVN0YW1wOwogICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICB9LAogICAgb25Nb3VzZU1vdmU6IGZ1bmN0aW9uIG9uTW91c2VNb3ZlKGUpIHsKICAgICAgaWYgKHRoaXMubW91c2VNb3ZlID09PSAxKSB7CiAgICAgICAgdGhpcy5tb3VzZU1vdmUgPSAyOwogICAgICB9IGVsc2UgaWYgKHRoaXMubW91c2VNb3ZlID09PSAyKSB7CiAgICAgICAgdmFyIG9mZnNldFkgPSAwOwoKICAgICAgICBpZiAodGhpcy5maXJzdE9mZnNldFkpIHsKICAgICAgICAgIG9mZnNldFkgPSBlLmNsaWVudFkgLSB0aGlzLmZpcnN0T2Zmc2V0WTsKICAgICAgICAgIHRoaXMuc2V0T2Zmc2V0WShvZmZzZXRZKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5maXJzdE9mZnNldFkgPSBlLmNsaWVudFk7CiAgICAgICAgfQogICAgICB9CgogICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICB9LAogICAgb25Nb3VzZUVuZDogZnVuY3Rpb24gb25Nb3VzZUVuZChlKSB7CiAgICAgIGlmICh0aGlzLm1vdXNlTW92ZSA9PT0gMikgewogICAgICAgIHRoaXMuc2V0T2Zmc2V0WSgwKTsKICAgICAgICB0aGlzLmZpcnN0T2Zmc2V0WSA9IDA7CiAgICAgICAgdGhpcy5tb3VzZU1vdmUgPSAzOwogICAgICB9CgogICAgICB0aGlzLm1vdXNlRW5kVGltZSA9IGUudGltZVN0YW1wOwogICAgICB2YXIgdGltZSA9IHRoaXMubW91c2VFbmRUaW1lIC0gdGhpcy5tb3VzZVN0YXJ0VGltZTsKCiAgICAgIGlmICh0aW1lIDwgMjAwKSB7CiAgICAgICAgdGhpcy5tb3VzZU1vdmUgPSAxOwogICAgICB9CgogICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICB9LAogICAgb25NYXNrQ2xpY2s6IGZ1bmN0aW9uIG9uTWFza0NsaWNrKGUpIHsKICAgICAgdmFyIG9mZnNldFggPSBlLm9mZnNldFg7CiAgICAgIHZhciB3aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoOwoKICAgICAgaWYgKG9mZnNldFggPiAwICYmIG9mZnNldFggPCB3aWR0aCAqIDAuMykgewogICAgICAgIHRoaXMucHJldlBhZ2UoKTsKICAgICAgfSBlbHNlIGlmIChvZmZzZXRYID4gMCAmJiBvZmZzZXRYID4gd2lkdGggKiAwLjcpIHsKICAgICAgICB0aGlzLm5leHRQYWdlKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy50b2dnbGVUaXRsZUFuZE1lbnUoKTsKICAgICAgfQogICAgfSwKICAgIHByZXZQYWdlOiBmdW5jdGlvbiBwcmV2UGFnZSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIC8v6LCD55SoUmVuZGl0aW9u55qEcHJlduaWueazlei/lOWbnuS4iuS4gOmhtQogICAgICBpZiAodGhpcy5yZW5kaXRpb24pIHsKICAgICAgICB0aGlzLnJlbmRpdGlvbi5wcmV2KCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy5yZWZyZXNoTG9jYXRpb24oKTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdGhpcy5oaWRlVGl0bGVBbmRNZW51KCk7CiAgICB9LAogICAgbmV4dFBhZ2U6IGZ1bmN0aW9uIG5leHRQYWdlKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIC8v6LCD55SoUmVuZGl0aW9u55qEbmV4dOaWueazlei/lOWbnuS4iuS4gOmhtQogICAgICBpZiAodGhpcy5yZW5kaXRpb24pIHsKICAgICAgICB0aGlzLnJlbmRpdGlvbi5uZXh0KCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpczIucmVmcmVzaExvY2F0aW9uKCk7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHRoaXMuaGlkZVRpdGxlQW5kTWVudSgpOwogICAgfSwKICAgIHRvZ2dsZVRpdGxlQW5kTWVudTogZnVuY3Rpb24gdG9nZ2xlVGl0bGVBbmRNZW51KCkgewogICAgICBpZiAodGhpcy5tZW51VmlzaWJsZSkgewogICAgICAgIHRoaXMuc2V0U2V0dGluZ1Zpc2libGUoLTEpOwogICAgICAgIHRoaXMuc2V0Rm9udEZhbWlseVZpc2libGUoZmFsc2UpOwogICAgICB9CgogICAgICB0aGlzLnNldE1lbnVWaXNpYmxlKCF0aGlzLm1lbnVWaXNpYmxlKTsKICAgIH0sCiAgICBpbml0Rm9udFNpemU6IGZ1bmN0aW9uIGluaXRGb250U2l6ZSgpIHsKICAgICAgLy/or7vlj5Zsb2NhbFN0b3JhZ2XkuK3nmoRGb250U2l6ZQogICAgICB2YXIgZm9udFNpemUgPSBnZXRGb250U2l6ZSh0aGlzLmZpbGVuYW1lKTsKCiAgICAgIGlmIChmb250U2l6ZSkgewogICAgICAgIHRoaXMucmVuZGl0aW9uLnRoZW1lcy5mb250U2l6ZShmb250U2l6ZSk7CiAgICAgICAgdGhpcy5zZXREZWZhdWx0Rm9udFNpemUoZm9udFNpemUpOwogICAgICB9IGVsc2UgewogICAgICAgIHNhdmVGb250U2l6ZSh0aGlzLmZpbGVuYW1lLCB0aGlzLmRlZmF1bHRGb250U2l6ZSk7CiAgICAgIH0KICAgIH0sCiAgICBpbml0Rm9udEZhbWlseTogZnVuY3Rpb24gaW5pdEZvbnRGYW1pbHkoKSB7CiAgICAgIC8v6K+75Y+WbG9jYWxTdG9yYWdl5Lit55qERm9udAogICAgICB2YXIgZm9udCA9IGdldEZvbnRGYW1pbHkodGhpcy5maWxlbmFtZSk7CgogICAgICBpZiAoZm9udCkgewogICAgICAgIHRoaXMucmVuZGl0aW9uLnRoZW1lcy5mb250KGZvbnQpOwogICAgICAgIHRoaXMuc2V0RGVmYXVsdEZvbnRGYW1pbHkoZm9udCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2F2ZUZvbnRGYW1pbHkodGhpcy5maWxlbmFtZSwgdGhpcy5kZWZhdWx0Rm9udEZhbWlseSk7CiAgICAgIH0KICAgIH0sCiAgICBpbml0VGhlbWU6IGZ1bmN0aW9uIGluaXRUaGVtZSgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICAvL+WIneWni+WMluS4u+mimAogICAgICB2YXIgZGVmYXVsdFRoZW1lID0gZ2V0VGhlbWUodGhpcy5maWxlbmFtZSk7CgogICAgICBpZiAoIWRlZmF1bHRUaGVtZSkgewogICAgICAgIGRlZmF1bHRUaGVtZSA9IHRoaXMudGhlbWVMaXN0WzBdLm5hbWU7CiAgICAgICAgc2F2ZVRoZW1lKHRoaXMuZmlsZW5hbWUsIGRlZmF1bHRUaGVtZSk7CiAgICAgIH0KCiAgICAgIHRoaXMuc2V0RGVmYXVsdFRoZW1lKGRlZmF1bHRUaGVtZSk7CiAgICAgIHRoaXMudGhlbWVMaXN0LmZvckVhY2goZnVuY3Rpb24gKHRoZW1lKSB7CiAgICAgICAgX3RoaXMzLnJlbmRpdGlvbi50aGVtZXMucmVnaXN0ZXIodGhlbWUubmFtZSwgdGhlbWUuc3R5bGUpOwogICAgICB9KTsKICAgICAgdGhpcy5yZW5kaXRpb24udGhlbWVzLnNlbGVjdChkZWZhdWx0VGhlbWUpOwogICAgfSwKICAgIGluaXRHZXN0dXJlOiBmdW5jdGlvbiBpbml0R2VzdHVyZSgpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB0aGlzLnJlbmRpdGlvbi5vbigndG91Y2hzdGFydCcsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIF90aGlzNC50b3VjaFN0YXJ0WCA9IGV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFg7CiAgICAgICAgX3RoaXM0LnRvdWNoU3RhcnRUaW1lID0gZXZlbnQudGltZVN0YW1wOwogICAgICB9KTsKICAgICAgdGhpcy5yZW5kaXRpb24ub24oJ3RvdWNoZW5kJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgdmFyIG9mZnNldFggPSBldmVudC5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRYIC0gX3RoaXM0LnRvdWNoU3RhcnRYOwogICAgICAgIHZhciB0aW1lID0gZXZlbnQudGltZVN0YW1wIC0gX3RoaXM0LnRvdWNoU3RhcnRUaW1lOyAvL+agueaNruaJi+WKv+S6i+S7tuWunueOsOe/u+mhteWKn+iDvQoKICAgICAgICBpZiAodGltZSA8IDUwMCAmJiBvZmZzZXRYID4gNDApIHsKICAgICAgICAgIF90aGlzNC5wcmV2UGFnZSgpOwogICAgICAgIH0gZWxzZSBpZiAodGltZSA8IDUwMCAmJiBvZmZzZXRYIDwgLTQwKSB7CiAgICAgICAgICBfdGhpczQubmV4dFBhZ2UoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3RoaXM0LnRvZ2dsZVRpdGxlQW5kTWVudSgpOwogICAgICAgIH0gLy/nu4Tnu4fpu5jorqTkuovku7blkozlhpLms6EKCgogICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgIH0pOwogICAgfSwKICAgIGluaXRSZW5kaXRpb246IGZ1bmN0aW9uIGluaXRSZW5kaXRpb24oKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgLy/nlJ/miJBSZW5kaXRpb27lr7nosaEKICAgICAgdGhpcy5yZW5kaXRpb24gPSB0aGlzLmJvb2sucmVuZGVyVG8oJ3JlYWQnLCB7CiAgICAgICAgd2lkdGg6IHdpbmRvdy5pbm5lcldpZHRoLAogICAgICAgIGhlaWdodDogd2luZG93LmlubmVySGVpZ2h0LAogICAgICAgIG1ldGhvZDogJ2RlZmF1bHQnCiAgICAgIH0pOyAvL+mAmui/h1JlbmRpdGlvbuWvueixoeeahGRpc3BsYXnmlrnms5XmuLLmn5PnlLXlrZDkuaYKCiAgICAgIHZhciBsb2NhdGlvbiA9IGdldExvY2F0aW9uKHRoaXMuZmlsZW5hbWUpOwogICAgICB0aGlzLmRpc3BsYXkobG9jYXRpb24sIGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczUuaW5pdEZvbnRTaXplKCk7CgogICAgICAgIF90aGlzNS5pbml0Rm9udEZhbWlseSgpOwoKICAgICAgICBfdGhpczUuaW5pdFRoZW1lKCk7CgogICAgICAgIF90aGlzNS5pbml0R2xvYmFsU3R5bGUoKTsKICAgICAgfSk7CiAgICAgIHRoaXMucmVuZGl0aW9uLmhvb2tzLmNvbnRlbnQucmVnaXN0ZXIoZnVuY3Rpb24gKGNvbnRlbnRzKSB7CiAgICAgICAgUHJvbWlzZS5hbGwoW2NvbnRlbnRzLmFkZFN0eWxlc2hlZXQoIiIuY29uY2F0KHByb2Nlc3MuZW52LlZVRV9BUFBfUkVTX1VSTCwgIi9mb250cy9jYWJpbi5jc3MiKSksIGNvbnRlbnRzLmFkZFN0eWxlc2hlZXQoIiIuY29uY2F0KHByb2Nlc3MuZW52LlZVRV9BUFBfUkVTX1VSTCwgIi9mb250cy9tb250c2VycmF0LmNzcyIpKSwgY29udGVudHMuYWRkU3R5bGVzaGVldCgiIi5jb25jYXQocHJvY2Vzcy5lbnYuVlVFX0FQUF9SRVNfVVJMLCAiL2ZvbnRzL3RhbmdlcmluZS5jc3MiKSksIGNvbnRlbnRzLmFkZFN0eWxlc2hlZXQoIiIuY29uY2F0KHByb2Nlc3MuZW52LlZVRV9BUFBfUkVTX1VSTCwgIi9mb250cy9kYXlzT25lLmNzcyIpKV0pLnRoZW4oZnVuY3Rpb24gKCkge30pOwogICAgICB9KTsKICAgIH0sCiAgICBwYXJzZUJvb2s6IGZ1bmN0aW9uIHBhcnNlQm9vaygpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICAvL+ino+aekOeUteWtkOS5pueahOWwgemdogogICAgICB0aGlzLmJvb2subG9hZGVkLmNvdmVyLnRoZW4oZnVuY3Rpb24gKGNvdmVyKSB7CiAgICAgICAgX3RoaXM2LmJvb2suYXJjaGl2ZS5jcmVhdGVVcmwoY292ZXIpLnRoZW4oZnVuY3Rpb24gKHVybCkgewogICAgICAgICAgX3RoaXM2LnNldENvdmVyKHVybCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICB0aGlzLmJvb2subG9hZGVkLm1ldGFkYXRhLnRoZW4oZnVuY3Rpb24gKG1ldGFkYXRhKSB7CiAgICAgICAgX3RoaXM2LnNldE1ldGFkYXRhKG1ldGFkYXRhKTsKICAgICAgfSk7CiAgICAgIHRoaXMuYm9vay5sb2FkZWQubmF2aWdhdGlvbi50aGVuKGZ1bmN0aW9uIChuYXYpIHsKICAgICAgICAvL2NvbnNvbGUubG9nKG5hdikKICAgICAgICAvL+iOt+WPlueUteWtkOS5pueahOebruW9lQogICAgICAgIHZhciBuYXZJdGVtID0gZnVuY3Rpb24gZmxhdHRlbihhcnIpIHsKICAgICAgICAgIHZhciBfcmVmOwoKICAgICAgICAgIHJldHVybiAoX3JlZiA9IFtdKS5jb25jYXQuYXBwbHkoX3JlZiwgX3RvQ29uc3VtYWJsZUFycmF5KGFyci5tYXAoZnVuY3Rpb24gKHYpIHsKICAgICAgICAgICAgcmV0dXJuIFt2XS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KGZsYXR0ZW4odi5zdWJpdGVtcykpKTsKICAgICAgICAgIH0pKSk7CiAgICAgICAgfShuYXYudG9jKTsgLy/lsIbmoJHnirbnm67lvZXnu5PmnoTovazljJbkuLrkuIDnu7TmlbDnu4QKCgogICAgICAgIGZ1bmN0aW9uIGZpbmQoaXRlbSkgewogICAgICAgICAgdmFyIHYgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IDA7CiAgICAgICAgICB2YXIgcGFyZW50ID0gbmF2SXRlbS5maWx0ZXIoZnVuY3Rpb24gKGl0KSB7CiAgICAgICAgICAgIHJldHVybiBpdC5pZCA9PT0gaXRlbS5wYXJlbnQ7CiAgICAgICAgICB9KVswXTsKICAgICAgICAgIHJldHVybiAhaXRlbS5wYXJlbnQgPyB2IDogcGFyZW50ID8gZmluZChwYXJlbnQsICsrdikgOiB2OwogICAgICAgIH0KCiAgICAgICAgbmF2SXRlbS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICBpdGVtLmxldmVsID0gZmluZChpdGVtKTsKICAgICAgICAgIGl0ZW0udG90YWwgPSAwOwogICAgICAgICAgaXRlbS5wYWdlbGlzdCA9IFtdOwoKICAgICAgICAgIGlmIChpdGVtLmhyZWYubWF0Y2goL14oLiopXC5odG1sJC8pKSB7CiAgICAgICAgICAgIGl0ZW0uaWRocmVmID0gaXRlbS5ocmVmLm1hdGNoKC9eKC4qKVwuaHRtbCQvKVsxXTsKICAgICAgICAgIH0gZWxzZSBpZiAoaXRlbS5ocmVmLm1hdGNoKC9eKC4qKVwueGh0bWwkLykpIHsKICAgICAgICAgICAgaXRlbS5pZGhyZWYgPSBpdGVtLmhyZWYubWF0Y2goL14oLiopXC54aHRtbCQvKVsxXTsKICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgX3RoaXM2LnNldE5hdmlnYXRpb24obmF2SXRlbSk7CiAgICAgIH0pOwogICAgfSwKICAgIGluaXRFcHViOiBmdW5jdGlvbiBpbml0RXB1YigpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CgogICAgICB2YXIgdXJsID0gcHJvY2Vzcy5lbnYuVlVFX0FQUF9SRVNfVVJMICsgJy9lcHViLycgKyB0aGlzLmZpbGVuYW1lICsgJy5lcHViJzsgLy/nlLXlrZDkuabnmoTop6PmnpDlkozmuLLmn5MKICAgICAgLy/nlJ/miJBFYm9va+WvueixoQoKICAgICAgdGhpcy5ib29rID0gbmV3IEVwdWIodXJsKTsKICAgICAgdGhpcy5zZXRDdXJyZW50Qm9vayh0aGlzLmJvb2spOwogICAgICB0aGlzLmluaXRSZW5kaXRpb24oKTsKICAgICAgdGhpcy5pbml0R2VzdHVyZSgpOwogICAgICB0aGlzLnBhcnNlQm9vaygpOwogICAgICB0aGlzLmJvb2sucmVhZHkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgLy/liIbpobUKICAgICAgICByZXR1cm4gX3RoaXM3LmJvb2subG9jYXRpb25zLmdlbmVyYXRlKDc1MCAqICh3aW5kb3cuaW5uZXJXaWR0aCAvIDM3NSkgKiAoZ2V0Rm9udFNpemUoX3RoaXM3LmZpbGVuYW1lKSAvIDE2KSk7CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGxvY2F0aW9ucykgewogICAgICAgIC8vY29uc29sZS5sb2cobG9jYXRpb25zKTsKICAgICAgICBfdGhpczcuc2V0Qm9va0F2YWlsYWJsZSh0cnVlKTsKCiAgICAgICAgX3RoaXM3LnJlZnJlc2hMb2NhdGlvbigpOwogICAgICB9KTsKICAgIH0KICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB2YXIgX3RoaXM4ID0gdGhpczsKCiAgICB2YXIgZmlsZW5hbWUgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuZmlsZW5hbWUuc3BsaXQoJ3wnKS5qb2luKCcvJyk7IC8v6I635Y+W6Z2Z5oCB6LWE5rqQ55qE6Lev5b6ECgogICAgdGhpcy5zZXRGaWxlbmFtZShmaWxlbmFtZSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgIF90aGlzOC5pbml0RXB1YigpOwogICAgfSk7CiAgfQp9Ow=="},{"version":3,"sources":["EbookReader.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAeA,OAAA,IAAA,MAAA,QAAA;AACA,SAAA,UAAA,QAAA,mBAAA;AACA,SACA,aADA,EAEA,cAFA,EAGA,WAHA,EAIA,YAJA,EAKA,QALA,EAMA,SANA,EAOA,WAPA,QAQA,0BARA;AASA,MAAA,CAAA,IAAA,GAAA,IAAA;AACA,eAAA;AACA,EAAA,MAAA,EAAA,CAAA,UAAA,CADA;AAEA,EAAA,OAAA,EAAA;AACA,IAAA,IADA,gBACA,CADA,EACA;AACA,UAAA,OAAA,GAAA,CAAA;;AACA,UAAA,KAAA,YAAA,EAAA;AACA,QAAA,OAAA,GAAA,CAAA,CAAA,cAAA,CAAA,CAAA,EAAA,OAAA,GAAA,KAAA,YAAA;AACA,aAAA,UAAA,CAAA,OAAA;AACA,OAHA,MAGA;AACA,aAAA,YAAA,GAAA,CAAA,CAAA,cAAA,CAAA,CAAA,EAAA,OAAA;AACA;;AACA,MAAA,CAAA,CAAA,cAAA;AACA,MAAA,CAAA,CAAA,eAAA;AACA,KAXA;AAYA,IAAA,OAZA,mBAYA,CAZA,EAYA;AACA,WAAA,UAAA,CAAA,CAAA;AACA,WAAA,YAAA,GAAA,CAAA;AACA,KAfA;AAgBA,IAAA,YAhBA,wBAgBA,CAhBA,EAgBA;AACA,WAAA,SAAA,GAAA,CAAA;AACA,WAAA,cAAA,GAAA,CAAA,CAAA,SAAA;AACA,MAAA,CAAA,CAAA,cAAA;AACA,MAAA,CAAA,CAAA,eAAA;AACA,KArBA;AAsBA,IAAA,WAtBA,uBAsBA,CAtBA,EAsBA;AACA,UAAA,KAAA,SAAA,KAAA,CAAA,EAAA;AACA,aAAA,SAAA,GAAA,CAAA;AACA,OAFA,MAEA,IAAA,KAAA,SAAA,KAAA,CAAA,EAAA;AACA,YAAA,OAAA,GAAA,CAAA;;AACA,YAAA,KAAA,YAAA,EAAA;AACA,UAAA,OAAA,GAAA,CAAA,CAAA,OAAA,GAAA,KAAA,YAAA;AACA,eAAA,UAAA,CAAA,OAAA;AACA,SAHA,MAGA;AACA,eAAA,YAAA,GAAA,CAAA,CAAA,OAAA;AACA;AACA;;AACA,MAAA,CAAA,CAAA,cAAA;AACA,MAAA,CAAA,CAAA,eAAA;AACA,KApCA;AAqCA,IAAA,UArCA,sBAqCA,CArCA,EAqCA;AACA,UAAA,KAAA,SAAA,KAAA,CAAA,EAAA;AACA,aAAA,UAAA,CAAA,CAAA;AACA,aAAA,YAAA,GAAA,CAAA;AACA,aAAA,SAAA,GAAA,CAAA;AACA;;AACA,WAAA,YAAA,GAAA,CAAA,CAAA,SAAA;AACA,UAAA,IAAA,GAAA,KAAA,YAAA,GAAA,KAAA,cAAA;;AACA,UAAA,IAAA,GAAA,GAAA,EAAA;AACA,aAAA,SAAA,GAAA,CAAA;AACA;;AACA,MAAA,CAAA,CAAA,cAAA;AACA,MAAA,CAAA,CAAA,eAAA;AACA,KAlDA;AAmDA,IAAA,WAnDA,uBAmDA,CAnDA,EAmDA;AACA,UAAA,OAAA,GAAA,CAAA,CAAA,OAAA;AACA,UAAA,KAAA,GAAA,MAAA,CAAA,UAAA;;AACA,UAAA,OAAA,GAAA,CAAA,IAAA,OAAA,GAAA,KAAA,GAAA,GAAA,EAAA;AACA,aAAA,QAAA;AACA,OAFA,MAEA,IAAA,OAAA,GAAA,CAAA,IAAA,OAAA,GAAA,KAAA,GAAA,GAAA,EAAA;AACA,aAAA,QAAA;AACA,OAFA,MAEA;AACA,aAAA,kBAAA;AACA;AACA,KA7DA;AA8DA,IAAA,QA9DA,sBA8DA;AAAA;;AACA;AACA,UAAA,KAAA,SAAA,EAAA;AACA,aAAA,SAAA,CAAA,IAAA,GAAA,IAAA,CAAA,YAAA;AACA,UAAA,KAAA,CAAA,eAAA;AACA,SAFA;AAGA;;AACA,WAAA,gBAAA;AACA,KAtEA;AAuEA,IAAA,QAvEA,sBAuEA;AAAA;;AACA;AACA,UAAA,KAAA,SAAA,EAAA;AACA,aAAA,SAAA,CAAA,IAAA,GAAA,IAAA,CAAA,YAAA;AACA,UAAA,MAAA,CAAA,eAAA;AACA,SAFA;AAGA;;AACA,WAAA,gBAAA;AACA,KA/EA;AAgFA,IAAA,kBAhFA,gCAgFA;AACA,UAAA,KAAA,WAAA,EAAA;AACA,aAAA,iBAAA,CAAA,CAAA,CAAA;AACA,aAAA,oBAAA,CAAA,KAAA;AACA;;AACA,WAAA,cAAA,CAAA,CAAA,KAAA,WAAA;AACA,KAtFA;AAwFA,IAAA,YAxFA,0BAwFA;AACA;AACA,UAAA,QAAA,GAAA,WAAA,CAAA,KAAA,QAAA,CAAA;;AACA,UAAA,QAAA,EAAA;AACA,aAAA,SAAA,CAAA,MAAA,CAAA,QAAA,CAAA,QAAA;AACA,aAAA,kBAAA,CAAA,QAAA;AACA,OAHA,MAGA;AACA,QAAA,YAAA,CAAA,KAAA,QAAA,EAAA,KAAA,eAAA,CAAA;AACA;AACA,KAjGA;AAkGA,IAAA,cAlGA,4BAkGA;AACA;AACA,UAAA,IAAA,GAAA,aAAA,CAAA,KAAA,QAAA,CAAA;;AACA,UAAA,IAAA,EAAA;AACA,aAAA,SAAA,CAAA,MAAA,CAAA,IAAA,CAAA,IAAA;AACA,aAAA,oBAAA,CAAA,IAAA;AACA,OAHA,MAGA;AACA,QAAA,cAAA,CAAA,KAAA,QAAA,EAAA,KAAA,iBAAA,CAAA;AACA;AACA,KA3GA;AA4GA,IAAA,SA5GA,uBA4GA;AAAA;;AACA;AACA,UAAA,YAAA,GAAA,QAAA,CAAA,KAAA,QAAA,CAAA;;AACA,UAAA,CAAA,YAAA,EAAA;AACA,QAAA,YAAA,GAAA,KAAA,SAAA,CAAA,CAAA,EAAA,IAAA;AACA,QAAA,SAAA,CAAA,KAAA,QAAA,EAAA,YAAA,CAAA;AACA;;AACA,WAAA,eAAA,CAAA,YAAA;AACA,WAAA,SAAA,CAAA,OAAA,CAAA,UAAA,KAAA,EAAA;AACA,QAAA,MAAA,CAAA,SAAA,CAAA,MAAA,CAAA,QAAA,CAAA,KAAA,CAAA,IAAA,EAAA,KAAA,CAAA,KAAA;AACA,OAFA;AAGA,WAAA,SAAA,CAAA,MAAA,CAAA,MAAA,CAAA,YAAA;AACA,KAxHA;AAyHA,IAAA,WAzHA,yBAyHA;AAAA;;AACA,WAAA,SAAA,CAAA,EAAA,CAAA,YAAA,EAAA,UAAA,KAAA,EAAA;AACA,QAAA,MAAA,CAAA,WAAA,GAAA,KAAA,CAAA,cAAA,CAAA,CAAA,EAAA,OAAA;AACA,QAAA,MAAA,CAAA,cAAA,GAAA,KAAA,CAAA,SAAA;AACA,OAHA;AAIA,WAAA,SAAA,CAAA,EAAA,CAAA,UAAA,EAAA,UAAA,KAAA,EAAA;AACA,YAAA,OAAA,GAAA,KAAA,CAAA,cAAA,CAAA,CAAA,EAAA,OAAA,GAAA,MAAA,CAAA,WAAA;AACA,YAAA,IAAA,GAAA,KAAA,CAAA,SAAA,GAAA,MAAA,CAAA,cAAA,CAFA,CAGA;;AACA,YAAA,IAAA,GAAA,GAAA,IAAA,OAAA,GAAA,EAAA,EAAA;AACA,UAAA,MAAA,CAAA,QAAA;AACA,SAFA,MAEA,IAAA,IAAA,GAAA,GAAA,IAAA,OAAA,GAAA,CAAA,EAAA,EAAA;AACA,UAAA,MAAA,CAAA,QAAA;AACA,SAFA,MAEA;AACA,UAAA,MAAA,CAAA,kBAAA;AACA,SAVA,CAWA;;;AACA,QAAA,KAAA,CAAA,cAAA;AACA,QAAA,KAAA,CAAA,eAAA;AACA,OAdA;AAeA,KA7IA;AA8IA,IAAA,aA9IA,2BA8IA;AAAA;;AACA;AACA,WAAA,SAAA,GAAA,KAAA,IAAA,CAAA,QAAA,CAAA,MAAA,EAAA;AACA,QAAA,KAAA,EAAA,MAAA,CAAA,UADA;AAEA,QAAA,MAAA,EAAA,MAAA,CAAA,WAFA;AAGA,QAAA,MAAA,EAAA;AAHA,OAAA,CAAA,CAFA,CAOA;;AACA,UAAA,QAAA,GAAA,WAAA,CAAA,KAAA,QAAA,CAAA;AACA,WAAA,OAAA,CAAA,QAAA,EAAA,YAAA;AACA,QAAA,MAAA,CAAA,YAAA;;AACA,QAAA,MAAA,CAAA,cAAA;;AACA,QAAA,MAAA,CAAA,SAAA;;AACA,QAAA,MAAA,CAAA,eAAA;AACA,OALA;AAMA,WAAA,SAAA,CAAA,KAAA,CAAA,OAAA,CAAA,QAAA,CAAA,UAAA,QAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,CACA,QAAA,CAAA,aAAA,WACA,OAAA,CAAA,GAAA,CAAA,eADA,sBADA,EAIA,QAAA,CAAA,aAAA,WACA,OAAA,CAAA,GAAA,CAAA,eADA,2BAJA,EAOA,QAAA,CAAA,aAAA,WACA,OAAA,CAAA,GAAA,CAAA,eADA,0BAPA,EAUA,QAAA,CAAA,aAAA,WACA,OAAA,CAAA,GAAA,CAAA,eADA,wBAVA,CAAA,EAaA,IAbA,CAaA,YAAA,CAAA,CAbA;AAcA,OAfA;AAgBA,KA7KA;AA8KA,IAAA,SA9KA,uBA8KA;AAAA;;AACA;AACA,WAAA,IAAA,CAAA,MAAA,CAAA,KAAA,CAAA,IAAA,CAAA,UAAA,KAAA,EAAA;AACA,QAAA,MAAA,CAAA,IAAA,CAAA,OAAA,CAAA,SAAA,CAAA,KAAA,EAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,UAAA,MAAA,CAAA,QAAA,CAAA,GAAA;AACA,SAFA;AAGA,OAJA;AAKA,WAAA,IAAA,CAAA,MAAA,CAAA,QAAA,CAAA,IAAA,CAAA,UAAA,QAAA,EAAA;AACA,QAAA,MAAA,CAAA,WAAA,CAAA,QAAA;AACA,OAFA;AAGA,WAAA,IAAA,CAAA,MAAA,CAAA,UAAA,CAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA;AACA;AACA,YAAA,OAAA,GAAA,SAAA,OAAA,CAAA,GAAA,EAAA;AAAA;;AACA,iBAAA,YAAA,MAAA,gCAAA,GAAA,CAAA,GAAA,CAAA,UAAA,CAAA;AAAA,oBAAA,CAAA,4BAAA,OAAA,CAAA,CAAA,CAAA,QAAA,CAAA;AAAA,WAAA,CAAA,EAAA;AACA,SAFA,CAEA,GAAA,CAAA,GAFA,CAAA,CAHA,CAMA;;;AACA,iBAAA,IAAA,CAAA,IAAA,EAAA;AAAA,cAAA,CAAA,uEAAA,CAAA;AACA,cAAA,MAAA,GAAA,OAAA,CAAA,MAAA,CAAA,UAAA,EAAA;AAAA,mBAAA,EAAA,CAAA,EAAA,KAAA,IAAA,CAAA,MAAA;AAAA,WAAA,EAAA,CAAA,CAAA;AACA,iBAAA,CAAA,IAAA,CAAA,MAAA,GAAA,CAAA,GAAA,MAAA,GAAA,IAAA,CAAA,MAAA,EAAA,EAAA,CAAA,CAAA,GAAA,CAAA;AACA;;AAEA,QAAA,OAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA;AACA,UAAA,IAAA,CAAA,KAAA,GAAA,IAAA,CAAA,IAAA,CAAA;AACA,UAAA,IAAA,CAAA,KAAA,GAAA,CAAA;AACA,UAAA,IAAA,CAAA,QAAA,GAAA,EAAA;;AACA,cAAA,IAAA,CAAA,IAAA,CAAA,KAAA,CAAA,cAAA,CAAA,EAAA;AACA,YAAA,IAAA,CAAA,MAAA,GAAA,IAAA,CAAA,IAAA,CAAA,KAAA,CAAA,cAAA,EAAA,CAAA,CAAA;AACA,WAFA,MAEA,IAAA,IAAA,CAAA,IAAA,CAAA,KAAA,CAAA,eAAA,CAAA,EAAA;AACA,YAAA,IAAA,CAAA,MAAA,GAAA,IAAA,CAAA,IAAA,CAAA,KAAA,CAAA,eAAA,EAAA,CAAA,CAAA;AACA;AACA,SATA;;AAUA,QAAA,MAAA,CAAA,aAAA,CAAA,OAAA;AACA,OAvBA;AAwBA,KAhNA;AAiNA,IAAA,QAjNA,sBAiNA;AAAA;;AACA,UAAA,GAAA,GACA,OAAA,CAAA,GAAA,CAAA,eAAA,GAAA,QAAA,GAAA,KAAA,QAAA,GAAA,OADA,CADA,CAGA;AACA;;AACA,WAAA,IAAA,GAAA,IAAA,IAAA,CAAA,GAAA,CAAA;AACA,WAAA,cAAA,CAAA,KAAA,IAAA;AACA,WAAA,aAAA;AACA,WAAA,WAAA;AACA,WAAA,SAAA;AACA,WAAA,IAAA,CAAA,KAAA,CACA,IADA,CACA,YAAA;AACA;AACA,eAAA,MAAA,CAAA,IAAA,CAAA,SAAA,CAAA,QAAA,CACA,OAAA,MAAA,CAAA,UAAA,GAAA,GAAA,KAAA,WAAA,CAAA,MAAA,CAAA,QAAA,CAAA,GAAA,EAAA,CADA,CAAA;AAGA,OANA,EAOA,IAPA,CAOA,UAAA,SAAA,EAAA;AACA;AACA,QAAA,MAAA,CAAA,gBAAA,CAAA,IAAA;;AACA,QAAA,MAAA,CAAA,eAAA;AACA,OAXA;AAYA;AAvOA,GAFA;AA2OA,EAAA,OA3OA,qBA2OA;AAAA;;AACA,QAAA,QAAA,GAAA,KAAA,MAAA,CAAA,MAAA,CAAA,QAAA,CAAA,KAAA,CAAA,GAAA,EAAA,IAAA,CAAA,GAAA,CAAA,CADA,CAEA;;AACA,SAAA,WAAA,CAAA,QAAA,EAAA,IAAA,CAAA,YAAA;AACA,MAAA,MAAA,CAAA,QAAA;AACA,KAFA;AAGA;AAjPA,CAAA","sourcesContent":["<template>\r\n  <div class=\"ebook-reader\">\r\n    <div\r\n      class=\"ebook-reader-mask\"\r\n      @touchmove=\"move\"\r\n      @touchend=\"moveEnd\"\r\n      @mousedown.left=\"onMouseEnter\"\r\n      @mousemove.left=\"onMouseMove\"\r\n      @mouseup.left=\"onMouseEnd\"\r\n      @click=\"onMaskClick\"\r\n    ></div>\r\n    <div id=\"read\" @click=\"toggleTitleAndMenu\"></div>\r\n  </div>\r\n</template>\r\n<script>\r\n  import Epub from 'epubjs'\r\n  import { ebookMixin } from '../../utils/mixin'\r\n  import {\r\n    getFontFamily,\r\n    saveFontFamily,\r\n    getFontSize,\r\n    saveFontSize,\r\n    getTheme,\r\n    saveTheme,\r\n    getLocation\r\n  } from '../../utils/localStorage'\r\n  global.ePub = Epub\r\n  export default {\r\n    mixins: [ebookMixin],\r\n    methods: {\r\n      move(e) {\r\n        let offsetY = 0\r\n        if (this.firstOffsetY) {\r\n          offsetY = e.changedTouches[0].clientY - this.firstOffsetY\r\n          this.setOffsetY(offsetY)\r\n        } else {\r\n          this.firstOffsetY = e.changedTouches[0].clientY\r\n        }\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n      },\r\n      moveEnd(e) {\r\n        this.setOffsetY(0)\r\n        this.firstOffsetY = 0\r\n      },\r\n      onMouseEnter(e) {\r\n        this.mouseMove = 1\r\n        this.mouseStartTime = e.timeStamp\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n      },\r\n      onMouseMove(e) {\r\n        if (this.mouseMove === 1) {\r\n          this.mouseMove = 2\r\n        } else if (this.mouseMove === 2) {\r\n          let offsetY = 0\r\n          if (this.firstOffsetY) {\r\n            offsetY = e.clientY - this.firstOffsetY\r\n            this.setOffsetY(offsetY)\r\n          } else {\r\n            this.firstOffsetY = e.clientY\r\n          }\r\n        }\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n      },\r\n      onMouseEnd(e) {\r\n        if (this.mouseMove === 2) {\r\n          this.setOffsetY(0)\r\n          this.firstOffsetY = 0\r\n          this.mouseMove = 3\r\n        }\r\n        this.mouseEndTime = e.timeStamp\r\n        const time = this.mouseEndTime - this.mouseStartTime\r\n        if (time < 200) {\r\n          this.mouseMove = 1\r\n        }\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n      },\r\n      onMaskClick(e) {\r\n        const offsetX = e.offsetX\r\n        const width = window.innerWidth\r\n        if (offsetX > 0 && offsetX < width * 0.3) {\r\n          this.prevPage()\r\n        } else if (offsetX > 0 && offsetX > width * 0.7) {\r\n          this.nextPage()\r\n        } else {\r\n          this.toggleTitleAndMenu()\r\n        }\r\n      },\r\n      prevPage() {\r\n        //调用Rendition的prev方法返回上一页\r\n        if (this.rendition) {\r\n          this.rendition.prev().then(() => {\r\n            this.refreshLocation()\r\n          })\r\n        }\r\n        this.hideTitleAndMenu()\r\n      },\r\n      nextPage() {\r\n        //调用Rendition的next方法返回上一页\r\n        if (this.rendition) {\r\n          this.rendition.next().then(() => {\r\n            this.refreshLocation()\r\n          })\r\n        }\r\n        this.hideTitleAndMenu()\r\n      },\r\n      toggleTitleAndMenu() {\r\n        if (this.menuVisible) {\r\n          this.setSettingVisible(-1)\r\n          this.setFontFamilyVisible(false)\r\n        }\r\n        this.setMenuVisible(!this.menuVisible)\r\n      },\r\n\r\n      initFontSize() {\r\n        //读取localStorage中的FontSize\r\n        let fontSize = getFontSize(this.filename)\r\n        if (fontSize) {\r\n          this.rendition.themes.fontSize(fontSize)\r\n          this.setDefaultFontSize(fontSize)\r\n        } else {\r\n          saveFontSize(this.filename, this.defaultFontSize)\r\n        }\r\n      },\r\n      initFontFamily() {\r\n        //读取localStorage中的Font\r\n        let font = getFontFamily(this.filename)\r\n        if (font) {\r\n          this.rendition.themes.font(font)\r\n          this.setDefaultFontFamily(font)\r\n        } else {\r\n          saveFontFamily(this.filename, this.defaultFontFamily)\r\n        }\r\n      },\r\n      initTheme() {\r\n        //初始化主题\r\n        let defaultTheme = getTheme(this.filename)\r\n        if (!defaultTheme) {\r\n          defaultTheme = this.themeList[0].name\r\n          saveTheme(this.filename, defaultTheme)\r\n        }\r\n        this.setDefaultTheme(defaultTheme)\r\n        this.themeList.forEach(theme => {\r\n          this.rendition.themes.register(theme.name, theme.style)\r\n        })\r\n        this.rendition.themes.select(defaultTheme)\r\n      },\r\n      initGesture() {\r\n        this.rendition.on('touchstart', event => {\r\n          this.touchStartX = event.changedTouches[0].clientX\r\n          this.touchStartTime = event.timeStamp\r\n        })\r\n        this.rendition.on('touchend', event => {\r\n          const offsetX = event.changedTouches[0].clientX - this.touchStartX\r\n          const time = event.timeStamp - this.touchStartTime\r\n          //根据手势事件实现翻页功能\r\n          if (time < 500 && offsetX > 40) {\r\n            this.prevPage()\r\n          } else if (time < 500 && offsetX < -40) {\r\n            this.nextPage()\r\n          } else {\r\n            this.toggleTitleAndMenu()\r\n          }\r\n          //组织默认事件和冒泡\r\n          event.preventDefault()\r\n          event.stopPropagation()\r\n        })\r\n      },\r\n      initRendition() {\r\n        //生成Rendition对象\r\n        this.rendition = this.book.renderTo('read', {\r\n          width: window.innerWidth,\r\n          height: window.innerHeight,\r\n          method: 'default'\r\n        })\r\n        //通过Rendition对象的display方法渲染电子书\r\n        const location = getLocation(this.filename)\r\n        this.display(location, () => {\r\n          this.initFontSize()\r\n          this.initFontFamily()\r\n          this.initTheme()\r\n          this.initGlobalStyle()\r\n        })\r\n        this.rendition.hooks.content.register(contents => {\r\n          Promise.all([\r\n            contents.addStylesheet(\r\n              `${process.env.VUE_APP_RES_URL}/fonts/cabin.css`\r\n            ),\r\n            contents.addStylesheet(\r\n              `${process.env.VUE_APP_RES_URL}/fonts/montserrat.css`\r\n            ),\r\n            contents.addStylesheet(\r\n              `${process.env.VUE_APP_RES_URL}/fonts/tangerine.css`\r\n            ),\r\n            contents.addStylesheet(\r\n              `${process.env.VUE_APP_RES_URL}/fonts/daysOne.css`\r\n            )\r\n          ]).then(() => {})\r\n        })\r\n      },\r\n      parseBook() {\r\n        //解析电子书的封面\r\n        this.book.loaded.cover.then(cover => {\r\n          this.book.archive.createUrl(cover).then(url => {\r\n            this.setCover(url)\r\n          })\r\n        })\r\n        this.book.loaded.metadata.then(metadata => {\r\n          this.setMetadata(metadata)\r\n        })\r\n        this.book.loaded.navigation.then(nav => {\r\n          //console.log(nav)\r\n          //获取电子书的目录\r\n          const navItem = (function flatten(arr) {\r\n            return [].concat(...arr.map(v => [v, ...flatten(v.subitems)]))\r\n          })(nav.toc)\r\n          //将树状目录结构转化为一维数组\r\n          function find(item, v = 0) {\r\n            const parent = navItem.filter(it => it.id === item.parent)[0]\r\n            return !item.parent ? v : parent ? find(parent, ++v) : v\r\n          }\r\n\r\n          navItem.forEach(item => {\r\n            item.level = find(item)\r\n            item.total = 0\r\n            item.pagelist = []\r\n            if (item.href.match(/^(.*)\\.html$/)) {\r\n              item.idhref = item.href.match(/^(.*)\\.html$/)[1]\r\n            } else if (item.href.match(/^(.*)\\.xhtml$/)) {\r\n              item.idhref = item.href.match(/^(.*)\\.xhtml$/)[1]\r\n            }\r\n          })\r\n          this.setNavigation(navItem)\r\n        })\r\n      },\r\n      initEpub() {\r\n        const url =\r\n          process.env.VUE_APP_RES_URL + '/epub/' + this.filename + '.epub'\r\n        //电子书的解析和渲染\r\n        //生成Ebook对象\r\n        this.book = new Epub(url)\r\n        this.setCurrentBook(this.book)\r\n        this.initRendition()\r\n        this.initGesture()\r\n        this.parseBook()\r\n        this.book.ready\r\n          .then(() => {\r\n            //分页\r\n            return this.book.locations.generate(\r\n              750 * (window.innerWidth / 375) * (getFontSize(this.filename) / 16)\r\n            )\r\n          })\r\n          .then(locations => {\r\n            //console.log(locations);\r\n            this.setBookAvailable(true)\r\n            this.refreshLocation()\r\n          })\r\n      }\r\n    },\r\n    mounted() {\r\n      const filename = this.$route.params.filename.split('|').join('/')\r\n      //获取静态资源的路径\r\n      this.setFilename(filename).then(() => {\r\n        this.initEpub()\r\n      })\r\n    }\r\n  }\r\n</script>\r\n<style lang=\"scss\" rel=\"stylesheet/scss\" scoped>\r\n  @import '../../assets/styles/global';\r\n\r\n  .ebook-reader {\r\n    width: 100%;\r\n    height: 100%;\r\n    overflow: hidden;\r\n    .ebook-reader-mask {\r\n      position: absolute;\r\n      z-index: 100;\r\n      top: 0;\r\n      left: 0;\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n  }\r\n</style>\r\n"],"sourceRoot":"src/components/Ebook"}]}