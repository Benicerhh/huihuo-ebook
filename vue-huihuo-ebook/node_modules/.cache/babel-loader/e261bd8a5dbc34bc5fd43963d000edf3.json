{"remainingRequest":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\thread-loader\\dist\\cjs.js!E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\babel-loader\\lib\\index.js!E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\src\\components\\Ebook\\EbookBookmark.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\src\\components\\Ebook\\EbookBookmark.vue","mtime":1588676683306},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgcmVhbFB4IH0gZnJvbSAiLi4vLi4vdXRpbHMvdXRpbHMiOwppbXBvcnQgQm9va21hcmsgZnJvbSAiLi9Cb29rbWFyayI7CmltcG9ydCB7IGVib29rTWl4aW4gfSBmcm9tICIuLi8uLi91dGlscy9taXhpbiI7CmltcG9ydCB7IGdldEJvb2ttYXJrLCBzYXZlQm9va21hcmsgfSBmcm9tICIuLi8uLi91dGlscy9sb2NhbFN0b3JhZ2UiOwp2YXIgQkxVRSA9ICIjMzQ2Y2JjIjsKdmFyIFdISVRFID0gIiNmZmYiOwpleHBvcnQgZGVmYXVsdCB7CiAgbWl4aW5zOiBbZWJvb2tNaXhpbl0sCiAgY29tcG9uZW50czogewogICAgQm9va21hcms6IEJvb2ttYXJrCiAgfSwKICBjb21wdXRlZDogewogICAgaGVpZ2h0OiBmdW5jdGlvbiBoZWlnaHQoKSB7CiAgICAgIHJldHVybiByZWFsUHgoMzUpOwogICAgfSwKICAgIHRocmVzaG9sZDogZnVuY3Rpb24gdGhyZXNob2xkKCkgewogICAgICByZXR1cm4gcmVhbFB4KDU1KTsKICAgIH0sCiAgICBmaXhlZFN0eWxlOiBmdW5jdGlvbiBmaXhlZFN0eWxlKCkgewogICAgICByZXR1cm4gewogICAgICAgIHBvc2l0aW9uOiAiZml4ZWQiLAogICAgICAgIHRvcDogMCwKICAgICAgICByaWdodDogIiIuY29uY2F0KCh3aW5kb3cuaW5uZXJXaWR0aCAtIHRoaXMuJHJlZnMuYm9va21hcmsuY2xpZW50V2lkdGgpIC8gMiwgInB4IikKICAgICAgfTsKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICBvZmZzZXRZOiBmdW5jdGlvbiBvZmZzZXRZKHYpIHsKICAgICAgaWYgKCF0aGlzLmJvb2tBdmFpbGFibGUgfHwgdGhpcy5tZW51VmlzaWJsZSB8fCB0aGlzLnNldHRpbmdWaXNpYmxlID49IDApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh2ID49IHRoaXMuaGVpZ2h0ICYmIHYgPCB0aGlzLnRocmVzaG9sZCkgewogICAgICAgIHRoaXMuYmVmb3JlVGhyZXNob2xkKHYpOwogICAgICB9IGVsc2UgaWYgKHYgPj0gdGhpcy50aHJlc2hvbGQpIHsKICAgICAgICB0aGlzLmFmdGVyVGhyZXNob2xkKHYpOwogICAgICB9IGVsc2UgaWYgKHYgPiAwICYmIHYgPCB0aGlzLmhlaWdodCkgewogICAgICAgIHRoaXMuYmVmb3JlSGVpZ2h0KCk7CiAgICAgIH0gZWxzZSBpZiAodiA9PT0gMCkgewogICAgICAgIHRoaXMucmVzdG9yZSgpOwogICAgICB9CiAgICB9LAogICAgaXNCb29rbWFyazogZnVuY3Rpb24gaXNCb29rbWFyayhfaXNCb29rbWFyaykgewogICAgICB0aGlzLmlzRml4ZWQgPSBfaXNCb29rbWFyazsKCiAgICAgIGlmIChfaXNCb29rbWFyaykgewogICAgICAgIHRoaXMuY29sb3IgPSBCTFVFOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuY29sb3IgPSBXSElURTsKICAgICAgfQogICAgfQogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHRleHQ6ICIiLAogICAgICBjb2xvcjogV0hJVEUsCiAgICAgIGlzRml4ZWQ6IGZhbHNlCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgYWRkQm9va21hcms6IGZ1bmN0aW9uIGFkZEJvb2ttYXJrKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdGhpcy5ib29rbWFyayA9IGdldEJvb2ttYXJrKHRoaXMuZmlsZU5hbWUpOwoKICAgICAgaWYgKCF0aGlzLmJvb2ttYXJrKSB7CiAgICAgICAgdGhpcy5ib29rbWFyayA9IFtdOwogICAgICB9CgogICAgICB2YXIgY3VycmVudExvY2F0aW9uID0gdGhpcy5jdXJyZW50Qm9vay5yZW5kaXRpb24uY3VycmVudExvY2F0aW9uKCk7CiAgICAgIHZhciBjZmliYXNlID0gY3VycmVudExvY2F0aW9uLnN0YXJ0LmNmaS5yZXBsYWNlKC8hLiovLCAiIik7CiAgICAgIHZhciBjZmlzdGFydCA9IGN1cnJlbnRMb2NhdGlvbi5zdGFydC5jZmkucmVwbGFjZSgvLiohLywgIiIpLnJlcGxhY2UoL1wpJC8sICIiKTsKICAgICAgdmFyIGNmaWVuZCA9IGN1cnJlbnRMb2NhdGlvbi5lbmQuY2ZpLnJlcGxhY2UoLy4qIS8sICIiKS5yZXBsYWNlKC9cKSQvLCAiIik7CiAgICAgIHZhciBjZmlyYW5nZSA9ICIiLmNvbmNhdChjZmliYXNlLCAiISwiKS5jb25jYXQoY2Zpc3RhcnQsICIsIikuY29uY2F0KGNmaWVuZCwgIikiKTsKICAgICAgdGhpcy5jdXJyZW50Qm9vay5nZXRSYW5nZShjZmlyYW5nZSkudGhlbihmdW5jdGlvbiAocmFuZ2UpIHsKICAgICAgICAvL+WOu+aOieepuuagvAogICAgICAgIHZhciB0ZXh0ID0gcmFuZ2UudG9TdHJpbmcoKS5yZXBsYWNlKC9cc1xzL2csICIiKTsgLy/lrZjlgqjkuabnrb7kv6Hmga8KCiAgICAgICAgaWYgKCEoY3VycmVudExvY2F0aW9uLnN0YXJ0LmNmaSBpbiBfdGhpcy5ib29rbWFyaykpIHsKICAgICAgICAgIC8v5Lmm562+5Y676YeNCiAgICAgICAgICBfdGhpcy5ib29rbWFyay5wdXNoKHsKICAgICAgICAgICAgY2ZpOiBjdXJyZW50TG9jYXRpb24uc3RhcnQuY2ZpLAogICAgICAgICAgICB0ZXh0OiB0ZXh0CiAgICAgICAgICB9KTsKCiAgICAgICAgICBzYXZlQm9va21hcmsoX3RoaXMuZmlsZU5hbWUsIF90aGlzLmJvb2ttYXJrKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHJlbW92ZUJvb2ttYXJrOiBmdW5jdGlvbiByZW1vdmVCb29rbWFyaygpIHsKICAgICAgdmFyIGN1cnJlbnRMb2NhdGlvbiA9IHRoaXMuY3VycmVudEJvb2sucmVuZGl0aW9uLmN1cnJlbnRMb2NhdGlvbigpOwogICAgICB2YXIgY2ZpID0gY3VycmVudExvY2F0aW9uLnN0YXJ0LmNmaTsKICAgICAgdGhpcy5ib29rbWFyayA9IGdldEJvb2ttYXJrKHRoaXMuZmlsZU5hbWUpOwoKICAgICAgaWYgKHRoaXMuYm9va21hcmspIHsKICAgICAgICBzYXZlQm9va21hcmsodGhpcy5maWxlTmFtZSwgdGhpcy5ib29rbWFyay5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIHJldHVybiBpdGVtLmNmaSAhPT0gY2ZpOwogICAgICAgIH0pKTsKICAgICAgICB0aGlzLnNldElzQm9va21hcmsoZmFsc2UpOwogICAgICB9CiAgICB9LAogICAgcmVzdG9yZTogZnVuY3Rpb24gcmVzdG9yZSgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICAvLyDnirbmgIE077ya5b2S5L2NCiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzMi4kcmVmcy5ib29rbWFyay5zdHlsZS50b3AgPSAiIi5jb25jYXQoLV90aGlzMi5oZWlnaHQsICJweCIpOwogICAgICAgIF90aGlzMi4kcmVmcy5pY29uRG93bi5zdHlsZS50cmFuc2Zvcm0gPSAicm90YXRlKDBkZWcpIjsKICAgICAgfSwgMjAwKTsKCiAgICAgIGlmICh0aGlzLmlzRml4ZWQpIHsKICAgICAgICB0aGlzLnNldElzQm9va21hcmsodHJ1ZSk7CiAgICAgICAgdGhpcy5hZGRCb29rbWFyaygpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2V0SXNCb29rbWFyayhmYWxzZSk7CiAgICAgICAgdGhpcy5yZW1vdmVCb29rbWFyaygpOwogICAgICB9CiAgICB9LAogICAgYmVmb3JlSGVpZ2h0OiBmdW5jdGlvbiBiZWZvcmVIZWlnaHQoKSB7CiAgICAgIC8vIOeKtuaAgTHvvJrmnKrotoXov4fkuabnrb7nmoTpq5jluqYKICAgICAgaWYgKHRoaXMuaXNCb29rbWFyaykgewogICAgICAgIHRoaXMudGV4dCA9IHRoaXMuJHQoImJvb2sucHVsbGRvd25EZWxldGVNYXJrIik7CiAgICAgICAgdGhpcy5jb2xvciA9IEJMVUU7CiAgICAgICAgdGhpcy5pc0ZpeGVkID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnRleHQgPSB0aGlzLiR0KCJib29rLnB1bGxkb3duQWRkTWFyayIpOwogICAgICAgIHRoaXMuY29sb3IgPSBXSElURTsKICAgICAgICB0aGlzLmlzRml4ZWQgPSBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIGJlZm9yZVRocmVzaG9sZDogZnVuY3Rpb24gYmVmb3JlVGhyZXNob2xkKHYpIHsKICAgICAgLy8g54q25oCBMu+8muacquWIsOi+vumbtueVjOeKtuaAgQogICAgICB0aGlzLiRyZWZzLmJvb2ttYXJrLnN0eWxlLnRvcCA9ICIiLmNvbmNhdCgtdiwgInB4Iik7CiAgICAgIHRoaXMuYmVmb3JlSGVpZ2h0KCk7CiAgICAgIHZhciBpY29uRG93biA9IHRoaXMuJHJlZnMuaWNvbkRvd247CgogICAgICBpZiAoaWNvbkRvd24uc3R5bGUudHJhbnNmb3JtID09PSAicm90YXRlKDE4MGRlZykiKSB7CiAgICAgICAgaWNvbkRvd24uc3R5bGUudHJhbnNmb3JtID0gInJvdGF0ZSgwZGVnKSI7CiAgICAgIH0KICAgIH0sCiAgICBhZnRlclRocmVzaG9sZDogZnVuY3Rpb24gYWZ0ZXJUaHJlc2hvbGQodikgewogICAgICAvLyDnirbmgIEz77ya6LaF6LaK6Zu255WM54q25oCBCiAgICAgIHRoaXMuJHJlZnMuYm9va21hcmsuc3R5bGUudG9wID0gIiIuY29uY2F0KC12LCAicHgiKTsKCiAgICAgIGlmICh0aGlzLmlzQm9va21hcmspIHsKICAgICAgICB0aGlzLnRleHQgPSB0aGlzLiR0KCJib29rLnJlbGVhc2VEZWxldGVNYXJrIik7CiAgICAgICAgdGhpcy5jb2xvciA9IFdISVRFOwogICAgICAgIHRoaXMuaXNGaXhlZCA9IGZhbHNlOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMudGV4dCA9IHRoaXMuJHQoImJvb2sucmVsZWFzZUFkZE1hcmsiKTsKICAgICAgICB0aGlzLmNvbG9yID0gQkxVRTsKICAgICAgICB0aGlzLmlzRml4ZWQgPSB0cnVlOwogICAgICB9CgogICAgICB2YXIgaWNvbkRvd24gPSB0aGlzLiRyZWZzLmljb25Eb3duOwoKICAgICAgaWYgKGljb25Eb3duLnN0eWxlLnRyYW5zZm9ybSA9PT0gIiIgfHwgaWNvbkRvd24uc3R5bGUudHJhbnNmb3JtID09PSAicm90YXRlKDBkZWcpIikgewogICAgICAgIGljb25Eb3duLnN0eWxlLnRyYW5zZm9ybSA9ICJyb3RhdGUoMTgwZGVnKSI7CiAgICAgIH0KICAgIH0KICB9Cn07"},{"version":3,"sources":["EbookBookmark.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"ebook-bookmark\" ref=\"bookmark\">\r\n    <div class=\"ebook-bookmark-text-wrapper\">\r\n      <div class=\"ebook-bookmark-down-wrapper\" ref=\"iconDown\">\r\n        <span class=\"icon-down\"></span>\r\n      </div>\r\n      <div class=\"ebook-bookmark-text\">{{ text }}</div>\r\n    </div>\r\n    <div class=\"ebook-bookmark-icon-wrapper\" :style=\"isFixed ? fixedStyle : {}\">\r\n      <bookmark :color=\"color\" :width=\"15\" :height=\"35\"></bookmark>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { realPx } from \"../../utils/utils\";\r\nimport Bookmark from \"./Bookmark\";\r\nimport { ebookMixin } from \"../../utils/mixin\";\r\nimport { getBookmark, saveBookmark } from \"../../utils/localStorage\";\r\n\r\nconst BLUE = \"#346cbc\";\r\nconst WHITE = \"#fff\";\r\nexport default {\r\n  mixins: [ebookMixin],\r\n  components: {\r\n    Bookmark\r\n  },\r\n  computed: {\r\n    height() {\r\n      return realPx(35);\r\n    },\r\n    threshold() {\r\n      return realPx(55);\r\n    },\r\n    fixedStyle() {\r\n      return {\r\n        position: \"fixed\",\r\n        top: 0,\r\n        right: `${(window.innerWidth - this.$refs.bookmark.clientWidth) / 2}px`\r\n      };\r\n    }\r\n  },\r\n  watch: {\r\n    offsetY(v) {\r\n      if (!this.bookAvailable || this.menuVisible || this.settingVisible >= 0) {\r\n        return;\r\n      }\r\n      if (v >= this.height && v < this.threshold) {\r\n        this.beforeThreshold(v);\r\n      } else if (v >= this.threshold) {\r\n        this.afterThreshold(v);\r\n      } else if (v > 0 && v < this.height) {\r\n        this.beforeHeight();\r\n      } else if (v === 0) {\r\n        this.restore();\r\n      }\r\n    },\r\n    isBookmark(isBookmark) {\r\n      this.isFixed = isBookmark;\r\n      if (isBookmark) {\r\n        this.color = BLUE;\r\n      } else {\r\n        this.color = WHITE;\r\n      }\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      text: \"\",\r\n      color: WHITE,\r\n      isFixed: false\r\n    };\r\n  },\r\n  methods: {\r\n    addBookmark() {\r\n      this.bookmark = getBookmark(this.fileName);\r\n      if (!this.bookmark) {\r\n        this.bookmark = [];\r\n      }\r\n      const currentLocation = this.currentBook.rendition.currentLocation();\r\n      const cfibase = currentLocation.start.cfi.replace(/!.*/, \"\");\r\n      const cfistart = currentLocation.start.cfi\r\n        .replace(/.*!/, \"\")\r\n        .replace(/\\)$/, \"\");\r\n      const cfiend = currentLocation.end.cfi\r\n        .replace(/.*!/, \"\")\r\n        .replace(/\\)$/, \"\");\r\n      const cfirange = `${cfibase}!,${cfistart},${cfiend})`;\r\n      this.currentBook.getRange(cfirange).then(range => {\r\n        //去掉空格\r\n        const text = range.toString().replace(/\\s\\s/g, \"\");\r\n        //存储书签信息\r\n        if (!(currentLocation.start.cfi in this.bookmark)) {\r\n          //书签去重\r\n          this.bookmark.push({\r\n            cfi: currentLocation.start.cfi,\r\n            text: text\r\n          });\r\n          saveBookmark(this.fileName, this.bookmark);\r\n        }\r\n      });\r\n    },\r\n    removeBookmark() {\r\n      const currentLocation = this.currentBook.rendition.currentLocation();\r\n      const cfi = currentLocation.start.cfi;\r\n      this.bookmark = getBookmark(this.fileName);\r\n      if (this.bookmark) {\r\n        saveBookmark(\r\n          this.fileName,\r\n          this.bookmark.filter(item => item.cfi !== cfi)\r\n        );\r\n        this.setIsBookmark(false);\r\n      }\r\n    },\r\n    restore() {\r\n      // 状态4：归位\r\n      setTimeout(() => {\r\n        this.$refs.bookmark.style.top = `${-this.height}px`;\r\n        this.$refs.iconDown.style.transform = \"rotate(0deg)\";\r\n      }, 200);\r\n      if (this.isFixed) {\r\n        this.setIsBookmark(true);\r\n        this.addBookmark();\r\n      } else {\r\n        this.setIsBookmark(false);\r\n        this.removeBookmark();\r\n      }\r\n    },\r\n    beforeHeight() {\r\n      // 状态1：未超过书签的高度\r\n      if (this.isBookmark) {\r\n        this.text = this.$t(\"book.pulldownDeleteMark\");\r\n        this.color = BLUE;\r\n        this.isFixed = true;\r\n      } else {\r\n        this.text = this.$t(\"book.pulldownAddMark\");\r\n        this.color = WHITE;\r\n        this.isFixed = false;\r\n      }\r\n    },\r\n    beforeThreshold(v) {\r\n      // 状态2：未到达零界状态\r\n      this.$refs.bookmark.style.top = `${-v}px`;\r\n      this.beforeHeight();\r\n      const iconDown = this.$refs.iconDown;\r\n      if (iconDown.style.transform === \"rotate(180deg)\") {\r\n        iconDown.style.transform = \"rotate(0deg)\";\r\n      }\r\n    },\r\n    afterThreshold(v) {\r\n      // 状态3：超越零界状态\r\n      this.$refs.bookmark.style.top = `${-v}px`;\r\n      if (this.isBookmark) {\r\n        this.text = this.$t(\"book.releaseDeleteMark\");\r\n        this.color = WHITE;\r\n        this.isFixed = false;\r\n      } else {\r\n        this.text = this.$t(\"book.releaseAddMark\");\r\n        this.color = BLUE;\r\n        this.isFixed = true;\r\n      }\r\n      const iconDown = this.$refs.iconDown;\r\n      if (\r\n        iconDown.style.transform === \"\" ||\r\n        iconDown.style.transform === \"rotate(0deg)\"\r\n      ) {\r\n        iconDown.style.transform = \"rotate(180deg)\";\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" rel=\"stylesheet/scss\" scoped>\r\n@import \"../../assets/styles/global\";\r\n\r\n.ebook-bookmark {\r\n  position: absolute;\r\n  top: px2rem(-35);\r\n  left: 0;\r\n  z-index: 200;\r\n  width: 100%;\r\n  height: px2rem(35);\r\n  .ebook-bookmark-text-wrapper {\r\n    position: absolute;\r\n    right: px2rem(45);\r\n    bottom: 0;\r\n    display: flex;\r\n    .ebook-bookmark-down-wrapper {\r\n      font-size: px2rem(14);\r\n      color: white;\r\n      transition: all 0.2s linear;\r\n      @include center;\r\n    }\r\n    .ebook-bookmark-text {\r\n      font-size: px2rem(14);\r\n      color: white;\r\n    }\r\n  }\r\n  .ebook-bookmark-icon-wrapper {\r\n    position: absolute;\r\n    right: 0;\r\n    bottom: 0;\r\n    margin-right: px2rem(15);\r\n  }\r\n}\r\n</style>\r\n"],"sourceRoot":"src/components/Ebook"}]}