{"remainingRequest":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\thread-loader\\dist\\cjs.js!E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\babel-loader\\lib\\index.js!E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\src\\api\\store.js","dependencies":[{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\src\\api\\store.js","mtime":1588676681812},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IHsgc2V0TG9jYWxGb3JhZ2UgfSBmcm9tICcuLi91dGlscy9sb2NhbEZvcmFnZSc7CmV4cG9ydCBmdW5jdGlvbiBmbGF0TGlzdCgpIHsKICByZXR1cm4gYXhpb3MoewogICAgbWV0aG9kOiAnZ2V0JywKICAgIHVybDogIiIuY29uY2F0KHByb2Nlc3MuZW52LlZVRV9BUFBfQk9PS19VUkwsICIvYm9vay9mbGF0LWxpc3QiKQogIH0pOwp9CmV4cG9ydCBmdW5jdGlvbiBzaGVsZigpIHsKICByZXR1cm4gYXhpb3MoewogICAgbWV0aG9kOiAnZ2V0JywKICAgIHVybDogIiIuY29uY2F0KHByb2Nlc3MuZW52LlZVRV9BUFBfQkFTRV9VUkwsICIvYm9vay9zaGVsZiIpCiAgfSk7Cn0KZXhwb3J0IGZ1bmN0aW9uIGhvbWUoKSB7CiAgcmV0dXJuIGF4aW9zKHsKICAgIG1ldGhvZDogJ2dldCcsCiAgICB1cmw6ICIiLmNvbmNhdChwcm9jZXNzLmVudi5WVUVfQVBQX0JBU0VfVVJMLCAiL2Jvb2svaG9tZSIpCiAgfSk7Cn0KZXhwb3J0IGZ1bmN0aW9uIGRldGFpbChib29rKSB7CiAgcmV0dXJuIGF4aW9zKHsKICAgIG1ldGhvZDogJ2dldCcsCiAgICB1cmw6ICIiLmNvbmNhdChwcm9jZXNzLmVudi5WVUVfQVBQX0JPT0tfVVJMLCAiL2Jvb2svZGV0YWlsIiksCiAgICBwYXJhbXM6IHsKICAgICAgZmlsZU5hbWU6IGJvb2suZmlsZU5hbWUKICAgIH0KICB9KTsKfQpleHBvcnQgZnVuY3Rpb24gbGlzdCgpIHsKICByZXR1cm4gYXhpb3MoewogICAgbWV0aG9kOiAnZ2V0JywKICAgIHVybDogIiIuY29uY2F0KHByb2Nlc3MuZW52LlZVRV9BUFBfQkFTRV9VUkwsICIvYm9vay9saXN0IikKICB9KTsKfQpleHBvcnQgZnVuY3Rpb24gZG93bmxvYWQoYm9vaywgb25TdWNlc3MsIG9uRXJyb3IsIG9uUHJvZ3Jlc3MpIHsKICBpZiAob25Qcm9ncmVzcyA9PSBudWxsKSB7CiAgICBvblByb2dyZXNzID0gb25FcnJvcjsKICAgIG9uRXJyb3IgPSBudWxsOwogIH0gLy9vblByb2dyZXNz5rKh5pyJ5Lyg6L+b5p2l5pe26LWL5Y+CCgoKICByZXR1cm4gYXhpb3MuY3JlYXRlKHsKICAgIGJhc2VVUkw6IHByb2Nlc3MuZW52LlZVRV9BUFBfRVBVQl9VUkwsCiAgICBtZXRob2Q6ICdnZXQnLAogICAgcmVzcG9uc2VUeXBlOiAnYmxvYicsCiAgICAvL+eUteWtkOS5puagvOW8jwogICAgdGltZW91dDogMTgwICogMTAwMCwKICAgIC8v6LaF5pe25pe26Ze077yaM+WIhumSnwogICAgb25Eb3dubG9hZFByb2dyZXNzOiBmdW5jdGlvbiBvbkRvd25sb2FkUHJvZ3Jlc3MocHJvZ3Jlc3NFdmVudCkgewogICAgICBpZiAob25Qcm9ncmVzcykgb25Qcm9ncmVzcyhwcm9ncmVzc0V2ZW50KTsKICAgIH0KICB9KS5nZXQoIiIuY29uY2F0KGJvb2suY2F0ZWdvcnlUZXh0LCAiLyIpLmNvbmNhdChib29rLmZpbGVOYW1lLCAiLmVwdWIiKSkgLy/nlLXlrZDkuabotYTmupDot6/lvoQKICAudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICB2YXIgYmxvYiA9IG5ldyBCbG9iKFtyZXMuZGF0YV0pOwogICAgc2V0TG9jYWxGb3JhZ2UoYm9vay5maWxlTmFtZSwgYmxvYiwgZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gb25TdWNlc3MoYm9vayk7CiAgICB9LCBmdW5jdGlvbiAoZXJyKSB7CiAgICAgIHJldHVybiBvbkVycm9yKGVycik7CiAgICB9KTsgLy9pbmRleGVkRELlrZjlgqgKICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICBpZiAob25FcnJvcikgb25FcnJvcihlcnIpOwogIH0pOwp9"},{"version":3,"sources":["E:/JodPreparation/Practice/项目/huihuo-ebook/src/api/store.js"],"names":["axios","setLocalForage","flatList","method","url","process","env","VUE_APP_BOOK_URL","shelf","VUE_APP_BASE_URL","home","detail","book","params","fileName","list","download","onSucess","onError","onProgress","create","baseURL","VUE_APP_EPUB_URL","responseType","timeout","onDownloadProgress","progressEvent","get","categoryText","then","res","blob","Blob","data","err","catch"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SACEC,cADF,QAEO,sBAFP;AAIA,OAAO,SAASC,QAAT,GAAoB;AACzB,SAAOF,KAAK,CAAC;AACXG,IAAAA,MAAM,EAAE,KADG;AAEXC,IAAAA,GAAG,YAAKC,OAAO,CAACC,GAAR,CAAYC,gBAAjB;AAFQ,GAAD,CAAZ;AAID;AAED,OAAO,SAASC,KAAT,GAAiB;AACtB,SAAOR,KAAK,CAAC;AACXG,IAAAA,MAAM,EAAE,KADG;AAEXC,IAAAA,GAAG,YAAKC,OAAO,CAACC,GAAR,CAAYG,gBAAjB;AAFQ,GAAD,CAAZ;AAID;AAED,OAAO,SAASC,IAAT,GAAgB;AACrB,SAAOV,KAAK,CAAC;AACXG,IAAAA,MAAM,EAAE,KADG;AAEXC,IAAAA,GAAG,YAAKC,OAAO,CAACC,GAAR,CAAYG,gBAAjB;AAFQ,GAAD,CAAZ;AAID;AAED,OAAO,SAASE,MAAT,CAAgBC,IAAhB,EAAsB;AAC3B,SAAOZ,KAAK,CAAC;AACXG,IAAAA,MAAM,EAAE,KADG;AAEXC,IAAAA,GAAG,YAAKC,OAAO,CAACC,GAAR,CAAYC,gBAAjB,iBAFQ;AAGXM,IAAAA,MAAM,EAAE;AACNC,MAAAA,QAAQ,EAAEF,IAAI,CAACE;AADT;AAHG,GAAD,CAAZ;AAOD;AAED,OAAO,SAASC,IAAT,GAAgB;AACrB,SAAOf,KAAK,CAAC;AACXG,IAAAA,MAAM,EAAE,KADG;AAEXC,IAAAA,GAAG,YAAKC,OAAO,CAACC,GAAR,CAAYG,gBAAjB;AAFQ,GAAD,CAAZ;AAID;AAED,OAAO,SAASO,QAAT,CAAkBJ,IAAlB,EAAwBK,QAAxB,EAAkCC,OAAlC,EAA2CC,UAA3C,EAAuD;AAC5D,MAAIA,UAAU,IAAI,IAAlB,EAAwB;AACtBA,IAAAA,UAAU,GAAGD,OAAb;AACAA,IAAAA,OAAO,GAAG,IAAV;AACD,GAJ2D,CAI1D;;;AACF,SAAOlB,KAAK,CAACoB,MAAN,CAAa;AAChBC,IAAAA,OAAO,EAAEhB,OAAO,CAACC,GAAR,CAAYgB,gBADL;AAEhBnB,IAAAA,MAAM,EAAE,KAFQ;AAGhBoB,IAAAA,YAAY,EAAE,MAHE;AAIhB;AACAC,IAAAA,OAAO,EAAE,MAAM,IALC;AAMhB;AACAC,IAAAA,kBAAkB,EAAE,4BAAAC,aAAa,EAAI;AACnC,UAAIP,UAAJ,EAAgBA,UAAU,CAACO,aAAD,CAAV;AACjB;AATe,GAAb,EAUFC,GAVE,WAUKf,IAAI,CAACgB,YAVV,cAU0BhB,IAAI,CAACE,QAV/B,YAWL;AAXK,GAYJe,IAZI,CAYC,UAAAC,GAAG,EAAI;AACX,QAAMC,IAAI,GAAG,IAAIC,IAAJ,CAAS,CAACF,GAAG,CAACG,IAAL,CAAT,CAAb;AACAhC,IAAAA,cAAc,CAACW,IAAI,CAACE,QAAN,EAAgBiB,IAAhB,EACZ;AAAA,aAAMd,QAAQ,CAACL,IAAD,CAAd;AAAA,KADY,EAEZ,UAAAsB,GAAG;AAAA,aAAIhB,OAAO,CAACgB,GAAD,CAAX;AAAA,KAFS,CAAd,CAFW,CAKX;AACD,GAlBI,EAkBFC,KAlBE,CAkBI,UAAAD,GAAG,EAAI;AACd,QAAIhB,OAAJ,EAAaA,OAAO,CAACgB,GAAD,CAAP;AACd,GApBI,CAAP;AAqBD","sourcesContent":["import axios from 'axios'\r\nimport {\r\n  setLocalForage\r\n} from '../utils/localForage'\r\n\r\nexport function flatList() {\r\n  return axios({\r\n    method: 'get',\r\n    url: `${process.env.VUE_APP_BOOK_URL}/book/flat-list`\r\n  })\r\n}\r\n\r\nexport function shelf() {\r\n  return axios({\r\n    method: 'get',\r\n    url: `${process.env.VUE_APP_BASE_URL}/book/shelf`\r\n  })\r\n}\r\n\r\nexport function home() {\r\n  return axios({\r\n    method: 'get',\r\n    url: `${process.env.VUE_APP_BASE_URL}/book/home`\r\n  })\r\n}\r\n\r\nexport function detail(book) {\r\n  return axios({\r\n    method: 'get',\r\n    url: `${process.env.VUE_APP_BOOK_URL}/book/detail`,\r\n    params: {\r\n      fileName: book.fileName\r\n    }\r\n  })\r\n}\r\n\r\nexport function list() {\r\n  return axios({\r\n    method: 'get',\r\n    url: `${process.env.VUE_APP_BASE_URL}/book/list`\r\n  })\r\n}\r\n\r\nexport function download(book, onSucess, onError, onProgress) {\r\n  if (onProgress == null) {\r\n    onProgress = onError\r\n    onError = null\r\n  } //onProgress没有传进来时赋参\r\n  return axios.create({\r\n      baseURL: process.env.VUE_APP_EPUB_URL,\r\n      method: 'get',\r\n      responseType: 'blob',\r\n      //电子书格式\r\n      timeout: 180 * 1000,\r\n      //超时时间：3分钟\r\n      onDownloadProgress: progressEvent => {\r\n        if (onProgress) onProgress(progressEvent)\r\n      }\r\n    }).get(`${book.categoryText}/${book.fileName}.epub`)\r\n    //电子书资源路径\r\n    .then(res => {\r\n      const blob = new Blob([res.data])\r\n      setLocalForage(book.fileName, blob,\r\n        () => onSucess(book),\r\n        err => onError(err))\r\n      //indexedDB存储\r\n    }).catch(err => {\r\n      if (onError) onError(err)\r\n    })\r\n}\r\n"]}]}