{"remainingRequest":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\src\\components\\Ebook\\EbookReader.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\src\\components\\Ebook\\EbookReader.vue","mtime":1588676682268},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgRXB1YiBmcm9tICJlcHVianMiOw0KaW1wb3J0IHsgZWJvb2tNaXhpbiB9IGZyb20gIi4uLy4uL3V0aWxzL21peGluIjsNCmltcG9ydCB7DQogIGdldEZvbnRGYW1pbHksDQogIHNhdmVGb250RmFtaWx5LA0KICBnZXRGb250U2l6ZSwNCiAgc2F2ZUZvbnRTaXplLA0KICBnZXRUaGVtZSwNCiAgc2F2ZVRoZW1lLA0KICBnZXRMb2NhdGlvbg0KfSBmcm9tICIuLi8uLi91dGlscy9sb2NhbFN0b3JhZ2UiOw0KZ2xvYmFsLmVQdWIgPSBFcHViOw0KZXhwb3J0IGRlZmF1bHQgew0KICBtaXhpbnM6IFtlYm9va01peGluXSwNCiAgbWV0aG9kczogew0KICAgIG1vdmUoZSkgew0KICAgICAgbGV0IG9mZnNldFkgPSAwOw0KICAgICAgaWYgKHRoaXMuZmlyc3RPZmZzZXRZKSB7DQogICAgICAgIG9mZnNldFkgPSBlLmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFkgLSB0aGlzLmZpcnN0T2Zmc2V0WTsNCiAgICAgICAgdGhpcy5zZXRPZmZzZXRZKG9mZnNldFkpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy5maXJzdE9mZnNldFkgPSBlLmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFk7DQogICAgICB9DQogICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgIH0sDQogICAgbW92ZUVuZChlKSB7DQogICAgICB0aGlzLnNldE9mZnNldFkoMCk7DQogICAgICB0aGlzLmZpcnN0T2Zmc2V0WSA9IDA7DQogICAgfSwNCiAgICBvbk1vdXNlRW50ZXIoZSkgew0KICAgICAgdGhpcy5tb3VzZU1vdmUgPSAxOw0KICAgICAgdGhpcy5tb3VzZVN0YXJ0VGltZSA9IGUudGltZVN0YW1wOw0KICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICB9LA0KICAgIG9uTW91c2VNb3ZlKGUpIHsNCiAgICAgIGlmICh0aGlzLm1vdXNlTW92ZSA9PT0gMSkgew0KICAgICAgICB0aGlzLm1vdXNlTW92ZSA9IDI7DQogICAgICB9IGVsc2UgaWYgKHRoaXMubW91c2VNb3ZlID09PSAyKSB7DQogICAgICAgIGxldCBvZmZzZXRZID0gMDsNCiAgICAgICAgaWYgKHRoaXMuZmlyc3RPZmZzZXRZKSB7DQogICAgICAgICAgb2Zmc2V0WSA9IGUuY2xpZW50WSAtIHRoaXMuZmlyc3RPZmZzZXRZOw0KICAgICAgICAgIHRoaXMuc2V0T2Zmc2V0WShvZmZzZXRZKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0aGlzLmZpcnN0T2Zmc2V0WSA9IGUuY2xpZW50WTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICB9LA0KICAgIG9uTW91c2VFbmQoZSkgew0KICAgICAgaWYgKHRoaXMubW91c2VNb3ZlID09PSAyKSB7DQogICAgICAgIHRoaXMuc2V0T2Zmc2V0WSgwKTsNCiAgICAgICAgdGhpcy5maXJzdE9mZnNldFkgPSAwOw0KICAgICAgICB0aGlzLm1vdXNlTW92ZSA9IDM7DQogICAgICB9DQogICAgICB0aGlzLm1vdXNlRW5kVGltZSA9IGUudGltZVN0YW1wOw0KICAgICAgY29uc3QgdGltZSA9IHRoaXMubW91c2VFbmRUaW1lIC0gdGhpcy5tb3VzZVN0YXJ0VGltZTsNCiAgICAgIGlmICh0aW1lIDwgMjAwKSB7DQogICAgICAgIHRoaXMubW91c2VNb3ZlID0gMTsNCiAgICAgIH0NCiAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgfSwNCiAgICBvbk1hc2tDbGljayhlKSB7DQogICAgICBjb25zdCBvZmZzZXRYID0gZS5vZmZzZXRYOw0KICAgICAgY29uc3Qgd2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDsNCiAgICAgIGlmIChvZmZzZXRYID4gMCAmJiBvZmZzZXRYIDwgd2lkdGggKiAwLjMpIHsNCiAgICAgICAgdGhpcy5wcmV2UGFnZSgpOw0KICAgICAgfSBlbHNlIGlmIChvZmZzZXRYID4gMCAmJiBvZmZzZXRYID4gd2lkdGggKiAwLjcpIHsNCiAgICAgICAgdGhpcy5uZXh0UGFnZSgpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy50b2dnbGVUaXRsZUFuZE1lbnUoKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIHByZXZQYWdlKCkgew0KICAgICAgLy/osIPnlKhSZW5kaXRpb27nmoRwcmV25pa55rOV6L+U5Zue5LiK5LiA6aG1DQogICAgICBpZiAodGhpcy5yZW5kaXRpb24pIHsNCiAgICAgICAgdGhpcy5yZW5kaXRpb24ucHJldigpLnRoZW4oKCkgPT4gew0KICAgICAgICAgIHRoaXMucmVmcmVzaExvY2F0aW9uKCk7DQogICAgICAgIH0pOw0KICAgICAgfQ0KICAgICAgdGhpcy5oaWRlVGl0bGVBbmRNZW51KCk7DQogICAgfSwNCiAgICBuZXh0UGFnZSgpIHsNCiAgICAgIC8v6LCD55SoUmVuZGl0aW9u55qEbmV4dOaWueazlei/lOWbnuS4iuS4gOmhtQ0KICAgICAgaWYgKHRoaXMucmVuZGl0aW9uKSB7DQogICAgICAgIHRoaXMucmVuZGl0aW9uLm5leHQoKS50aGVuKCgpID0+IHsNCiAgICAgICAgICB0aGlzLnJlZnJlc2hMb2NhdGlvbigpOw0KICAgICAgICB9KTsNCiAgICAgIH0NCiAgICAgIHRoaXMuaGlkZVRpdGxlQW5kTWVudSgpOw0KICAgIH0sDQogICAgdG9nZ2xlVGl0bGVBbmRNZW51KCkgew0KICAgICAgaWYgKHRoaXMubWVudVZpc2libGUpIHsNCiAgICAgICAgdGhpcy5zZXRTZXR0aW5nVmlzaWJsZSgtMSk7DQogICAgICAgIHRoaXMuc2V0Rm9udEZhbWlseVZpc2libGUoZmFsc2UpOw0KICAgICAgfQ0KICAgICAgdGhpcy5zZXRNZW51VmlzaWJsZSghdGhpcy5tZW51VmlzaWJsZSk7DQogICAgfSwNCg0KICAgIGluaXRGb250U2l6ZSgpIHsNCiAgICAgIC8v6K+75Y+WbG9jYWxTdG9yYWdl5Lit55qERm9udFNpemUNCiAgICAgIGxldCBmb250U2l6ZSA9IGdldEZvbnRTaXplKHRoaXMuZmlsZU5hbWUpOw0KICAgICAgaWYgKGZvbnRTaXplKSB7DQogICAgICAgIHRoaXMucmVuZGl0aW9uLnRoZW1lcy5mb250U2l6ZShmb250U2l6ZSk7DQogICAgICAgIHRoaXMuc2V0RGVmYXVsdEZvbnRTaXplKGZvbnRTaXplKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHNhdmVGb250U2l6ZSh0aGlzLmZpbGVOYW1lLCB0aGlzLmRlZmF1bHRGb250U2l6ZSk7DQogICAgICB9DQogICAgfSwNCiAgICBpbml0Rm9udEZhbWlseSgpIHsNCiAgICAgIC8v6K+75Y+WbG9jYWxTdG9yYWdl5Lit55qERm9udA0KICAgICAgbGV0IGZvbnQgPSBnZXRGb250RmFtaWx5KHRoaXMuZmlsZU5hbWUpOw0KICAgICAgaWYgKGZvbnQpIHsNCiAgICAgICAgdGhpcy5yZW5kaXRpb24udGhlbWVzLmZvbnQoZm9udCk7DQogICAgICAgIHRoaXMuc2V0RGVmYXVsdEZvbnRGYW1pbHkoZm9udCk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBzYXZlRm9udEZhbWlseSh0aGlzLmZpbGVOYW1lLCB0aGlzLmRlZmF1bHRGb250RmFtaWx5KTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGluaXRUaGVtZSgpIHsNCiAgICAgIC8v5Yid5aeL5YyW5Li76aKYDQogICAgICBsZXQgZGVmYXVsdFRoZW1lID0gZ2V0VGhlbWUodGhpcy5maWxlTmFtZSk7DQogICAgICBpZiAoIWRlZmF1bHRUaGVtZSkgew0KICAgICAgICBkZWZhdWx0VGhlbWUgPSB0aGlzLnRoZW1lTGlzdFswXS5uYW1lOw0KICAgICAgICBzYXZlVGhlbWUodGhpcy5maWxlTmFtZSwgZGVmYXVsdFRoZW1lKTsNCiAgICAgIH0NCiAgICAgIHRoaXMuc2V0RGVmYXVsdFRoZW1lKGRlZmF1bHRUaGVtZSk7DQogICAgICB0aGlzLnRoZW1lTGlzdC5mb3JFYWNoKHRoZW1lID0+IHsNCiAgICAgICAgdGhpcy5yZW5kaXRpb24udGhlbWVzLnJlZ2lzdGVyKHRoZW1lLm5hbWUsIHRoZW1lLnN0eWxlKTsNCiAgICAgIH0pOw0KICAgICAgdGhpcy5yZW5kaXRpb24udGhlbWVzLnNlbGVjdChkZWZhdWx0VGhlbWUpOw0KICAgIH0sDQogICAgaW5pdEdlc3R1cmUoKSB7DQogICAgICB0aGlzLnJlbmRpdGlvbi5vbigidG91Y2hzdGFydCIsIGV2ZW50ID0+IHsNCiAgICAgICAgdGhpcy50b3VjaFN0YXJ0WCA9IGV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFg7DQogICAgICAgIHRoaXMudG91Y2hTdGFydFRpbWUgPSBldmVudC50aW1lU3RhbXA7DQogICAgICB9KTsNCiAgICAgIHRoaXMucmVuZGl0aW9uLm9uKCJ0b3VjaGVuZCIsIGV2ZW50ID0+IHsNCiAgICAgICAgY29uc3Qgb2Zmc2V0WCA9IGV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFggLSB0aGlzLnRvdWNoU3RhcnRYOw0KICAgICAgICBjb25zdCB0aW1lID0gZXZlbnQudGltZVN0YW1wIC0gdGhpcy50b3VjaFN0YXJ0VGltZTsNCiAgICAgICAgLy/moLnmja7miYvlir/kuovku7blrp7njrDnv7vpobXlip/og70NCiAgICAgICAgaWYgKHRpbWUgPCA1MDAgJiYgb2Zmc2V0WCA+IDQwKSB7DQogICAgICAgICAgdGhpcy5wcmV2UGFnZSgpOw0KICAgICAgICB9IGVsc2UgaWYgKHRpbWUgPCA1MDAgJiYgb2Zmc2V0WCA8IC00MCkgew0KICAgICAgICAgIHRoaXMubmV4dFBhZ2UoKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0aGlzLnRvZ2dsZVRpdGxlQW5kTWVudSgpOw0KICAgICAgICB9DQogICAgICAgIC8v57uE57uH6buY6K6k5LqL5Lu25ZKM5YaS5rOhDQogICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgfSk7DQogICAgfSwNCiAgICBpbml0UmVuZGl0aW9uKCkgew0KICAgICAgLy/nlJ/miJBSZW5kaXRpb27lr7nosaENCiAgICAgIHRoaXMucmVuZGl0aW9uID0gdGhpcy5ib29rLnJlbmRlclRvKCJyZWFkIiwgew0KICAgICAgICB3aWR0aDogd2luZG93LmlubmVyV2lkdGgsDQogICAgICAgIGhlaWdodDogd2luZG93LmlubmVySGVpZ2h0LA0KICAgICAgICBtZXRob2Q6ICJkZWZhdWx0Ig0KICAgICAgfSk7DQogICAgICAvL+mAmui/h1JlbmRpdGlvbuWvueixoeeahGRpc3BsYXnmlrnms5XmuLLmn5PnlLXlrZDkuaYNCiAgICAgIGNvbnN0IGxvY2F0aW9uID0gZ2V0TG9jYXRpb24odGhpcy5maWxlTmFtZSk7DQogICAgICB0aGlzLmRpc3BsYXkobG9jYXRpb24sICgpID0+IHsNCiAgICAgICAgdGhpcy5pbml0Rm9udFNpemUoKTsNCiAgICAgICAgdGhpcy5pbml0Rm9udEZhbWlseSgpOw0KICAgICAgICB0aGlzLmluaXRUaGVtZSgpOw0KICAgICAgICB0aGlzLmluaXRHbG9iYWxTdHlsZSgpOw0KICAgICAgfSk7DQogICAgICB0aGlzLnJlbmRpdGlvbi5ob29rcy5jb250ZW50LnJlZ2lzdGVyKGNvbnRlbnRzID0+IHsNCiAgICAgICAgUHJvbWlzZS5hbGwoWw0KICAgICAgICAgIGNvbnRlbnRzLmFkZFN0eWxlc2hlZXQoDQogICAgICAgICAgICBgJHtwcm9jZXNzLmVudi5WVUVfQVBQX1JFU19VUkx9L2ZvbnRzL2NhYmluLmNzc2ANCiAgICAgICAgICApLA0KICAgICAgICAgIGNvbnRlbnRzLmFkZFN0eWxlc2hlZXQoDQogICAgICAgICAgICBgJHtwcm9jZXNzLmVudi5WVUVfQVBQX1JFU19VUkx9L2ZvbnRzL21vbnRzZXJyYXQuY3NzYA0KICAgICAgICAgICksDQogICAgICAgICAgY29udGVudHMuYWRkU3R5bGVzaGVldCgNCiAgICAgICAgICAgIGAke3Byb2Nlc3MuZW52LlZVRV9BUFBfUkVTX1VSTH0vZm9udHMvdGFuZ2VyaW5lLmNzc2ANCiAgICAgICAgICApLA0KICAgICAgICAgIGNvbnRlbnRzLmFkZFN0eWxlc2hlZXQoDQogICAgICAgICAgICBgJHtwcm9jZXNzLmVudi5WVUVfQVBQX1JFU19VUkx9L2ZvbnRzL2RheXNPbmUuY3NzYA0KICAgICAgICAgICkNCiAgICAgICAgXSkudGhlbigoKSA9PiB7fSk7DQogICAgICB9KTsNCiAgICB9LA0KICAgIHBhcnNlQm9vaygpIHsNCiAgICAgIC8v6Kej5p6Q55S15a2Q5Lmm55qE5bCB6Z2iDQogICAgICB0aGlzLmJvb2subG9hZGVkLmNvdmVyLnRoZW4oY292ZXIgPT4gew0KICAgICAgICB0aGlzLmJvb2suYXJjaGl2ZS5jcmVhdGVVcmwoY292ZXIpLnRoZW4odXJsID0+IHsNCiAgICAgICAgICB0aGlzLnNldENvdmVyKHVybCk7DQogICAgICAgIH0pOw0KICAgICAgfSk7DQogICAgICB0aGlzLmJvb2subG9hZGVkLm1ldGFkYXRhLnRoZW4obWV0YWRhdGEgPT4gew0KICAgICAgICB0aGlzLnNldE1ldGFkYXRhKG1ldGFkYXRhKTsNCiAgICAgIH0pOw0KICAgICAgdGhpcy5ib29rLmxvYWRlZC5uYXZpZ2F0aW9uLnRoZW4obmF2ID0+IHsNCiAgICAgICAgLy9jb25zb2xlLmxvZyhuYXYpDQogICAgICAgIC8v6I635Y+W55S15a2Q5Lmm55qE55uu5b2VDQogICAgICAgIGNvbnN0IG5hdkl0ZW0gPSAoZnVuY3Rpb24gZmxhdHRlbihhcnIpIHsNCiAgICAgICAgICByZXR1cm4gW10uY29uY2F0KC4uLmFyci5tYXAodiA9PiBbdiwgLi4uZmxhdHRlbih2LnN1Yml0ZW1zKV0pKTsNCiAgICAgICAgfSkobmF2LnRvYyk7DQogICAgICAgIC8v5bCG5qCR54q255uu5b2V57uT5p6E6L2s5YyW5Li65LiA57u05pWw57uEDQogICAgICAgIGZ1bmN0aW9uIGZpbmQoaXRlbSwgdiA9IDApIHsNCiAgICAgICAgICBjb25zdCBwYXJlbnQgPSBuYXZJdGVtLmZpbHRlcihpdCA9PiBpdC5pZCA9PT0gaXRlbS5wYXJlbnQpWzBdOw0KICAgICAgICAgIHJldHVybiAhaXRlbS5wYXJlbnQgPyB2IDogcGFyZW50ID8gZmluZChwYXJlbnQsICsrdikgOiB2Ow0KICAgICAgICB9DQoNCiAgICAgICAgbmF2SXRlbS5mb3JFYWNoKGl0ZW0gPT4gew0KICAgICAgICAgIGl0ZW0ubGV2ZWwgPSBmaW5kKGl0ZW0pOw0KICAgICAgICAgIGl0ZW0udG90YWwgPSAwOw0KICAgICAgICAgIGl0ZW0ucGFnZWxpc3QgPSBbXTsNCiAgICAgICAgICBpZiAoaXRlbS5ocmVmLm1hdGNoKC9eKC4qKVwuaHRtbCQvKSkgew0KICAgICAgICAgICAgaXRlbS5pZGhyZWYgPSBpdGVtLmhyZWYubWF0Y2goL14oLiopXC5odG1sJC8pWzFdOw0KICAgICAgICAgIH0gZWxzZSBpZiAoaXRlbS5ocmVmLm1hdGNoKC9eKC4qKVwueGh0bWwkLykpIHsNCiAgICAgICAgICAgIGl0ZW0uaWRocmVmID0gaXRlbS5ocmVmLm1hdGNoKC9eKC4qKVwueGh0bWwkLylbMV07DQogICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgICAgdGhpcy5zZXROYXZpZ2F0aW9uKG5hdkl0ZW0pOw0KICAgICAgfSk7DQogICAgfSwNCiAgICBpbml0RXB1YigpIHsNCiAgICAgIGNvbnN0IHVybCA9DQogICAgICAgIHByb2Nlc3MuZW52LlZVRV9BUFBfUkVTX1VSTCArICIvZXB1Yi8iICsgdGhpcy5maWxlTmFtZSArICIuZXB1YiI7DQogICAgICBjb25zb2xlLmxvZyh1cmwpOw0KICAgICAgLy/nlLXlrZDkuabnmoTop6PmnpDlkozmuLLmn5MNCiAgICAgIC8v55Sf5oiQRWJvb2vlr7nosaENCiAgICAgIHRoaXMuYm9vayA9IG5ldyBFcHViKHVybCk7DQogICAgICB0aGlzLnNldEN1cnJlbnRCb29rKHRoaXMuYm9vayk7DQogICAgICB0aGlzLmluaXRSZW5kaXRpb24oKTsNCiAgICAgIHRoaXMuaW5pdEdlc3R1cmUoKTsNCiAgICAgIHRoaXMucGFyc2VCb29rKCk7DQogICAgICB0aGlzLmJvb2sucmVhZHkNCiAgICAgICAgLnRoZW4oKCkgPT4gew0KICAgICAgICAgIC8v5YiG6aG1DQogICAgICAgICAgcmV0dXJuIHRoaXMuYm9vay5sb2NhdGlvbnMuZ2VuZXJhdGUoDQogICAgICAgICAgICA3NTAgKiAod2luZG93LmlubmVyV2lkdGggLyAzNzUpICogKGdldEZvbnRTaXplKHRoaXMuZmlsZU5hbWUpIC8gMTYpDQogICAgICAgICAgKTsNCiAgICAgICAgfSkNCiAgICAgICAgLnRoZW4obG9jYXRpb25zID0+IHsNCiAgICAgICAgICAvL2NvbnNvbGUubG9nKGxvY2F0aW9ucyk7DQogICAgICAgICAgdGhpcy5zZXRCb29rQXZhaWxhYmxlKHRydWUpOw0KICAgICAgICAgIHRoaXMucmVmcmVzaExvY2F0aW9uKCk7DQogICAgICAgIH0pOw0KICAgIH0NCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICBjb25zdCBmaWxlTmFtZSA9IHRoaXMuJHJvdXRlLnBhcmFtcy5maWxlTmFtZS5zcGxpdCgifCIpLmpvaW4oIi8iKTsNCiAgICAvL+iOt+WPlumdmeaAgei1hOa6kOeahOi3r+W+hA0KICAgIHRoaXMuc2V0ZmlsZU5hbWUoZmlsZU5hbWUpLnRoZW4oKCkgPT4gew0KICAgICAgdGhpcy5pbml0RXB1YigpOw0KICAgIH0pOw0KICB9DQp9Ow0K"},{"version":3,"sources":["EbookReader.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;AAeA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EbookReader.vue","sourceRoot":"src/components/Ebook","sourcesContent":["<template>\r\n  <div class=\"ebook-reader\">\r\n    <div\r\n      class=\"ebook-reader-mask\"\r\n      @touchmove=\"move\"\r\n      @touchend=\"moveEnd\"\r\n      @mousedown.left=\"onMouseEnter\"\r\n      @mousemove.left=\"onMouseMove\"\r\n      @mouseup.left=\"onMouseEnd\"\r\n      @click=\"onMaskClick\"\r\n    ></div>\r\n    <div id=\"read\" @click=\"toggleTitleAndMenu\"></div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport Epub from \"epubjs\";\r\nimport { ebookMixin } from \"../../utils/mixin\";\r\nimport {\r\n  getFontFamily,\r\n  saveFontFamily,\r\n  getFontSize,\r\n  saveFontSize,\r\n  getTheme,\r\n  saveTheme,\r\n  getLocation\r\n} from \"../../utils/localStorage\";\r\nglobal.ePub = Epub;\r\nexport default {\r\n  mixins: [ebookMixin],\r\n  methods: {\r\n    move(e) {\r\n      let offsetY = 0;\r\n      if (this.firstOffsetY) {\r\n        offsetY = e.changedTouches[0].clientY - this.firstOffsetY;\r\n        this.setOffsetY(offsetY);\r\n      } else {\r\n        this.firstOffsetY = e.changedTouches[0].clientY;\r\n      }\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    },\r\n    moveEnd(e) {\r\n      this.setOffsetY(0);\r\n      this.firstOffsetY = 0;\r\n    },\r\n    onMouseEnter(e) {\r\n      this.mouseMove = 1;\r\n      this.mouseStartTime = e.timeStamp;\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    },\r\n    onMouseMove(e) {\r\n      if (this.mouseMove === 1) {\r\n        this.mouseMove = 2;\r\n      } else if (this.mouseMove === 2) {\r\n        let offsetY = 0;\r\n        if (this.firstOffsetY) {\r\n          offsetY = e.clientY - this.firstOffsetY;\r\n          this.setOffsetY(offsetY);\r\n        } else {\r\n          this.firstOffsetY = e.clientY;\r\n        }\r\n      }\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    },\r\n    onMouseEnd(e) {\r\n      if (this.mouseMove === 2) {\r\n        this.setOffsetY(0);\r\n        this.firstOffsetY = 0;\r\n        this.mouseMove = 3;\r\n      }\r\n      this.mouseEndTime = e.timeStamp;\r\n      const time = this.mouseEndTime - this.mouseStartTime;\r\n      if (time < 200) {\r\n        this.mouseMove = 1;\r\n      }\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    },\r\n    onMaskClick(e) {\r\n      const offsetX = e.offsetX;\r\n      const width = window.innerWidth;\r\n      if (offsetX > 0 && offsetX < width * 0.3) {\r\n        this.prevPage();\r\n      } else if (offsetX > 0 && offsetX > width * 0.7) {\r\n        this.nextPage();\r\n      } else {\r\n        this.toggleTitleAndMenu();\r\n      }\r\n    },\r\n    prevPage() {\r\n      //调用Rendition的prev方法返回上一页\r\n      if (this.rendition) {\r\n        this.rendition.prev().then(() => {\r\n          this.refreshLocation();\r\n        });\r\n      }\r\n      this.hideTitleAndMenu();\r\n    },\r\n    nextPage() {\r\n      //调用Rendition的next方法返回上一页\r\n      if (this.rendition) {\r\n        this.rendition.next().then(() => {\r\n          this.refreshLocation();\r\n        });\r\n      }\r\n      this.hideTitleAndMenu();\r\n    },\r\n    toggleTitleAndMenu() {\r\n      if (this.menuVisible) {\r\n        this.setSettingVisible(-1);\r\n        this.setFontFamilyVisible(false);\r\n      }\r\n      this.setMenuVisible(!this.menuVisible);\r\n    },\r\n\r\n    initFontSize() {\r\n      //读取localStorage中的FontSize\r\n      let fontSize = getFontSize(this.fileName);\r\n      if (fontSize) {\r\n        this.rendition.themes.fontSize(fontSize);\r\n        this.setDefaultFontSize(fontSize);\r\n      } else {\r\n        saveFontSize(this.fileName, this.defaultFontSize);\r\n      }\r\n    },\r\n    initFontFamily() {\r\n      //读取localStorage中的Font\r\n      let font = getFontFamily(this.fileName);\r\n      if (font) {\r\n        this.rendition.themes.font(font);\r\n        this.setDefaultFontFamily(font);\r\n      } else {\r\n        saveFontFamily(this.fileName, this.defaultFontFamily);\r\n      }\r\n    },\r\n    initTheme() {\r\n      //初始化主题\r\n      let defaultTheme = getTheme(this.fileName);\r\n      if (!defaultTheme) {\r\n        defaultTheme = this.themeList[0].name;\r\n        saveTheme(this.fileName, defaultTheme);\r\n      }\r\n      this.setDefaultTheme(defaultTheme);\r\n      this.themeList.forEach(theme => {\r\n        this.rendition.themes.register(theme.name, theme.style);\r\n      });\r\n      this.rendition.themes.select(defaultTheme);\r\n    },\r\n    initGesture() {\r\n      this.rendition.on(\"touchstart\", event => {\r\n        this.touchStartX = event.changedTouches[0].clientX;\r\n        this.touchStartTime = event.timeStamp;\r\n      });\r\n      this.rendition.on(\"touchend\", event => {\r\n        const offsetX = event.changedTouches[0].clientX - this.touchStartX;\r\n        const time = event.timeStamp - this.touchStartTime;\r\n        //根据手势事件实现翻页功能\r\n        if (time < 500 && offsetX > 40) {\r\n          this.prevPage();\r\n        } else if (time < 500 && offsetX < -40) {\r\n          this.nextPage();\r\n        } else {\r\n          this.toggleTitleAndMenu();\r\n        }\r\n        //组织默认事件和冒泡\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n      });\r\n    },\r\n    initRendition() {\r\n      //生成Rendition对象\r\n      this.rendition = this.book.renderTo(\"read\", {\r\n        width: window.innerWidth,\r\n        height: window.innerHeight,\r\n        method: \"default\"\r\n      });\r\n      //通过Rendition对象的display方法渲染电子书\r\n      const location = getLocation(this.fileName);\r\n      this.display(location, () => {\r\n        this.initFontSize();\r\n        this.initFontFamily();\r\n        this.initTheme();\r\n        this.initGlobalStyle();\r\n      });\r\n      this.rendition.hooks.content.register(contents => {\r\n        Promise.all([\r\n          contents.addStylesheet(\r\n            `${process.env.VUE_APP_RES_URL}/fonts/cabin.css`\r\n          ),\r\n          contents.addStylesheet(\r\n            `${process.env.VUE_APP_RES_URL}/fonts/montserrat.css`\r\n          ),\r\n          contents.addStylesheet(\r\n            `${process.env.VUE_APP_RES_URL}/fonts/tangerine.css`\r\n          ),\r\n          contents.addStylesheet(\r\n            `${process.env.VUE_APP_RES_URL}/fonts/daysOne.css`\r\n          )\r\n        ]).then(() => {});\r\n      });\r\n    },\r\n    parseBook() {\r\n      //解析电子书的封面\r\n      this.book.loaded.cover.then(cover => {\r\n        this.book.archive.createUrl(cover).then(url => {\r\n          this.setCover(url);\r\n        });\r\n      });\r\n      this.book.loaded.metadata.then(metadata => {\r\n        this.setMetadata(metadata);\r\n      });\r\n      this.book.loaded.navigation.then(nav => {\r\n        //console.log(nav)\r\n        //获取电子书的目录\r\n        const navItem = (function flatten(arr) {\r\n          return [].concat(...arr.map(v => [v, ...flatten(v.subitems)]));\r\n        })(nav.toc);\r\n        //将树状目录结构转化为一维数组\r\n        function find(item, v = 0) {\r\n          const parent = navItem.filter(it => it.id === item.parent)[0];\r\n          return !item.parent ? v : parent ? find(parent, ++v) : v;\r\n        }\r\n\r\n        navItem.forEach(item => {\r\n          item.level = find(item);\r\n          item.total = 0;\r\n          item.pagelist = [];\r\n          if (item.href.match(/^(.*)\\.html$/)) {\r\n            item.idhref = item.href.match(/^(.*)\\.html$/)[1];\r\n          } else if (item.href.match(/^(.*)\\.xhtml$/)) {\r\n            item.idhref = item.href.match(/^(.*)\\.xhtml$/)[1];\r\n          }\r\n        });\r\n        this.setNavigation(navItem);\r\n      });\r\n    },\r\n    initEpub() {\r\n      const url =\r\n        process.env.VUE_APP_RES_URL + \"/epub/\" + this.fileName + \".epub\";\r\n      console.log(url);\r\n      //电子书的解析和渲染\r\n      //生成Ebook对象\r\n      this.book = new Epub(url);\r\n      this.setCurrentBook(this.book);\r\n      this.initRendition();\r\n      this.initGesture();\r\n      this.parseBook();\r\n      this.book.ready\r\n        .then(() => {\r\n          //分页\r\n          return this.book.locations.generate(\r\n            750 * (window.innerWidth / 375) * (getFontSize(this.fileName) / 16)\r\n          );\r\n        })\r\n        .then(locations => {\r\n          //console.log(locations);\r\n          this.setBookAvailable(true);\r\n          this.refreshLocation();\r\n        });\r\n    }\r\n  },\r\n  mounted() {\r\n    const fileName = this.$route.params.fileName.split(\"|\").join(\"/\");\r\n    //获取静态资源的路径\r\n    this.setfileName(fileName).then(() => {\r\n      this.initEpub();\r\n    });\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" rel=\"stylesheet/scss\" scoped>\r\n@import \"../../assets/styles/global\";\r\n\r\n.ebook-reader {\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n  .ebook-reader-mask {\r\n    position: absolute;\r\n    z-index: 100;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n}\r\n</style>\r\n"]}]}