{"remainingRequest":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\src\\components\\Ebook\\EbookReader.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\src\\components\\Ebook\\EbookReader.vue","mtime":1588728729544},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBFcHViIGZyb20gJ2VwdWJqcycKaW1wb3J0IHsgZWJvb2tNaXhpbiB9IGZyb20gJy4uLy4uL3V0aWxzL21peGluJwppbXBvcnQgewogIGdldEZvbnRGYW1pbHksCiAgc2F2ZUZvbnRGYW1pbHksCiAgZ2V0Rm9udFNpemUsCiAgc2F2ZUZvbnRTaXplLAogIGdldFRoZW1lLAogIHNhdmVUaGVtZSwKICBnZXRMb2NhdGlvbgp9IGZyb20gJy4uLy4uL3V0aWxzL2xvY2FsU3RvcmFnZScKaW1wb3J0IHsgZ2V0TG9jYWxGb3JhZ2UgfSBmcm9tICcuLi8uLi91dGlscy9sb2NhbEZvcmFnZScKZ2xvYmFsLmVQdWIgPSBFcHViCmV4cG9ydCBkZWZhdWx0IHsKICBtaXhpbnM6IFtlYm9va01peGluXSwKICBtZXRob2RzOiB7CiAgICBtb3ZlKGUpIHsKICAgICAgbGV0IG9mZnNldFkgPSAwCiAgICAgIGlmICh0aGlzLmZpcnN0T2Zmc2V0WSkgewogICAgICAgIG9mZnNldFkgPSBlLmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFkgLSB0aGlzLmZpcnN0T2Zmc2V0WQogICAgICAgIHRoaXMuc2V0T2Zmc2V0WShvZmZzZXRZKQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZmlyc3RPZmZzZXRZID0gZS5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRZCiAgICAgIH0KICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpCiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCkKICAgIH0sCiAgICBtb3ZlRW5kKGUpIHsKICAgICAgdGhpcy5zZXRPZmZzZXRZKDApCiAgICAgIHRoaXMuZmlyc3RPZmZzZXRZID0gMAogICAgfSwKICAgIG9uTW91c2VFbnRlcihlKSB7CiAgICAgIHRoaXMubW91c2VNb3ZlID0gMQogICAgICB0aGlzLm1vdXNlU3RhcnRUaW1lID0gZS50aW1lU3RhbXAKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpCiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCkKICAgIH0sCiAgICBvbk1vdXNlTW92ZShlKSB7CiAgICAgIGlmICh0aGlzLm1vdXNlTW92ZSA9PT0gMSkgewogICAgICAgIHRoaXMubW91c2VNb3ZlID0gMgogICAgICB9IGVsc2UgaWYgKHRoaXMubW91c2VNb3ZlID09PSAyKSB7CiAgICAgICAgbGV0IG9mZnNldFkgPSAwCiAgICAgICAgaWYgKHRoaXMuZmlyc3RPZmZzZXRZKSB7CiAgICAgICAgICBvZmZzZXRZID0gZS5jbGllbnRZIC0gdGhpcy5maXJzdE9mZnNldFkKICAgICAgICAgIHRoaXMuc2V0T2Zmc2V0WShvZmZzZXRZKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmZpcnN0T2Zmc2V0WSA9IGUuY2xpZW50WQogICAgICAgIH0KICAgICAgfQogICAgICBlLnByZXZlbnREZWZhdWx0KCkKICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKQogICAgfSwKICAgIG9uTW91c2VFbmQoZSkgewogICAgICBpZiAodGhpcy5tb3VzZU1vdmUgPT09IDIpIHsKICAgICAgICB0aGlzLnNldE9mZnNldFkoMCkKICAgICAgICB0aGlzLmZpcnN0T2Zmc2V0WSA9IDAKICAgICAgICB0aGlzLm1vdXNlTW92ZSA9IDMKICAgICAgfQogICAgICB0aGlzLm1vdXNlRW5kVGltZSA9IGUudGltZVN0YW1wCiAgICAgIGNvbnN0IHRpbWUgPSB0aGlzLm1vdXNlRW5kVGltZSAtIHRoaXMubW91c2VTdGFydFRpbWUKICAgICAgaWYgKHRpbWUgPCAyMDApIHsKICAgICAgICB0aGlzLm1vdXNlTW92ZSA9IDEKICAgICAgfQogICAgICBlLnByZXZlbnREZWZhdWx0KCkKICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKQogICAgfSwKICAgIG9uTWFza0NsaWNrKGUpIHsKICAgICAgY29uc3Qgb2Zmc2V0WCA9IGUub2Zmc2V0WAogICAgICBjb25zdCB3aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoCiAgICAgIGlmIChvZmZzZXRYID4gMCAmJiBvZmZzZXRYIDwgd2lkdGggKiAwLjMpIHsKICAgICAgICB0aGlzLnByZXZQYWdlKCkKICAgICAgfSBlbHNlIGlmIChvZmZzZXRYID4gMCAmJiBvZmZzZXRYID4gd2lkdGggKiAwLjcpIHsKICAgICAgICB0aGlzLm5leHRQYWdlKCkKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnRvZ2dsZVRpdGxlQW5kTWVudSgpCiAgICAgIH0KICAgIH0sCiAgICBwcmV2UGFnZSgpIHsKICAgICAgLy/osIPnlKhSZW5kaXRpb27nmoRwcmV25pa55rOV6L+U5Zue5LiK5LiA6aG1CiAgICAgIGlmICh0aGlzLnJlbmRpdGlvbikgewogICAgICAgIHRoaXMucmVuZGl0aW9uLnByZXYoKS50aGVuKCgpID0+IHsKICAgICAgICAgIHRoaXMucmVmcmVzaExvY2F0aW9uKCkKICAgICAgICB9KQogICAgICB9CiAgICAgIHRoaXMuaGlkZVRpdGxlQW5kTWVudSgpCiAgICB9LAogICAgbmV4dFBhZ2UoKSB7CiAgICAgIC8v6LCD55SoUmVuZGl0aW9u55qEbmV4dOaWueazlei/lOWbnuS4iuS4gOmhtQogICAgICBpZiAodGhpcy5yZW5kaXRpb24pIHsKICAgICAgICB0aGlzLnJlbmRpdGlvbi5uZXh0KCkudGhlbigoKSA9PiB7CiAgICAgICAgICB0aGlzLnJlZnJlc2hMb2NhdGlvbigpCiAgICAgICAgfSkKICAgICAgfQogICAgICB0aGlzLmhpZGVUaXRsZUFuZE1lbnUoKQogICAgfSwKICAgIHRvZ2dsZVRpdGxlQW5kTWVudSgpIHsKICAgICAgaWYgKHRoaXMubWVudVZpc2libGUpIHsKICAgICAgICB0aGlzLnNldFNldHRpbmdWaXNpYmxlKC0xKQogICAgICAgIHRoaXMuc2V0Rm9udEZhbWlseVZpc2libGUoZmFsc2UpCiAgICAgIH0KICAgICAgdGhpcy5zZXRNZW51VmlzaWJsZSghdGhpcy5tZW51VmlzaWJsZSkKICAgIH0sCgogICAgaW5pdEZvbnRTaXplKCkgewogICAgICAvL+ivu+WPlmxvY2FsU3RvcmFnZeS4reeahEZvbnRTaXplCiAgICAgIGxldCBmb250U2l6ZSA9IGdldEZvbnRTaXplKHRoaXMuZmlsZU5hbWUpCiAgICAgIGlmIChmb250U2l6ZSkgewogICAgICAgIHRoaXMucmVuZGl0aW9uLnRoZW1lcy5mb250U2l6ZShmb250U2l6ZSkKICAgICAgICB0aGlzLnNldERlZmF1bHRGb250U2l6ZShmb250U2l6ZSkKICAgICAgfSBlbHNlIHsKICAgICAgICBzYXZlRm9udFNpemUodGhpcy5maWxlTmFtZSwgdGhpcy5kZWZhdWx0Rm9udFNpemUpCiAgICAgIH0KICAgIH0sCiAgICBpbml0Rm9udEZhbWlseSgpIHsKICAgICAgLy/or7vlj5Zsb2NhbFN0b3JhZ2XkuK3nmoRGb250CiAgICAgIGxldCBmb250ID0gZ2V0Rm9udEZhbWlseSh0aGlzLmZpbGVOYW1lKQogICAgICBpZiAoZm9udCkgewogICAgICAgIHRoaXMucmVuZGl0aW9uLnRoZW1lcy5mb250KGZvbnQpCiAgICAgICAgdGhpcy5zZXREZWZhdWx0Rm9udEZhbWlseShmb250KQogICAgICB9IGVsc2UgewogICAgICAgIHNhdmVGb250RmFtaWx5KHRoaXMuZmlsZU5hbWUsIHRoaXMuZGVmYXVsdEZvbnRGYW1pbHkpCiAgICAgIH0KICAgIH0sCiAgICBpbml0VGhlbWUoKSB7CiAgICAgIC8v5Yid5aeL5YyW5Li76aKYCiAgICAgIGxldCBkZWZhdWx0VGhlbWUgPSBnZXRUaGVtZSh0aGlzLmZpbGVOYW1lKQogICAgICBpZiAoIWRlZmF1bHRUaGVtZSkgewogICAgICAgIGRlZmF1bHRUaGVtZSA9IHRoaXMudGhlbWVMaXN0WzBdLm5hbWUKICAgICAgICBzYXZlVGhlbWUodGhpcy5maWxlTmFtZSwgZGVmYXVsdFRoZW1lKQogICAgICB9CiAgICAgIHRoaXMuc2V0RGVmYXVsdFRoZW1lKGRlZmF1bHRUaGVtZSkKICAgICAgdGhpcy50aGVtZUxpc3QuZm9yRWFjaCh0aGVtZSA9PiB7CiAgICAgICAgdGhpcy5yZW5kaXRpb24udGhlbWVzLnJlZ2lzdGVyKHRoZW1lLm5hbWUsIHRoZW1lLnN0eWxlKQogICAgICB9KQogICAgICB0aGlzLnJlbmRpdGlvbi50aGVtZXMuc2VsZWN0KGRlZmF1bHRUaGVtZSkKICAgIH0sCiAgICBpbml0R2VzdHVyZSgpIHsKICAgICAgdGhpcy5yZW5kaXRpb24ub24oJ3RvdWNoc3RhcnQnLCBldmVudCA9PiB7CiAgICAgICAgdGhpcy50b3VjaFN0YXJ0WCA9IGV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFgKICAgICAgICB0aGlzLnRvdWNoU3RhcnRUaW1lID0gZXZlbnQudGltZVN0YW1wCiAgICAgIH0pCiAgICAgIHRoaXMucmVuZGl0aW9uLm9uKCd0b3VjaGVuZCcsIGV2ZW50ID0+IHsKICAgICAgICBjb25zdCBvZmZzZXRYID0gZXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WCAtIHRoaXMudG91Y2hTdGFydFgKICAgICAgICBjb25zdCB0aW1lID0gZXZlbnQudGltZVN0YW1wIC0gdGhpcy50b3VjaFN0YXJ0VGltZQogICAgICAgIC8v5qC55o2u5omL5Yq/5LqL5Lu25a6e546w57+76aG15Yqf6IO9CiAgICAgICAgaWYgKHRpbWUgPCA1MDAgJiYgb2Zmc2V0WCA+IDQwKSB7CiAgICAgICAgICB0aGlzLnByZXZQYWdlKCkKICAgICAgICB9IGVsc2UgaWYgKHRpbWUgPCA1MDAgJiYgb2Zmc2V0WCA8IC00MCkgewogICAgICAgICAgdGhpcy5uZXh0UGFnZSgpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMudG9nZ2xlVGl0bGVBbmRNZW51KCkKICAgICAgICB9CiAgICAgICAgLy/nu4Tnu4fpu5jorqTkuovku7blkozlhpLms6EKICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpCiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCkKICAgICAgfSkKICAgIH0sCiAgICBpbml0UmVuZGl0aW9uKCkgewogICAgICAvL+eUn+aIkFJlbmRpdGlvbuWvueixoQogICAgICB0aGlzLnJlbmRpdGlvbiA9IHRoaXMuYm9vay5yZW5kZXJUbygncmVhZCcsIHsKICAgICAgICB3aWR0aDogd2luZG93LmlubmVyV2lkdGgsCiAgICAgICAgaGVpZ2h0OiB3aW5kb3cuaW5uZXJIZWlnaHQsCiAgICAgICAgbWV0aG9kOiAnZGVmYXVsdCcKICAgICAgfSkKICAgICAgLy/pgJrov4dSZW5kaXRpb27lr7nosaHnmoRkaXNwbGF55pa55rOV5riy5p+T55S15a2Q5LmmCiAgICAgIGNvbnN0IGxvY2F0aW9uID0gZ2V0TG9jYXRpb24odGhpcy5maWxlTmFtZSkKICAgICAgdGhpcy5kaXNwbGF5KGxvY2F0aW9uLCAoKSA9PiB7CiAgICAgICAgdGhpcy5pbml0Rm9udFNpemUoKQogICAgICAgIHRoaXMuaW5pdEZvbnRGYW1pbHkoKQogICAgICAgIHRoaXMuaW5pdFRoZW1lKCkKICAgICAgICB0aGlzLmluaXRHbG9iYWxTdHlsZSgpCiAgICAgIH0pCiAgICAgIHRoaXMucmVuZGl0aW9uLmhvb2tzLmNvbnRlbnQucmVnaXN0ZXIoY29udGVudHMgPT4gewogICAgICAgIFByb21pc2UuYWxsKFsKICAgICAgICAgIGNvbnRlbnRzLmFkZFN0eWxlc2hlZXQoCiAgICAgICAgICAgIGAke3Byb2Nlc3MuZW52LlZVRV9BUFBfUkVTX1VSTH0vZm9udHMvY2FiaW4uY3NzYAogICAgICAgICAgKSwKICAgICAgICAgIGNvbnRlbnRzLmFkZFN0eWxlc2hlZXQoCiAgICAgICAgICAgIGAke3Byb2Nlc3MuZW52LlZVRV9BUFBfUkVTX1VSTH0vZm9udHMvbW9udHNlcnJhdC5jc3NgCiAgICAgICAgICApLAogICAgICAgICAgY29udGVudHMuYWRkU3R5bGVzaGVldCgKICAgICAgICAgICAgYCR7cHJvY2Vzcy5lbnYuVlVFX0FQUF9SRVNfVVJMfS9mb250cy90YW5nZXJpbmUuY3NzYAogICAgICAgICAgKSwKICAgICAgICAgIGNvbnRlbnRzLmFkZFN0eWxlc2hlZXQoCiAgICAgICAgICAgIGAke3Byb2Nlc3MuZW52LlZVRV9BUFBfUkVTX1VSTH0vZm9udHMvZGF5c09uZS5jc3NgCiAgICAgICAgICApCiAgICAgICAgXSkudGhlbigoKSA9PiB7fSkKICAgICAgfSkKICAgIH0sCiAgICBwYXJzZUJvb2soKSB7CiAgICAgIC8v6Kej5p6Q55S15a2Q5Lmm55qE5bCB6Z2iCiAgICAgIHRoaXMuYm9vay5sb2FkZWQuY292ZXIudGhlbihjb3ZlciA9PiB7CiAgICAgICAgdGhpcy5ib29rLmFyY2hpdmUuY3JlYXRlVXJsKGNvdmVyKS50aGVuKHVybCA9PiB7CiAgICAgICAgICB0aGlzLnNldENvdmVyKHVybCkKICAgICAgICB9KQogICAgICB9KQogICAgICB0aGlzLmJvb2subG9hZGVkLm1ldGFkYXRhLnRoZW4obWV0YWRhdGEgPT4gewogICAgICAgIHRoaXMuc2V0TWV0YWRhdGEobWV0YWRhdGEpCiAgICAgIH0pCiAgICAgIHRoaXMuYm9vay5sb2FkZWQubmF2aWdhdGlvbi50aGVuKG5hdiA9PiB7CiAgICAgICAgLy9jb25zb2xlLmxvZyhuYXYpCiAgICAgICAgLy/ojrflj5bnlLXlrZDkuabnmoTnm67lvZUKICAgICAgICBjb25zdCBuYXZJdGVtID0gKGZ1bmN0aW9uIGZsYXR0ZW4oYXJyKSB7CiAgICAgICAgICByZXR1cm4gW10uY29uY2F0KC4uLmFyci5tYXAodiA9PiBbdiwgLi4uZmxhdHRlbih2LnN1Yml0ZW1zKV0pKQogICAgICAgIH0pKG5hdi50b2MpCiAgICAgICAgLy/lsIbmoJHnirbnm67lvZXnu5PmnoTovazljJbkuLrkuIDnu7TmlbDnu4QKICAgICAgICBmdW5jdGlvbiBmaW5kKGl0ZW0sIHYgPSAwKSB7CiAgICAgICAgICBjb25zdCBwYXJlbnQgPSBuYXZJdGVtLmZpbHRlcihpdCA9PiBpdC5pZCA9PT0gaXRlbS5wYXJlbnQpWzBdCiAgICAgICAgICByZXR1cm4gIWl0ZW0ucGFyZW50ID8gdiA6IHBhcmVudCA/IGZpbmQocGFyZW50LCArK3YpIDogdgogICAgICAgIH0KCiAgICAgICAgbmF2SXRlbS5mb3JFYWNoKGl0ZW0gPT4gewogICAgICAgICAgaXRlbS5sZXZlbCA9IGZpbmQoaXRlbSkKICAgICAgICAgIGl0ZW0udG90YWwgPSAwCiAgICAgICAgICBpdGVtLnBhZ2VsaXN0ID0gW10KICAgICAgICAgIGlmIChpdGVtLmhyZWYubWF0Y2goL14oLiopXC5odG1sJC8pKSB7CiAgICAgICAgICAgIGl0ZW0uaWRocmVmID0gaXRlbS5ocmVmLm1hdGNoKC9eKC4qKVwuaHRtbCQvKVsxXQogICAgICAgICAgfSBlbHNlIGlmIChpdGVtLmhyZWYubWF0Y2goL14oLiopXC54aHRtbCQvKSkgewogICAgICAgICAgICBpdGVtLmlkaHJlZiA9IGl0ZW0uaHJlZi5tYXRjaCgvXiguKilcLnhodG1sJC8pWzFdCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICB0aGlzLnNldE5hdmlnYXRpb24obmF2SXRlbSkKICAgICAgfSkKICAgIH0sCiAgICBpbml0RXB1Yih1cmwpIHsKICAgICAgLy9jb25zdCB1cmwgPXByb2Nlc3MuZW52LlZVRV9BUFBfUkVTX1VSTCArICIvZXB1Yi8iICsgdGhpcy5maWxlTmFtZSArICIuZXB1YiI7CiAgICAgIC8v55S15a2Q5Lmm55qE6Kej5p6Q5ZKM5riy5p+TCiAgICAgIC8v55Sf5oiQRWJvb2vlr7nosaEKICAgICAgdGhpcy5ib29rID0gbmV3IEVwdWIodXJsKQogICAgICB0aGlzLnNldEN1cnJlbnRCb29rKHRoaXMuYm9vaykKICAgICAgdGhpcy5pbml0UmVuZGl0aW9uKCkKICAgICAgdGhpcy5pbml0R2VzdHVyZSgpCiAgICAgIHRoaXMucGFyc2VCb29rKCkKICAgICAgdGhpcy5ib29rLnJlYWR5CiAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgLy/liIbpobUKICAgICAgICAgIHJldHVybiB0aGlzLmJvb2subG9jYXRpb25zLmdlbmVyYXRlKAogICAgICAgICAgICA3NTAgKiAod2luZG93LmlubmVyV2lkdGggLyAzNzUpICogKGdldEZvbnRTaXplKHRoaXMuZmlsZU5hbWUpIC8gMTYpCiAgICAgICAgICApCiAgICAgICAgfSkKICAgICAgICAudGhlbihsb2NhdGlvbnMgPT4gewogICAgICAgICAgLy9jb25zb2xlLmxvZyhsb2NhdGlvbnMpOwogICAgICAgICAgdGhpcy5zZXRCb29rQXZhaWxhYmxlKHRydWUpCiAgICAgICAgICB0aGlzLnJlZnJlc2hMb2NhdGlvbigpCiAgICAgICAgfSkKICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICBjb25zdCBib29rcyA9IHRoaXMuJHJvdXRlLnBhcmFtcy5maWxlTmFtZS5zcGxpdCgnfCcpCiAgICBjb25zdCBmaWxlTmFtZSA9IGJvb2tzWzFdCiAgICAvL+ivu+WPluemu+e6v+e8k+WtmAogICAgZ2V0TG9jYWxGb3JhZ2UoZmlsZU5hbWUsIChlcnIsIGJsb2IpID0+IHsKICAgICAgaWYgKCFlcnIgJiYgYmxvYikgewogICAgICAgIC8v55S15a2Q5Lmm5pyJ56a757q/57yT5a2YCiAgICAgICAgLy9jb25zb2xlLmxvZygi5om+5Yiw56a757q/6LWE5rqQIik7CiAgICAgICAgdGhpcy5zZXRmaWxlTmFtZShib29rcy5qb2luKCcvJykpLnRoZW4oKCkgPT4gewogICAgICAgICAgdGhpcy5pbml0RXB1YihibG9iKQogICAgICAgIH0pCiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy/ojrflj5blnKjnur/pnZnmgIHotYTmupDnmoTot6/lvoQKICAgICAgICB0aGlzLnNldGZpbGVOYW1lKGJvb2tzLmpvaW4oJy8nKSkudGhlbigoKSA9PiB7CiAgICAgICAgICBjb25zdCB1cmwgPQogICAgICAgICAgICBwcm9jZXNzLmVudi5WVUVfQVBQX1JFU19VUkwgKyAnL2VwdWIvJyArIHRoaXMuZmlsZU5hbWUgKyAnLmVwdWInCiAgICAgICAgICB0aGlzLmluaXRFcHViKHVybCkKICAgICAgICB9KQogICAgICB9CiAgICB9KQogIH0KfQo="},{"version":3,"sources":["EbookReader.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;AAeA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EbookReader.vue","sourceRoot":"src/components/Ebook","sourcesContent":["<template>\r\n  <div class=\"ebook-reader\">\r\n    <div\r\n      class=\"ebook-reader-mask\"\r\n      @touchmove=\"move\"\r\n      @touchend=\"moveEnd\"\r\n      @mousedown.left=\"onMouseEnter\"\r\n      @mousemove.left=\"onMouseMove\"\r\n      @mouseup.left=\"onMouseEnd\"\r\n      @click=\"onMaskClick\"\r\n    ></div>\r\n    <div id=\"read\" @click=\"toggleTitleAndMenu\"></div>\r\n  </div>\r\n</template>\r\n<script>\r\n  import Epub from 'epubjs'\r\n  import { ebookMixin } from '../../utils/mixin'\r\n  import {\r\n    getFontFamily,\r\n    saveFontFamily,\r\n    getFontSize,\r\n    saveFontSize,\r\n    getTheme,\r\n    saveTheme,\r\n    getLocation\r\n  } from '../../utils/localStorage'\r\n  import { getLocalForage } from '../../utils/localForage'\r\n  global.ePub = Epub\r\n  export default {\r\n    mixins: [ebookMixin],\r\n    methods: {\r\n      move(e) {\r\n        let offsetY = 0\r\n        if (this.firstOffsetY) {\r\n          offsetY = e.changedTouches[0].clientY - this.firstOffsetY\r\n          this.setOffsetY(offsetY)\r\n        } else {\r\n          this.firstOffsetY = e.changedTouches[0].clientY\r\n        }\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n      },\r\n      moveEnd(e) {\r\n        this.setOffsetY(0)\r\n        this.firstOffsetY = 0\r\n      },\r\n      onMouseEnter(e) {\r\n        this.mouseMove = 1\r\n        this.mouseStartTime = e.timeStamp\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n      },\r\n      onMouseMove(e) {\r\n        if (this.mouseMove === 1) {\r\n          this.mouseMove = 2\r\n        } else if (this.mouseMove === 2) {\r\n          let offsetY = 0\r\n          if (this.firstOffsetY) {\r\n            offsetY = e.clientY - this.firstOffsetY\r\n            this.setOffsetY(offsetY)\r\n          } else {\r\n            this.firstOffsetY = e.clientY\r\n          }\r\n        }\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n      },\r\n      onMouseEnd(e) {\r\n        if (this.mouseMove === 2) {\r\n          this.setOffsetY(0)\r\n          this.firstOffsetY = 0\r\n          this.mouseMove = 3\r\n        }\r\n        this.mouseEndTime = e.timeStamp\r\n        const time = this.mouseEndTime - this.mouseStartTime\r\n        if (time < 200) {\r\n          this.mouseMove = 1\r\n        }\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n      },\r\n      onMaskClick(e) {\r\n        const offsetX = e.offsetX\r\n        const width = window.innerWidth\r\n        if (offsetX > 0 && offsetX < width * 0.3) {\r\n          this.prevPage()\r\n        } else if (offsetX > 0 && offsetX > width * 0.7) {\r\n          this.nextPage()\r\n        } else {\r\n          this.toggleTitleAndMenu()\r\n        }\r\n      },\r\n      prevPage() {\r\n        //调用Rendition的prev方法返回上一页\r\n        if (this.rendition) {\r\n          this.rendition.prev().then(() => {\r\n            this.refreshLocation()\r\n          })\r\n        }\r\n        this.hideTitleAndMenu()\r\n      },\r\n      nextPage() {\r\n        //调用Rendition的next方法返回上一页\r\n        if (this.rendition) {\r\n          this.rendition.next().then(() => {\r\n            this.refreshLocation()\r\n          })\r\n        }\r\n        this.hideTitleAndMenu()\r\n      },\r\n      toggleTitleAndMenu() {\r\n        if (this.menuVisible) {\r\n          this.setSettingVisible(-1)\r\n          this.setFontFamilyVisible(false)\r\n        }\r\n        this.setMenuVisible(!this.menuVisible)\r\n      },\r\n\r\n      initFontSize() {\r\n        //读取localStorage中的FontSize\r\n        let fontSize = getFontSize(this.fileName)\r\n        if (fontSize) {\r\n          this.rendition.themes.fontSize(fontSize)\r\n          this.setDefaultFontSize(fontSize)\r\n        } else {\r\n          saveFontSize(this.fileName, this.defaultFontSize)\r\n        }\r\n      },\r\n      initFontFamily() {\r\n        //读取localStorage中的Font\r\n        let font = getFontFamily(this.fileName)\r\n        if (font) {\r\n          this.rendition.themes.font(font)\r\n          this.setDefaultFontFamily(font)\r\n        } else {\r\n          saveFontFamily(this.fileName, this.defaultFontFamily)\r\n        }\r\n      },\r\n      initTheme() {\r\n        //初始化主题\r\n        let defaultTheme = getTheme(this.fileName)\r\n        if (!defaultTheme) {\r\n          defaultTheme = this.themeList[0].name\r\n          saveTheme(this.fileName, defaultTheme)\r\n        }\r\n        this.setDefaultTheme(defaultTheme)\r\n        this.themeList.forEach(theme => {\r\n          this.rendition.themes.register(theme.name, theme.style)\r\n        })\r\n        this.rendition.themes.select(defaultTheme)\r\n      },\r\n      initGesture() {\r\n        this.rendition.on('touchstart', event => {\r\n          this.touchStartX = event.changedTouches[0].clientX\r\n          this.touchStartTime = event.timeStamp\r\n        })\r\n        this.rendition.on('touchend', event => {\r\n          const offsetX = event.changedTouches[0].clientX - this.touchStartX\r\n          const time = event.timeStamp - this.touchStartTime\r\n          //根据手势事件实现翻页功能\r\n          if (time < 500 && offsetX > 40) {\r\n            this.prevPage()\r\n          } else if (time < 500 && offsetX < -40) {\r\n            this.nextPage()\r\n          } else {\r\n            this.toggleTitleAndMenu()\r\n          }\r\n          //组织默认事件和冒泡\r\n          event.preventDefault()\r\n          event.stopPropagation()\r\n        })\r\n      },\r\n      initRendition() {\r\n        //生成Rendition对象\r\n        this.rendition = this.book.renderTo('read', {\r\n          width: window.innerWidth,\r\n          height: window.innerHeight,\r\n          method: 'default'\r\n        })\r\n        //通过Rendition对象的display方法渲染电子书\r\n        const location = getLocation(this.fileName)\r\n        this.display(location, () => {\r\n          this.initFontSize()\r\n          this.initFontFamily()\r\n          this.initTheme()\r\n          this.initGlobalStyle()\r\n        })\r\n        this.rendition.hooks.content.register(contents => {\r\n          Promise.all([\r\n            contents.addStylesheet(\r\n              `${process.env.VUE_APP_RES_URL}/fonts/cabin.css`\r\n            ),\r\n            contents.addStylesheet(\r\n              `${process.env.VUE_APP_RES_URL}/fonts/montserrat.css`\r\n            ),\r\n            contents.addStylesheet(\r\n              `${process.env.VUE_APP_RES_URL}/fonts/tangerine.css`\r\n            ),\r\n            contents.addStylesheet(\r\n              `${process.env.VUE_APP_RES_URL}/fonts/daysOne.css`\r\n            )\r\n          ]).then(() => {})\r\n        })\r\n      },\r\n      parseBook() {\r\n        //解析电子书的封面\r\n        this.book.loaded.cover.then(cover => {\r\n          this.book.archive.createUrl(cover).then(url => {\r\n            this.setCover(url)\r\n          })\r\n        })\r\n        this.book.loaded.metadata.then(metadata => {\r\n          this.setMetadata(metadata)\r\n        })\r\n        this.book.loaded.navigation.then(nav => {\r\n          //console.log(nav)\r\n          //获取电子书的目录\r\n          const navItem = (function flatten(arr) {\r\n            return [].concat(...arr.map(v => [v, ...flatten(v.subitems)]))\r\n          })(nav.toc)\r\n          //将树状目录结构转化为一维数组\r\n          function find(item, v = 0) {\r\n            const parent = navItem.filter(it => it.id === item.parent)[0]\r\n            return !item.parent ? v : parent ? find(parent, ++v) : v\r\n          }\r\n\r\n          navItem.forEach(item => {\r\n            item.level = find(item)\r\n            item.total = 0\r\n            item.pagelist = []\r\n            if (item.href.match(/^(.*)\\.html$/)) {\r\n              item.idhref = item.href.match(/^(.*)\\.html$/)[1]\r\n            } else if (item.href.match(/^(.*)\\.xhtml$/)) {\r\n              item.idhref = item.href.match(/^(.*)\\.xhtml$/)[1]\r\n            }\r\n          })\r\n          this.setNavigation(navItem)\r\n        })\r\n      },\r\n      initEpub(url) {\r\n        //const url =process.env.VUE_APP_RES_URL + \"/epub/\" + this.fileName + \".epub\";\r\n        //电子书的解析和渲染\r\n        //生成Ebook对象\r\n        this.book = new Epub(url)\r\n        this.setCurrentBook(this.book)\r\n        this.initRendition()\r\n        this.initGesture()\r\n        this.parseBook()\r\n        this.book.ready\r\n          .then(() => {\r\n            //分页\r\n            return this.book.locations.generate(\r\n              750 * (window.innerWidth / 375) * (getFontSize(this.fileName) / 16)\r\n            )\r\n          })\r\n          .then(locations => {\r\n            //console.log(locations);\r\n            this.setBookAvailable(true)\r\n            this.refreshLocation()\r\n          })\r\n      }\r\n    },\r\n    mounted() {\r\n      const books = this.$route.params.fileName.split('|')\r\n      const fileName = books[1]\r\n      //读取离线缓存\r\n      getLocalForage(fileName, (err, blob) => {\r\n        if (!err && blob) {\r\n          //电子书有离线缓存\r\n          //console.log(\"找到离线资源\");\r\n          this.setfileName(books.join('/')).then(() => {\r\n            this.initEpub(blob)\r\n          })\r\n        } else {\r\n          //获取在线静态资源的路径\r\n          this.setfileName(books.join('/')).then(() => {\r\n            const url =\r\n              process.env.VUE_APP_RES_URL + '/epub/' + this.fileName + '.epub'\r\n            this.initEpub(url)\r\n          })\r\n        }\r\n      })\r\n    }\r\n  }\r\n</script>\r\n<style lang=\"scss\" rel=\"stylesheet/scss\" scoped>\r\n  @import '../../assets/styles/global';\r\n\r\n  .ebook-reader {\r\n    width: 100%;\r\n    height: 100%;\r\n    overflow: hidden;\r\n    .ebook-reader-mask {\r\n      position: absolute;\r\n      z-index: 100;\r\n      top: 0;\r\n      left: 0;\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n  }\r\n</style>\r\n"]}]}