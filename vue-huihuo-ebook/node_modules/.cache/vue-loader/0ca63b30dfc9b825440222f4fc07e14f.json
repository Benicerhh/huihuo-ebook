{"remainingRequest":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\src\\views\\store\\StoreSpeaking.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\src\\views\\store\\StoreSpeaking.vue","mtime":1588909953411},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBEZXRhaWxUaXRsZSBmcm9tICcuLi8uLi9jb21wb25lbnRzL2RldGFpbC9EZXRhaWxUaXRsZScKaW1wb3J0IEJvb2tJbmZvIGZyb20gJy4uLy4uL2NvbXBvbmVudHMvZGV0YWlsL0Jvb2tJbmZvJwppbXBvcnQgU2Nyb2xsIGZyb20gJy4uLy4uL2NvbXBvbmVudHMvY29tbW9uL1Njcm9sbCcKaW1wb3J0IFNwZWFrUGxheWluZyBmcm9tICcuLi8uLi9jb21wb25lbnRzL3NwZWFrL1NwZWFrUGxheWluZycKaW1wb3J0IEJvdHRvbSBmcm9tICcuLi8uLi9jb21wb25lbnRzL3NwZWFrL1NwZWFrQm90dG9tJwppbXBvcnQgU3BlYWtXaW5kb3cgZnJvbSAnLi4vLi4vY29tcG9uZW50cy9zcGVhay9TcGVha01hc2snCmltcG9ydCB7IGZpbmRCb29rLCBnZXRDYXRlZ29yeU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zdG9yZScKaW1wb3J0IHsgZmxhdExpc3QgfSBmcm9tICcuLi8uLi9hcGkvc3RvcmUnCmltcG9ydCB7IGdldExvY2FsRm9yYWdlIH0gZnJvbSAnLi4vLi4vdXRpbHMvbG9jYWxGb3JhZ2UnCmltcG9ydCB7IHJlYWxQeCB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJwppbXBvcnQgRXB1YiBmcm9tICdlcHVianMnCgpnbG9iYWwuZVB1YiA9IEVwdWIKCmNvbnN0IEFQUElEID0gJzViNGRhNjhiJwpjb25zdCBBUElfU0VDUkVUID0gJzQ4NDg3ZTI1ZGU4MmEyYzE2N2VjY2RhMzBmN2EzYzcwJwpjb25zdCBBUElfS0VZID0gJzcxNTQxNzAyMTllM2U0NDI2MDI1YWZlZjgxMmQwNzBlJwpsZXQgaXNDaHJvbWUgPSBuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkubWF0Y2goL2Nocm9tZS8pCmxldCBub3RTdXBwb3J0VGlwID0gaXNDaHJvbWUKICA/ICfmgqjnmoTmtY/op4jlmajmmoLml7bkuI3mlK/mjIHkvZPpqozlip/og73vvIzor7fljYfnuqfmgqjnmoTmtY/op4jlmagnCiAgOiAn5oKo546w5Zyo5L2/55So55qE5rWP6KeI5Zmo5pqC5pe25LiN5pSv5oyB5L2T6aqM5Yqf6IO977yMPGJyIC8+5o6o6I2Q5L2/55So6LC35q2M5rWP6KeI5ZmoQ2hyb21lJwoKZnVuY3Rpb24gZ2V0V2Vic29ja2V0VXJsKCkgewogIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICB2YXIgYXBpS2V5ID0gQVBJX0tFWQogICAgdmFyIGFwaVNlY3JldCA9IEFQSV9TRUNSRVQKICAgIHZhciB1cmwgPSAnd3NzOi8vdHRzLWFwaS54Znl1bi5jbi92Mi90dHMnCiAgICB2YXIgaG9zdCA9IGxvY2F0aW9uLmhvc3QKICAgIHZhciBkYXRlID0gbmV3IERhdGUoKS50b0dNVFN0cmluZygpCiAgICB2YXIgYWxnb3JpdGhtID0gJ2htYWMtc2hhMjU2JwogICAgdmFyIGhlYWRlcnMgPSAnaG9zdCBkYXRlIHJlcXVlc3QtbGluZScKICAgIHZhciBzaWduYXR1cmVPcmlnaW4gPSBgaG9zdDogJHtob3N0fVxuZGF0ZTogJHtkYXRlfVxuR0VUIC92Mi90dHMgSFRUUC8xLjFgCiAgICB2YXIgc2lnbmF0dXJlU2hhID0gQ3J5cHRvSlMuSG1hY1NIQTI1NihzaWduYXR1cmVPcmlnaW4sIGFwaVNlY3JldCkKICAgIHZhciBzaWduYXR1cmUgPSBDcnlwdG9KUy5lbmMuQmFzZTY0LnN0cmluZ2lmeShzaWduYXR1cmVTaGEpCiAgICB2YXIgYXV0aG9yaXphdGlvbk9yaWdpbiA9IGBhcGlfa2V5PSIke2FwaUtleX0iLCBhbGdvcml0aG09IiR7YWxnb3JpdGhtfSIsIGhlYWRlcnM9IiR7aGVhZGVyc30iLCBzaWduYXR1cmU9IiR7c2lnbmF0dXJlfSJgCiAgICB2YXIgYXV0aG9yaXphdGlvbiA9IGJ0b2EoYXV0aG9yaXphdGlvbk9yaWdpbikKICAgIHVybCA9IGAke3VybH0/YXV0aG9yaXphdGlvbj0ke2F1dGhvcml6YXRpb259JmRhdGU9JHtkYXRlfSZob3N0PSR7aG9zdH1gCiAgICByZXNvbHZlKHVybCkKICB9KQp9CgpsZXQgYXVkaW9DdHgKbGV0IHNvdXJjZQpsZXQgYnRuU3RhdGUgPSB7CiAgdW5UVFM6ICfnq4vljbPlkIjmiJAnLAogIHR0c2luZzogJ+ato+WcqOWQiOaIkCcsCiAgZW5kVFRTOiAn56uL5Y2z5pKt5pS+JywKICBwbGF5OiAn5YGc5q2i5pKt5pS+JywKICBwYXVzZTogJ+e7p+e7reaSreaUvicsCiAgZW5kUGxheTogJ+mHjeaWsOaSreaUvicsCiAgZXJyb3JUVFM6ICflkIjmiJDlpLHotKUnCn0KCmNsYXNzIEV4cGVyaWVuY2UgewogIGNvbnN0cnVjdG9yKHsKICAgIHNwZWVkID0gNTAsCiAgICB2b2ljZSA9IDUwLAogICAgcGl0Y2ggPSA1MCwKICAgIHRleHQgPSAnJywKICAgIGVuZ2luZVR5cGUgPSAnYWlzb3VuZCcsCiAgICB2b2ljZU5hbWUgPSAneGlhb3lhbicsCiAgICBwbGF5QnRuID0gJy5qcy1iYXNlLXBsYXknLAogICAgZGVmYXVsdFRleHQgPSAnJwogIH0gPSB7fSkgewogICAgdGhpcy5zcGVlZCA9IHNwZWVkCiAgICB0aGlzLnZvaWNlID0gdm9pY2UKICAgIHRoaXMucGl0Y2ggPSBwaXRjaAogICAgdGhpcy50ZXh0ID0gdGV4dAogICAgdGhpcy5kZWZhdWx0VGV4dCA9IGRlZmF1bHRUZXh0CiAgICB0aGlzLmVuZ2luZVR5cGUgPSBlbmdpbmVUeXBlCiAgICB0aGlzLnZvaWNlTmFtZSA9IHZvaWNlTmFtZQogICAgdGhpcy5wbGF5QnRuID0gcGxheUJ0bgogICAgdGhpcy5wbGF5U3RhdGUgPSAnJwogICAgdGhpcy5hdWRpb0RhdGFzID0gW10KICAgIHRoaXMucGNtUGxheVdvcmsgPSBuZXcgV29ya2VyKCcuL3RyYW5zZm9ybS53b3JrZXIuanMnKQogICAgdGhpcy5wY21QbGF5V29yay5vbm1lc3NhZ2UgPSBlID0+IHsKICAgICAgdGhpcy5vbm1lc3NhZ2VXb3JrKGUpCiAgICB9CiAgfQoKICBzZXRDb25maWcoeyBzcGVlZCwgdm9pY2UsIHBpdGNoLCB0ZXh0LCBkZWZhdWx0VGV4dCwgZW5naW5lVHlwZSwgdm9pY2VOYW1lIH0pIHsKICAgIHNwZWVkICYmICh0aGlzLnNwZWVkID0gc3BlZWQpCiAgICB2b2ljZSAmJiAodGhpcy52b2ljZSA9IHZvaWNlKQogICAgcGl0Y2ggJiYgKHRoaXMucGl0Y2ggPSBwaXRjaCkKICAgIHRleHQgJiYgKHRoaXMudGV4dCA9IHRleHQpCiAgICBkZWZhdWx0VGV4dCAmJiAodGhpcy5kZWZhdWx0VGV4dCA9IGRlZmF1bHRUZXh0KQogICAgZW5naW5lVHlwZSAmJiAodGhpcy5lbmdpbmVUeXBlID0gZW5naW5lVHlwZSkKICAgIHZvaWNlTmFtZSAmJiAodGhpcy52b2ljZU5hbWUgPSB2b2ljZU5hbWUpCiAgICB0aGlzLnJlc2V0QXVkaW8oKQogIH0KCiAgb25tZXNzYWdlV29yayhlKSB7CiAgICBzd2l0Y2ggKGUuZGF0YS5jb21tYW5kKSB7CiAgICAgIGNhc2UgJ25ld0F1ZGlvRGF0YSc6IHsKICAgICAgICB0aGlzLmF1ZGlvRGF0YXMucHVzaChlLmRhdGEuZGF0YSkKICAgICAgICBpZiAodGhpcy5wbGF5U3RhdGUgPT09ICd0dHNpbmcnICYmIHRoaXMuYXVkaW9EYXRhcy5sZW5ndGggPT09IDEpIHsKICAgICAgICAgIHRoaXMucGxheVRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgdGhpcy5hdWRpb1BsYXkoKQogICAgICAgICAgfSwgMTAwMCkKICAgICAgICB9CiAgICAgICAgYnJlYWsKICAgICAgfQogICAgfQogIH0KCiAgc2V0QnRuU3RhdGUoc3RhdGUpIHsKICAgIGxldCBvbGRTdGF0ZSA9IHRoaXMucGxheVN0YXRlCiAgICB0aGlzLnBsYXlTdGF0ZSA9IHN0YXRlCiAgfQoKICBnZXRBdWRpbygpIHsKICAgIHRoaXMuc2V0QnRuU3RhdGUoJ3R0c2luZycpCiAgICBnZXRXZWJzb2NrZXRVcmwoKS50aGVuKHVybCA9PiB7CiAgICAgIHRoaXMuY29ubmVjdFdlYnNvY2tldCh1cmwpCiAgICB9KQogIH0KCiAgY29ubmVjdFdlYnNvY2tldCh1cmwpIHsKICAgIGlmICgnV2ViU29ja2V0JyBpbiB3aW5kb3cpIHsKICAgICAgdGhpcy53ZWJzb2NrZXQgPSBuZXcgV2ViU29ja2V0KHVybCkKICAgIH0gZWxzZSBpZiAoJ01veldlYlNvY2tldCcgaW4gd2luZG93KSB7CiAgICAgIHRoaXMud2Vic29ja2V0ID0gbmV3IE1veldlYlNvY2tldCh1cmwpCiAgICB9IGVsc2UgewogICAgICBhbGVydChub3RTdXBwb3J0VGlwKQogICAgICByZXR1cm4KICAgIH0KICAgIGxldCBzZWxmID0gdGhpcwogICAgdGhpcy53ZWJzb2NrZXQub25vcGVuID0gZSA9PiB7CiAgICAgIHZhciBwYXJhbXMgPSB7CiAgICAgICAgY29tbW9uOiB7CiAgICAgICAgICBhcHBfaWQ6IEFQUElEIC8vIEFQUElECiAgICAgICAgfSwKICAgICAgICBidXNpbmVzczogewogICAgICAgICAgZW50OiBzZWxmLmVuZ2luZVR5cGUsCiAgICAgICAgICBhdWU6ICdyYXcnLAogICAgICAgICAgYXVmOiAnYXVkaW8vTDE2O3JhdGU9MTYwMDAnLAogICAgICAgICAgdmNuOiBzZWxmLnZvaWNlTmFtZSwKICAgICAgICAgIHNwZWVkOiBzZWxmLnNwZWVkLAogICAgICAgICAgdm9sdW1lOiBzZWxmLnZvaWNlICogMTAsCiAgICAgICAgICBwaXRjaDogc2VsZi5waXRjaCwKICAgICAgICAgIC8vJ2Jncyc6IDEsCiAgICAgICAgICB0dGU6ICdVVEY4JwogICAgICAgIH0sCiAgICAgICAgZGF0YTogewogICAgICAgICAgc3RhdHVzOiAyLAogICAgICAgICAgdGV4dDogQmFzZTY0LmVuY29kZShzZWxmLnRleHQgfHwgc2VsZi5kZWZhdWx0VGV4dCB8fCBERUZBVUxUX1RFWFQpCiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMud2Vic29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkocGFyYW1zKSkKICAgIH0KICAgIHRoaXMud2Vic29ja2V0Lm9ubWVzc2FnZSA9IGUgPT4gewogICAgICBsZXQganNvbkRhdGEgPSBKU09OLnBhcnNlKGUuZGF0YSkKICAgICAgLy8g5ZCI5oiQ5aSx6LSlCiAgICAgIGlmIChqc29uRGF0YS5jb2RlICE9PSAwKSB7CiAgICAgICAgYWxlcnQoYCR7anNvbkRhdGEuY29kZX06JHtqc29uRGF0YS5tZXNzYWdlfWApCiAgICAgICAgc2VsZi5yZXNldEF1ZGlvKCkKICAgICAgICB0aGlzLndlYnNvY2tldC5jbG9zZSgpCiAgICAgICAgcmV0dXJuCiAgICAgIH0KICAgICAgc2VsZi5wY21QbGF5V29yay5wb3N0TWVzc2FnZSh7CiAgICAgICAgY29tbWFuZDogJ3RyYW5zRGF0YScsCiAgICAgICAgZGF0YToganNvbkRhdGEuZGF0YS5hdWRpbwogICAgICB9KQoKICAgICAgaWYgKGpzb25EYXRhLmNvZGUgPT09IDAgJiYganNvbkRhdGEuZGF0YS5zdGF0dXMgPT09IDIpIHsKICAgICAgICB0aGlzLndlYnNvY2tldC5jbG9zZSgpCiAgICAgIH0KICAgIH0KICAgIHRoaXMud2Vic29ja2V0Lm9uZXJyb3IgPSBlID0+IHsKICAgICAgY29uc29sZS5sb2coZSkKICAgICAgY29uc29sZS5sb2coZS5kYXRhKQogICAgfQogICAgdGhpcy53ZWJzb2NrZXQub25jbG9zZSA9IGUgPT4gewogICAgICBjb25zb2xlLmxvZyhlKQogICAgfQogIH0KCiAgcmVzZXRBdWRpbygpIHsKICAgIHRoaXMuYXVkaW9QYXVzZSgpCiAgICB0aGlzLnNldEJ0blN0YXRlKCd1blRUUycpCiAgICB0aGlzLmF1ZGlvRGF0YXNJbmRleCA9IDAKICAgIHRoaXMuYXVkaW9EYXRhcyA9IFtdCiAgICB0aGlzLndlYnNvY2tldCAmJiB0aGlzLndlYnNvY2tldC5jbG9zZSgpCiAgICBjbGVhclRpbWVvdXQodGhpcy5wbGF5VGltZW91dCkKICB9CgogIGF1ZGlvUGxheSgpIHsKICAgIHRyeSB7CiAgICAgIGlmICghYXVkaW9DdHgpIHsKICAgICAgICBhdWRpb0N0eCA9IG5ldyAod2luZG93LkF1ZGlvQ29udGV4dCB8fCB3aW5kb3cud2Via2l0QXVkaW9Db250ZXh0KSgpCiAgICAgIH0KICAgICAgaWYgKCFhdWRpb0N0eCkgewogICAgICAgIGFsZXJ0KG5vdFN1cHBvcnRUaXApCiAgICAgICAgcmV0dXJuCiAgICAgIH0KICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgYWxlcnQobm90U3VwcG9ydFRpcCkKICAgICAgcmV0dXJuCiAgICB9CiAgICB0aGlzLmF1ZGlvRGF0YXNJbmRleCA9IDAKICAgIGlmICh0aGlzLmF1ZGlvRGF0YXMubGVuZ3RoKSB7CiAgICAgIHRoaXMucGxheVNvdXJjZSgpCiAgICAgIHRoaXMuc2V0QnRuU3RhdGUoJ3BsYXknKQogICAgfSBlbHNlIHsKICAgICAgdGhpcy5nZXRBdWRpbygpCiAgICB9CiAgfQoKICBhdWRpb1BhdXNlKHN0YXRlKSB7CiAgICBpZiAodGhpcy5wbGF5U3RhdGUgPT09ICdwbGF5JykgewogICAgICB0aGlzLnNldEJ0blN0YXRlKHN0YXRlIHx8ICdlbmRQbGF5JykKICAgIH0KICAgIGNsZWFyVGltZW91dCh0aGlzLnBsYXlUaW1lb3V0KQogICAgdHJ5IHsKICAgICAgc291cmNlICYmIHNvdXJjZS5zdG9wKCkKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgY29uc29sZS5sb2coZSkKICAgIH0KICB9CgogIHBsYXlTb3VyY2UoKSB7CiAgICBsZXQgYnVmZmVyTGVuZ3RoID0gMAogICAgbGV0IGRhdGFMZW5ndGggPSB0aGlzLmF1ZGlvRGF0YXMubGVuZ3RoCiAgICBmb3IgKGxldCBpID0gdGhpcy5hdWRpb0RhdGFzSW5kZXg7IGkgPCBkYXRhTGVuZ3RoOyBpKyspIHsKICAgICAgYnVmZmVyTGVuZ3RoICs9IHRoaXMuYXVkaW9EYXRhc1tpXS5sZW5ndGgKICAgIH0KICAgIGxldCBhdWRpb0J1ZmZlciA9IGF1ZGlvQ3R4LmNyZWF0ZUJ1ZmZlcigxLCBidWZmZXJMZW5ndGgsIDIyMDUwKQogICAgbGV0IG9mZnNldCA9IDAKICAgIGxldCBub3dCdWZmZXJpbmcgPSBhdWRpb0J1ZmZlci5nZXRDaGFubmVsRGF0YSgwKQogICAgZm9yIChsZXQgaSA9IHRoaXMuYXVkaW9EYXRhc0luZGV4OyBpIDwgZGF0YUxlbmd0aDsgaSsrKSB7CiAgICAgIGxldCBhdWRpb0RhdGEgPSB0aGlzLmF1ZGlvRGF0YXNbaV0KICAgICAgaWYgKGF1ZGlvQnVmZmVyLmNvcHlUb0NoYW5uZWwpIHsKICAgICAgICBhdWRpb0J1ZmZlci5jb3B5VG9DaGFubmVsKGF1ZGlvRGF0YSwgMCwgb2Zmc2V0KQogICAgICB9IGVsc2UgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgYXVkaW9EYXRhLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBub3dCdWZmZXJpbmdbb2Zmc2V0ICsgal0gPSBhdWRpb0RhdGFbal0KICAgICAgICB9CiAgICAgIH0KICAgICAgb2Zmc2V0ICs9IGF1ZGlvRGF0YS5sZW5ndGgKICAgICAgdGhpcy5hdWRpb0RhdGFzSW5kZXgrKwogICAgfQoKICAgIHNvdXJjZSA9IGF1ZGlvQ3R4LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpCiAgICBzb3VyY2UuYnVmZmVyID0gYXVkaW9CdWZmZXIKICAgIHNvdXJjZS5jb25uZWN0KGF1ZGlvQ3R4LmRlc3RpbmF0aW9uKQogICAgc291cmNlLnN0YXJ0KCkKICAgIHNvdXJjZS5vbmVuZGVkID0gZXZlbnQgPT4gewogICAgICBpZiAodGhpcy5wbGF5U3RhdGUgIT09ICdwbGF5JykgewogICAgICAgIHJldHVybgogICAgICB9CiAgICAgIGlmICh0aGlzLmF1ZGlvRGF0YXNJbmRleCA8IHRoaXMuYXVkaW9EYXRhcy5sZW5ndGgpIHsKICAgICAgICB0aGlzLnBsYXlTb3VyY2UoKQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYXVkaW9QYXVzZSgnZW5kUGxheScpCiAgICAgIH0KICAgIH0KICB9Cn0KCmxldCBleHBlcmllbmNlID0gbmV3IEV4cGVyaWVuY2UoewogIHNwZWVkOiA1MCwKICB2b2ljZTogNTAsCiAgcGl0Y2g6IDUwLAogIHBsYXlCdG46IGAuYXVkaW8tY3RybC1idG5gCn0pCgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgRGV0YWlsVGl0bGUsCiAgICBCb29rSW5mbywKICAgIFNjcm9sbCwKICAgIFNwZWFrUGxheWluZywKICAgIEJvdHRvbSwKICAgIFNwZWFrV2luZG93CiAgfSwKICBjb21wdXRlZDogewogICAgLy8g6Z+z6aKR5b2T5YmN5pKt5pS+55qE5YiG6ZKf5pWwCiAgICBjdXJyZW50TWludXRlKCkgewogICAgICBjb25zdCBtID0gTWF0aC5mbG9vcih0aGlzLmN1cnJlbnRQbGF5aW5nVGltZSAvIDYwKQogICAgICByZXR1cm4gbSA8IDEwID8gJzAnICsgbSA6IG0KICAgIH0sCiAgICAvLyDpn7PpopHlvZPliY3mkq3mlL7nmoTnp5LmlbAKICAgIGN1cnJlbnRTZWNvbmQoKSB7CiAgICAgIGNvbnN0IHMgPSBNYXRoLmZsb29yKAogICAgICAgIHRoaXMuY3VycmVudFBsYXlpbmdUaW1lIC0gcGFyc2VJbnQodGhpcy5jdXJyZW50TWludXRlKSAqIDYwCiAgICAgICkKICAgICAgcmV0dXJuIHMgPCAxMCA/ICcwJyArIHMgOiBzCiAgICB9LAogICAgLy8g6Z+z6aKR55qE5oC75pe26ZW/CiAgICB0b3RhbE1pbnV0ZSgpIHsKICAgICAgY29uc3QgbSA9IE1hdGguZmxvb3IodGhpcy50b3RhbFBsYXlpbmdUaW1lIC8gNjApCiAgICAgIHJldHVybiBtIDwgMTAgPyAnMCcgKyBtIDogbQogICAgfSwKICAgIC8vIOmfs+mikeeahOaAu+enkuaVsAogICAgdG90YWxTZWNvbmQoKSB7CiAgICAgIGNvbnN0IHMgPSBNYXRoLmZsb29yKAogICAgICAgIHRoaXMudG90YWxQbGF5aW5nVGltZSAtIHBhcnNlSW50KHRoaXMudG90YWxNaW51dGUpICogNjAKICAgICAgKQogICAgICByZXR1cm4gcyA8IDEwID8gJzAnICsgcyA6IHMKICAgIH0sCiAgICAvLyDpn7PpopHnmoTliankvZnliIbpkp/mlbAKICAgIGxlZnRNaW51dGUoKSB7CiAgICAgIGNvbnN0IG0gPSBNYXRoLmZsb29yKAogICAgICAgICh0aGlzLnRvdGFsUGxheWluZ1RpbWUgLSB0aGlzLmN1cnJlbnRQbGF5aW5nVGltZSkgLyA2MAogICAgICApCiAgICAgIHJldHVybiBtIDwgMTAgPyAnMCcgKyBtIDogbQogICAgfSwKICAgIC8vIOmfs+mikeeahOWJqeS9meenkuaVsAogICAgbGVmdFNlY29uZCgpIHsKICAgICAgY29uc3QgcyA9IE1hdGguZmxvb3IoCiAgICAgICAgdGhpcy50b3RhbFBsYXlpbmdUaW1lIC0KICAgICAgICAgIHRoaXMuY3VycmVudFBsYXlpbmdUaW1lIC0KICAgICAgICAgIHBhcnNlSW50KHRoaXMubGVmdE1pbnV0ZSkgKiA2MAogICAgICApCiAgICAgIHJldHVybiBzIDwgMTAgPyAnMCcgKyBzIDogcwogICAgfSwKICAgIC8vIOaSreaUvuS/oeaBr+WvueixoQogICAgcGxheUluZm8oKSB7CiAgICAgIGlmICh0aGlzLmF1ZGlvQ2FuUGxheSkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBjdXJyZW50TWludXRlOiB0aGlzLmN1cnJlbnRNaW51dGUsCiAgICAgICAgICBjdXJyZW50U2Vjb25kOiB0aGlzLmN1cnJlbnRTZWNvbmQsCiAgICAgICAgICB0b3RhbE1pbnV0ZTogdGhpcy50b3RhbE1pbnV0ZSwKICAgICAgICAgIHRvdGFsU2Vjb25kOiB0aGlzLnRvdGFsU2Vjb25kLAogICAgICAgICAgbGVmdE1pbnV0ZTogdGhpcy5sZWZ0TWludXRlLAogICAgICAgICAgbGVmdFNlY29uZDogdGhpcy5sZWZ0U2Vjb25kCiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBudWxsCiAgICAgIH0KICAgIH0sCiAgICAvLyDnlLXlrZDkuabnmoTor63np40KICAgIGxhbmcoKSB7CiAgICAgIHJldHVybiB0aGlzLm1ldGFkYXRhID8gdGhpcy5tZXRhZGF0YS5sYW5ndWFnZSA6ICcnCiAgICB9LAogICAgLy8g5b2T5pKt5pS+6Z2i5p2/5pi+56S65pe277yM56aB55So5rua5Yqo5p2h77yI6Kej5Yaz5LqL5Lu256m/6YCP6Zeu6aKY77yJCiAgICBkaXNhYmxlU2Nyb2xsKCkgewogICAgICBpZiAodGhpcy4kcmVmcy5zcGVha1dpbmRvdykgewogICAgICAgIHJldHVybiB0aGlzLiRyZWZzLnNwZWFrV2luZG93LnZpc2libGUKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfQogICAgfSwKICAgIC8vIOaYr+WQpuW6lemDqOeahOaSreaUvumdouadvwogICAgc2hvd1BsYXkoKSB7CiAgICAgIHJldHVybiB0aGlzLnBsYXlpbmdJbmRleCA+PSAwCiAgICB9LAogICAgLy8g5rua5Yqo5p2h6Led5bqV6YOo6Led56a777yM5b2T5pi+56S65pKt5pS+6Z2i5p2/5pe25Li6MTE25YOP57Sg77yM5LiN5pi+56S65pe25Li6NTLlg4/ntKAKICAgIHNjcm9sbEJvdHRvbSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc2hvd1BsYXkgPyAxMTYgOiA1MgogICAgfSwKICAgIC8vIOW9k+WJjeeroOiKguS/oeaBrwogICAgY2hhcHRlcigpIHsKICAgICAgcmV0dXJuIHRoaXMuZmxhdE5hdmlnYXRpb25bdGhpcy5wbGF5aW5nSW5kZXhdCiAgICB9LAogICAgLy8g55S15a2Q5Lmm5pGY6KaB5L+h5oGvCiAgICBkZXNjKCkgewogICAgICBpZiAodGhpcy5kZXNjcmlwdGlvbikgewogICAgICAgIHJldHVybiB0aGlzLmRlc2NyaXB0aW9uLnN1YnN0cmluZygwLCAxMDApCiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuICcnCiAgICAgIH0KICAgIH0sCiAgICAvLyDkuIDnu7TmlbDnu4TnmoTnm67lvZUKICAgIGZsYXROYXZpZ2F0aW9uKCkgewogICAgICBpZiAodGhpcy5uYXZpZ2F0aW9uKSB7CiAgICAgICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5jb25jYXQuYXBwbHkoCiAgICAgICAgICBbXSwKICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5jb25jYXQuYXBwbHkoCiAgICAgICAgICAgIFtdLAogICAgICAgICAgICB0aGlzLmRvRmxhdE5hdmlnYXRpb24odGhpcy5uYXZpZ2F0aW9uLnRvYykKICAgICAgICAgICkKICAgICAgICApCiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIFtdCiAgICAgIH0KICAgIH0sCiAgICAvLyDnlLXlrZDkuabliIbnsbsKICAgIGNhdGVnb3J5KCkgewogICAgICByZXR1cm4gdGhpcy5ib29rSXRlbSA/IGdldENhdGVnb3J5TmFtZSh0aGlzLmJvb2tJdGVtLmNhdGVnb3J5KSA6ICcnCiAgICB9LAogICAgLy8g55S15a2Q5Lmm5Lmm5ZCNCiAgICB0aXRsZSgpIHsKICAgICAgcmV0dXJuIHRoaXMubWV0YWRhdGEgPyB0aGlzLm1ldGFkYXRhLnRpdGxlIDogJycKICAgIH0sCiAgICAvLyDnlLXlrZDkuabkvZzogIUKICAgIGF1dGhvcigpIHsKICAgICAgcmV0dXJuIHRoaXMubWV0YWRhdGEgPyB0aGlzLm1ldGFkYXRhLmNyZWF0b3IgOiAnJwogICAgfQogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGJvb2tJdGVtOiBudWxsLAogICAgICBib29rOiBudWxsLAogICAgICByZW5kaXRpb246IG51bGwsCiAgICAgIG1ldGFkYXRhOiBudWxsLAogICAgICBjb3ZlcjogbnVsbCwKICAgICAgbmF2aWdhdGlvbjogbnVsbCwKICAgICAgZGVzY3JpcHRpb246IG51bGwsCiAgICAgIGlmU2hvd0NvbnRlbnQ6IHRydWUsCiAgICAgIHBsYXlpbmdJbmRleDogLTEsCiAgICAgIHBhcmFncmFwaDogbnVsbCwKICAgICAgY3VycmVudFNlY3Rpb25JbmRleDogbnVsbCwKICAgICAgY3VycmVudFNlY3Rpb25Ub3RhbDogbnVsbCwKICAgICAgc2VjdGlvbjogbnVsbCwKICAgICAgaXNQbGF5aW5nOiBmYWxzZSwKICAgICAgYXVkaW86IG51bGwsCiAgICAgIGF1ZGlvQ2FuUGxheTogZmFsc2UsCiAgICAgIGN1cnJlbnRQbGF5aW5nVGltZTogMCwKICAgICAgdG90YWxQbGF5aW5nVGltZTogMCwKICAgICAgcGxheVN0YXR1czogMCwgLy8gMCAtIOacquaSreaUvu+8jDEgLSDmkq3mlL7kuK3vvIwyIC0g5pqC5YGc5LitCiAgICAgIHRvYXN0VGV4dDogJycsCiAgICAgIGlzT25saW5lOiBmYWxzZQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgLy8g5Zyo57q/6K+t6Z+z5ZCI5oiQCiAgICBjcmVhdGVWb2ljZSh0ZXh0KSB7CiAgICAgIGNvbnNvbGUubG9nKCflnKjnur/or63pn7PlkIjmiJAnLCB0ZXh0KQogICAgICBpZiAodGV4dCAhPT0gZXhwZXJpZW5jZS50ZXh0KSB7CiAgICAgICAgZXhwZXJpZW5jZS5zZXRDb25maWcoewogICAgICAgICAgdGV4dAogICAgICAgIH0pCiAgICAgIH0KICAgICAgY29uc29sZS5sb2coZXhwZXJpZW5jZSkKICAgICAgaWYgKGV4cGVyaWVuY2UucGxheVN0YXRlID09PSAncGxheScpIHsKICAgICAgICBleHBlcmllbmNlLmF1ZGlvUGF1c2UoKQogICAgICAgIHRoaXMucmVzZXRQbGF5KCkKICAgICAgfSBlbHNlIHsKICAgICAgICBleHBlcmllbmNlLmF1ZGlvUGxheSgpCiAgICAgICAgdGhpcy5pc1BsYXlpbmcgPSB0cnVlCiAgICAgICAgdGhpcy5wbGF5U3RhdHVzID0gMQogICAgICB9CiAgICAgIC8vIGNvbnN0IHhtbGh0dHAgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKQogICAgICAvLyAvLyDliJvlu7pIVFRQ6K+35rGC77yM5ZCM5q2l5o6l5pS257uT5p6cCiAgICAgIC8vIHhtbGh0dHAub3BlbignR0VUJywgYCR7cHJvY2Vzcy5lbnYuVlVFX0FQUF9WT0lDRV9VUkx9L3ZvaWNlP3RleHQ9JHt0ZXh0fSZsYW5nPSR7dGhpcy5sYW5nLnRvTG93ZXJDYXNlKCl9YCwgZmFsc2UpCiAgICAgIC8vIC8vIOWPkemAgeivt+axggogICAgICAvLyB4bWxodHRwLnNlbmQoKQogICAgICAvLyAvLyDojrflj5blk43lupTlhoXlrrkKICAgICAgLy8gY29uc3QgeG1sRG9jID0geG1saHR0cC5yZXNwb25zZVRleHQKICAgICAgLy8gaWYgKHhtbERvYykgewogICAgICAvLyAgIC8vIOino+aekOWTjeW6lOWGheWuuQogICAgICAvLyAgIGNvbnN0IGpzb24gPSBKU09OLnBhcnNlKHhtbERvYykKICAgICAgLy8gICBpZiAoanNvbi5wYXRoKSB7CiAgICAgIC8vICAgICAvLyBwYXRo5Li66K+t6Z+z5ZCI5oiQ55Sf5oiQ55qETVAz5paH5Lu25LiL6L296Lev5b6E77yM5bCG6K+l6Lev5b6E6LWL5YC8YXVkaW8uc3JjCiAgICAgIC8vICAgICAvLyBhdWRpb+aOp+S7tuS8muiHquWKqOWKoOi9vemfs+mikeaWh+S7tgogICAgICAvLyAgICAgdGhpcy4kcmVmcy5hdWRpby5zcmMgPSBqc29uLnBhdGgKICAgICAgLy8gICAgIC8vIOiHquWKqOaSreaUvk1QMwogICAgICAvLyAgICAgdGhpcy5jb250aW51ZVBsYXkoKQogICAgICAvLyAgIH0gZWxzZSB7CiAgICAgIC8vICAgICB0aGlzLnNob3dUb2FzdCgn5pKt5pS+5aSx6LSl77yM5pyq55Sf5oiQ6ZO+5o6lJykKICAgICAgLy8gICB9CiAgICAgIC8vIH0gZWxzZSB7CiAgICAgIC8vICAgdGhpcy5zaG93VG9hc3QoJ+aSreaUvuWksei0pScpCiAgICAgIC8vIH0KICAgIH0sCiAgICAvLyDliIfmjaLmkq3mlL7nirbmgIHvvIzlpoLmnpzlpITkuo7mkq3mlL7nirbmgIHliJnmmoLlgZzvvIzlpoLmnpzlpITkuo7mmoLlgZznirbmgIHvvIzliJnmkq3mlL4KICAgIC8vIOazqOaEj+eKtuaAgTDlkoznirbmgIEy5piv5LiN6YCa55qECiAgICAvLyDnirbmgIEwIOihqOekuui/mOacquaSreaUvu+8jOaJgOS7pemcgOimgeWFiOi/m+ihjOivremfs+WQiOaIkAogICAgLy8g54q25oCBMiDooajnpLrlt7Lnu4/lkIjmiJDvvIzmiYDku6Xnm7TmjqXov5vooYzmkq3mlL7ljbPlj68KICAgIHRvZ2dsZVBsYXkoKSB7CiAgICAgIGlmICghdGhpcy5pc1BsYXlpbmcpIHsKICAgICAgICBpZiAodGhpcy5wbGF5U3RhdHVzID09PSAwKSB7CiAgICAgICAgICB0aGlzLnBsYXkoKQogICAgICAgIH0gZWxzZSBpZiAodGhpcy5wbGF5U3RhdHVzID09PSAyKSB7CiAgICAgICAgICB0aGlzLmNvbnRpbnVlUGxheSgpCiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucGF1c2VQbGF5KCkKICAgICAgfQogICAgfSwKICAgIC8vIOeUn+aIkOivremfs+WQiOaIkOeahOaWh+acrOS/oeaBrwogICAgc3BlYWsoaXRlbSwgaW5kZXgpIHsKICAgICAgLy8g6YeN572u5pKt5pS+54q25oCB77yM5YGc5q2i5LiA5YiH5pKt5pS+CiAgICAgIHRoaXMucmVzZXRQbGF5KCkKICAgICAgdGhpcy5wbGF5aW5nSW5kZXggPSBpbmRleAogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgdGhpcy4kcmVmcy5zY3JvbGwucmVmcmVzaCgpCiAgICAgICAgaWYgKHRoaXMuY2hhcHRlcikgewogICAgICAgICAgLy8g6I635Y+W5b2T5YmN54K55Ye755qE56ug6IqC5L+h5oGvCiAgICAgICAgICB0aGlzLnNlY3Rpb24gPSB0aGlzLmJvb2suc3BpbmUuZ2V0KHRoaXMuY2hhcHRlci5ocmVmKQogICAgICAgICAgLy8g5riy5p+T56ug6IqCCiAgICAgICAgICB0aGlzLnJlbmRpdGlvbi5kaXNwbGF5KHRoaXMuc2VjdGlvbi5ocmVmKS50aGVuKHNlY3Rpb24gPT4gewogICAgICAgICAgICAvLyDojrflj5blvZPliY3kvY3nva7lr7nosaEKICAgICAgICAgICAgY29uc3QgY3VycmVudFBhZ2UgPSB0aGlzLnJlbmRpdGlvbi5jdXJyZW50TG9jYXRpb24oKQogICAgICAgICAgICBjb25zdCBjZmliYXNlID0gc2VjdGlvbi5jZmlCYXNlCiAgICAgICAgICAgIGNvbnN0IGNmaXN0YXJ0ID0gY3VycmVudFBhZ2Uuc3RhcnQuY2ZpCiAgICAgICAgICAgICAgLnJlcGxhY2UoLy4qIS8sICcnKQogICAgICAgICAgICAgIC5yZXBsYWNlKC9cKS8sICcnKQogICAgICAgICAgICBjb25zdCBjZmllbmQgPSBjdXJyZW50UGFnZS5lbmQuY2ZpCiAgICAgICAgICAgICAgLnJlcGxhY2UoLy4qIS8sICcnKQogICAgICAgICAgICAgIC5yZXBsYWNlKC9cKS8sICcnKQogICAgICAgICAgICB0aGlzLmN1cnJlbnRTZWN0aW9uSW5kZXggPSBjdXJyZW50UGFnZS5zdGFydC5kaXNwbGF5ZWQucGFnZQogICAgICAgICAgICB0aGlzLmN1cnJlbnRTZWN0aW9uVG90YWwgPSBjdXJyZW50UGFnZS5zdGFydC5kaXNwbGF5ZWQudG90YWwKICAgICAgICAgICAgLy8g5ZCI5oiQY2Zp5L+h5oGvCiAgICAgICAgICAgIGNvbnN0IGNmaSA9IGBlcHViY2ZpKCR7Y2ZpYmFzZX0hLCR7Y2Zpc3RhcnR9LCR7Y2ZpZW5kfSlgCiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGN1cnJlbnRQYWdlLCBjZmksIGNmaWJhc2UsIGNmaXN0YXJ0LCBjZmllbmQpCiAgICAgICAgICAgIC8vIOmAmui/h0Jvb2suZ2V0UmFuZ2UoY2ZpKeaWueazleiOt+WPluaMh+WumueJh+auteeahGNmaeWvueW6lOeahOaWh+acrAogICAgICAgICAgICB0aGlzLmJvb2suZ2V0UmFuZ2UoY2ZpKS50aGVuKHJhbmdlID0+IHsKICAgICAgICAgICAgICAvLyDojrflj5bnq6DoioLniYfmrrXnmoTmlofmnKzkv6Hmga8KICAgICAgICAgICAgICBsZXQgdGV4dCA9IHJhbmdlLnRvTG9jYWxlU3RyaW5nKCkKICAgICAgICAgICAgICAvLyDlr7nmlofmnKzkv6Hmga/ov5vooYzov4fmu6TvvIzljrvpmaTlhbbkuK3nmoTnqbrmoLzvvIjms6jmhI/mmK8y5Liq56m65qC877yMMeS4quepuuagvOaYr+WQiOeQhueahO+8ieOAgeaNouihjOespuetieeJueauiuWtl+espgogICAgICAgICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoL1xzKDIsKS9nLCAnJykKICAgICAgICAgICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKC9cci9nLCAnJykKICAgICAgICAgICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKC9cbi9nLCAnJykKICAgICAgICAgICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKC9cdC9nLCAnJykKICAgICAgICAgICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKC9cZi9nLCAnJykKICAgICAgICAgICAgICAvLyDmm7TmlrDor63pn7PlkIjmiJDnmoTmlofmnKzkv6Hmga8KICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRleHQodGV4dCkKICAgICAgICAgICAgfSkKICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIC8vIOmHjee9ruaSreaUvueKtuaAgQogICAgcmVzZXRQbGF5KCkgewogICAgICBpZiAodGhpcy5wbGF5U3RhdHVzID09PSAxKSB7CiAgICAgICAgdGhpcy5wYXVzZVBsYXkoKQogICAgICB9CiAgICAgIHRoaXMuaXNQbGF5aW5nID0gZmFsc2UKICAgICAgdGhpcy5wbGF5U3RhdHVzID0gMAogICAgfSwKICAgIC8vIOS7juWktOW8gOWni+ivremfs+WQiOaIkOW5tuaSreaUvgogICAgcGxheSgpIHsKICAgICAgdGhpcy5jcmVhdGVWb2ljZSh0aGlzLnBhcmFncmFwaCkKICAgIH0sCiAgICAvLyDnu6fnu63mkq3mlL4KICAgIGNvbnRpbnVlUGxheSgpIHsKICAgICAgdGhpcy4kcmVmcy5hdWRpby5wbGF5KCkudGhlbigoKSA9PiB7CiAgICAgICAgLy8g5pi+56S65pKt5pS+5Yqo55S7CiAgICAgICAgdGhpcy4kcmVmcy5zcGVha1BsYXlpbmdbMF0uc3RhcnRBbmltYXRpb24oKQogICAgICAgIHRoaXMuaXNQbGF5aW5nID0gdHJ1ZQogICAgICAgIHRoaXMucGxheVN0YXR1cyA9IDEKICAgICAgfSkKICAgIH0sCiAgICAvLyDmmoLlgZzmkq3mlL4KICAgIHBhdXNlUGxheSgpIHsKICAgICAgdGhpcy4kcmVmcy5hdWRpby5wYXVzZSgpCiAgICAgIC8vIOaaguWBnOaSreaUvuWKqOeUuwogICAgICB0aGlzLiRyZWZzLnNwZWFrUGxheWluZ1swXS5zdG9wQW5pbWF0aW9uKCkKICAgICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZQogICAgICB0aGlzLnBsYXlTdGF0dXMgPSAyCiAgICB9LAogICAgLy8g5b2T5pKt5pS+57uT5p2f5pe277yM5Yi35paw5pKt5pS+5L+h5oGvCiAgICBvbkF1ZGlvRW5kZWQoKSB7CiAgICAgIHRoaXMucmVzZXRQbGF5KCkKICAgICAgdGhpcy5jdXJyZW50UGxheWluZ1RpbWUgPSB0aGlzLiRyZWZzLmF1ZGlvLmN1cnJlbnRUaW1lCiAgICAgIGNvbnN0IHBlcmNlbnQgPSBNYXRoLmZsb29yKAogICAgICAgICh0aGlzLmN1cnJlbnRQbGF5aW5nVGltZSAvIHRoaXMudG90YWxQbGF5aW5nVGltZSkgKiAxMDAKICAgICAgKQogICAgICB0aGlzLiRyZWZzLnNwZWFrV2luZG93LnJlZnJlc2hQcm9ncmVzcyhwZXJjZW50KQogICAgfSwKICAgIC8vIOW9k+aSreaUvui/m+ihjOaXtu+8jOWIt+aWsOaSreaUvuS/oeaBrwogICAgb25UaW1lVXBkYXRlKCkgewogICAgICB0aGlzLmN1cnJlbnRQbGF5aW5nVGltZSA9IHRoaXMuJHJlZnMuYXVkaW8uY3VycmVudFRpbWUKICAgICAgY29uc3QgcGVyY2VudCA9IE1hdGguZmxvb3IoCiAgICAgICAgKHRoaXMuY3VycmVudFBsYXlpbmdUaW1lIC8gdGhpcy50b3RhbFBsYXlpbmdUaW1lKSAqIDEwMAogICAgICApCiAgICAgIHRoaXMuJHJlZnMuc3BlYWtXaW5kb3cucmVmcmVzaFByb2dyZXNzKHBlcmNlbnQpCiAgICB9LAogICAgLy8g6LCD55SoYXVkaW8uc3Jj5pe277yMYXVkaW/mjqfku7bkvJrosIPnlKhjYW5wbGF55LqL5Lu2CiAgICAvLyDmraTml7bmiJHku6zlj6/ku6Xojrflj5bmgLvmkq3mlL7ml7bplb/lkozlvZPliY3mkq3mlL7ml7bplb8KICAgIG9uQ2FuUGxheSgpIHsKICAgICAgdGhpcy5hdWRpb0NhblBsYXkgPSB0cnVlCiAgICAgIHRoaXMuY3VycmVudFBsYXlpbmdUaW1lID0gdGhpcy4kcmVmcy5hdWRpby5jdXJyZW50VGltZQogICAgICB0aGlzLnRvdGFsUGxheWluZ1RpbWUgPSB0aGlzLiRyZWZzLmF1ZGlvLmR1cmF0aW9uCiAgICB9LAogICAgLy8g6YCa6L+HQVBJ5om+5Yiw5b2T5YmN55S15a2Q5Lmm55qE6K+m5oOF5pWw5o2uCiAgICBmaW5kQm9va0Zyb21MaXN0KGZpbGVOYW1lKSB7CiAgICAgIGZsYXRMaXN0KCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICBjb25zdCBib29rTGlzdCA9IHJlc3BvbnNlLmRhdGEuZGF0YS5maWx0ZXIoCiAgICAgICAgICAgIGl0ZW0gPT4gaXRlbS5maWxlTmFtZSA9PT0gZmlsZU5hbWUKICAgICAgICAgICkKICAgICAgICAgIGlmIChib29rTGlzdCAmJiBib29rTGlzdC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHRoaXMuYm9va0l0ZW0gPSBib29rTGlzdFswXQogICAgICAgICAgICB0aGlzLmluaXQoKQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICAvLyDliJ3lp4vljJblj4LmlbDkv6Hmga8KICAgIGluaXQoKSB7CiAgICAgIGNvbnN0IGZpbGVOYW1lID0gdGhpcy4kcm91dGUucXVlcnkuZmlsZU5hbWUKICAgICAgaWYgKCF0aGlzLmJvb2tJdGVtKSB7CiAgICAgICAgdGhpcy5ib29rSXRlbSA9IGZpbmRCb29rKGZpbGVOYW1lKQogICAgICB9CiAgICAgIGlmICh0aGlzLmJvb2tJdGVtKSB7CiAgICAgICAgLy8g5aaC5p6c55S15a2Q5Lmm5bey57uP57yT5a2Y77yM5YiZ55u05o6l5LuOSW5kZXhlZERC5pWw5o2u5bqT5Lit6I635Y+WCiAgICAgICAgZ2V0TG9jYWxGb3JhZ2UoZmlsZU5hbWUsIChlcnIsIGJsb2IpID0+IHsKICAgICAgICAgIGlmIChlcnIgfHwgIWJsb2IpIHsKICAgICAgICAgICAgLy8g5aaC5p6c6I635Y+W57yT5a2Y5aSx6LSl77yM5YiZ5ou85o6lb3Bm5paH5Lu25p2l6I635Y+W55S15a2Q5LmmCiAgICAgICAgICAgIHRoaXMuaXNPbmxpbmUgPSB0cnVlCiAgICAgICAgICAgIGNvbnN0IG9wZiA9IHRoaXMuJHJvdXRlLnF1ZXJ5Lm9wZgogICAgICAgICAgICBpZiAob3BmKSB7CiAgICAgICAgICAgICAgdGhpcy5wYXJzZUJvb2sob3BmKQogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLmlzT25saW5lID0gZmFsc2UKICAgICAgICAgICAgLy8g6Kej5p6Q55S15a2Q5LmmCiAgICAgICAgICAgIHRoaXMucGFyc2VCb29rKGJsb2IpCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmZpbmRCb29rRnJvbUxpc3QoZmlsZU5hbWUpCiAgICAgIH0KICAgIH0sCiAgICAvLyDop6PmnpDnlLXlrZDkuaYKICAgIHBhcnNlQm9vayhibG9iKSB7CiAgICAgIC8vIOino+aekOeUteWtkOS5pgogICAgICB0aGlzLmJvb2sgPSBuZXcgRXB1YihibG9iKQogICAgICAvLyDojrflj5bnlLXlrZDkuabnmoRtZXRhZGF0YQogICAgICB0aGlzLmJvb2subG9hZGVkLm1ldGFkYXRhLnRoZW4obWV0YWRhdGEgPT4gewogICAgICAgIHRoaXMubWV0YWRhdGEgPSBtZXRhZGF0YQogICAgICB9KQogICAgICAvLyDlpoLmnpzmmK/lnKjnur/ojrflj5bnmoTnlLXlrZDkuabvvIzliJnpgJrov4dCb29rLmNvdmVyVXJsKCnmlrnms5Xojrflj5blsIHpnaLpk77mjqUKICAgICAgaWYgKHRoaXMuaXNPbmxpbmUpIHsKICAgICAgICB0aGlzLmJvb2suY292ZXJVcmwoKS50aGVuKHVybCA9PiB7CiAgICAgICAgICB0aGlzLmNvdmVyID0gdXJsCiAgICAgICAgfSkKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyDlpoLmnpzmmK/mnKzlnLDojrflj5bnmoTnlLXlrZDkuabvvIzpgJrov4dCb29rLmxvYWRlZC5jb3ZlcuaWueazleiOt+WPluWwgemdoumTvuaOpe+8iOWKoOW/q+WwgemdouiOt+WPlumAn+W6pu+8iQogICAgICAgIHRoaXMuYm9vay5sb2FkZWQuY292ZXIudGhlbihjb3ZlciA9PiB7CiAgICAgICAgICB0aGlzLmJvb2suYXJjaGl2ZS5jcmVhdGVVcmwoY292ZXIpLnRoZW4odXJsID0+IHsKICAgICAgICAgICAgdGhpcy5jb3ZlciA9IHVybAogICAgICAgICAgfSkKICAgICAgICB9KQogICAgICB9CiAgICAgIC8vIOiOt+WPlueUteWtkOS5pueahOebruW9leS/oeaBrwogICAgICB0aGlzLmJvb2subG9hZGVkLm5hdmlnYXRpb24udGhlbihuYXYgPT4gewogICAgICAgIHRoaXMubmF2aWdhdGlvbiA9IG5hdgogICAgICB9KQogICAgICAvLyDmuLLmn5PnlLXlrZDkuaYKICAgICAgdGhpcy5kaXNwbGF5KCkKICAgIH0sCiAgICBiYWNrKCkgewogICAgICB0aGlzLiRyb3V0ZXIuZ28oLTEpCiAgICB9LAogICAgLy8g5aSE55CG5rua5Yqo5p2h55qE5LqL5Lu277yM5Yaz5a6a5qCH6aKY6Zi05b2x5piv5ZCm5bGV56S6CiAgICBvblNjcm9sbChvZmZzZXRZKSB7CiAgICAgIGlmIChvZmZzZXRZID4gcmVhbFB4KDQyKSkgewogICAgICAgIHRoaXMuJHJlZnMudGl0bGUuc2hvd1NoYWRvdygpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kcmVmcy50aXRsZS5oaWRlU2hhZG93KCkKICAgICAgfQogICAgfSwKICAgIHRvZ2dsZUNvbnRlbnQoKSB7CiAgICAgIHRoaXMuaWZTaG93Q29udGVudCA9ICF0aGlzLmlmU2hvd0NvbnRlbnQKICAgIH0sCiAgICAvLyDmuLLmn5PnlLXlrZDkuaYKICAgIGRpc3BsYXkoKSB7CiAgICAgIGNvbnN0IGhlaWdodCA9CiAgICAgICAgd2luZG93LmlubmVySGVpZ2h0ICogMC45IC0KICAgICAgICByZWFsUHgoNDApIC0KICAgICAgICByZWFsUHgoNTQpIC0KICAgICAgICByZWFsUHgoNDYpIC0KICAgICAgICByZWFsUHgoNDgpIC0KICAgICAgICByZWFsUHgoNjApIC0KICAgICAgICByZWFsUHgoNDQpCiAgICAgIHRoaXMucmVuZGl0aW9uID0gdGhpcy5ib29rLnJlbmRlclRvKCdyZWFkJywgewogICAgICAgIHdpZHRoOiB3aW5kb3cuaW5uZXJXaWR0aCwKICAgICAgICBoZWlnaHQ6IGhlaWdodCwKICAgICAgICBtZXRob2Q6ICdkZWZhdWx0JwogICAgICB9KQogICAgICB0aGlzLnJlbmRpdGlvbi5kaXNwbGF5KCkKICAgIH0sCiAgICBkb0ZsYXROYXZpZ2F0aW9uKGNvbnRlbnQsIGRlZXAgPSAxKSB7CiAgICAgIGNvbnN0IGFyciA9IFtdCiAgICAgIGNvbnRlbnQuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICBpdGVtLmRlZXAgPSBkZWVwCiAgICAgICAgYXJyLnB1c2goaXRlbSkKICAgICAgICBpZiAoaXRlbS5zdWJpdGVtcyAmJiBpdGVtLnN1Yml0ZW1zLmxlbmd0aCA+IDApIHsKICAgICAgICAgIGFyci5wdXNoKHRoaXMuZG9GbGF0TmF2aWdhdGlvbihpdGVtLnN1Yml0ZW1zLCBkZWVwICsgMSkpCiAgICAgICAgfQogICAgICB9KQogICAgICByZXR1cm4gYXJyCiAgICB9LAogICAgc2hvd1RvYXN0KHRleHQpIHsKICAgICAgdGhpcy5zaW1wbGVUb2FzdCh0ZXh0KQogICAgfSwKICAgIG9uUGxheWluZ0NhcmRDbGljaygpIHsKICAgICAgdGhpcy4kcmVmcy5zcGVha1dpbmRvdy5zaG93KCkKICAgIH0sCiAgICB1cGRhdGVUZXh0KHRleHQpIHsKICAgICAgdGhpcy5wYXJhZ3JhcGggPSB0ZXh0CiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5pbml0KCkKICB9Cn0K"},{"version":3,"sources":["StoreSpeaking.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"StoreSpeaking.vue","sourceRoot":"src/views/store","sourcesContent":["<!-- 听书组件 -->\r\n<template>\r\n  <div class=\"book-speaking\">\r\n    <!-- title -->\r\n    <detail-title @back=\"back\" ref=\"title\"></detail-title>\r\n    <scroll\r\n      class=\"content-wrapper\"\r\n      :top=\"42\"\r\n      :bottom=\"scrollBottom\"\r\n      :ifNoScroll=\"disableScroll\"\r\n      @onScroll=\"onScroll\"\r\n      ref=\"scroll\"\r\n    >\r\n      <!-- 图书详情 -->\r\n      <book-info :cover=\"cover\" :title=\"title\" :author=\"author\" :desc=\"desc\"></book-info>\r\n      <div class=\"book-speak-title-wrapper\">\r\n        <div class=\"icon-speak-wrapper\">\r\n          <span class=\"icon-speak\"></span>\r\n        </div>\r\n        <div class=\"speak-title-wrapper\">\r\n          <span class=\"speak-title\">{{$t('speak.voice')}}</span>\r\n        </div>\r\n        <div class=\"icon-down-wrapper\" @click=\"toggleContent\">\r\n          <span\r\n            :class=\"{'icon-down2': !ifShowContent, 'icon-up': ifShowContent}\"\r\n          ></span>\r\n        </div>\r\n      </div>\r\n      <!-- 图书章节详情 -->\r\n      <div class=\"book-detail-content-wrapper\" v-show=\"ifShowContent\">\r\n        <div class=\"book-detail-content-list-wrapper\">\r\n          <div class=\"loading-text-wrapper\" v-if=\"!this.navigation\">\r\n            <span class=\"loading-text\">{{$t('detail.loading')}}</span>\r\n          </div>\r\n          <div class=\"book-detail-content-item-wrapper\">\r\n            <div\r\n              class=\"book-detail-content-item\"\r\n              v-for=\"(item, index) in flatNavigation\"\r\n              :key=\"index\"\r\n              @click=\"speak(item, index)\"\r\n            >\r\n              <!-- 播放动画 -->\r\n              <speak-playing\r\n                v-if=\"playingIndex === index\"\r\n                :number=\"5\"\r\n                ref=\"speakPlaying\"\r\n              ></speak-playing>\r\n              <div\r\n                class=\"book-detail-content-navigation-text\"\r\n                :class=\"{'is-playing': playingIndex === index}\"\r\n                v-if=\"item.label\"\r\n              >{{item.label}}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <!-- 播放器 -->\r\n      <audio\r\n        @canplay=\"onCanPlay\"\r\n        @timeupdate=\"onTimeUpdate\"\r\n        @ended=\"onAudioEnded\"\r\n        ref=\"audio\"\r\n      ></audio>\r\n    </scroll>\r\n    <!-- 播放面板-->\r\n    <bottom\r\n      :chapter=\"chapter\"\r\n      :currentSectionIndex=\"currentSectionIndex\"\r\n      :currentSectionTotal=\"currentSectionTotal\"\r\n      :showPlay=\"showPlay\"\r\n      :isPlaying.sync=\"isPlaying\"\r\n      :playInfo=\"playInfo\"\r\n      @onPlayingCardClick=\"onPlayingCardClick\"\r\n    ></bottom>\r\n    <!-- 挂载电子书-->\r\n    <div class=\"book-wrapper\">\r\n      <div id=\"read\"></div>\r\n    </div>\r\n    <speak-window\r\n      :title=\"this.chapter ? this.chapter.label : ''\"\r\n      :book=\"book\"\r\n      :section=\"section\"\r\n      :currentSectionIndex.sync=\"currentSectionIndex\"\r\n      :currentSectionTotal=\"currentSectionTotal\"\r\n      :isPlaying.sync=\"isPlaying\"\r\n      :playInfo=\"playInfo\"\r\n      @updateText=\"updateText\"\r\n      ref=\"speakWindow\"\r\n    ></speak-window>\r\n  </div>\r\n</template>\r\n\r\n<script type=\"text/ecmascript-6\">\r\n  import DetailTitle from '../../components/detail/DetailTitle'\r\n  import BookInfo from '../../components/detail/BookInfo'\r\n  import Scroll from '../../components/common/Scroll'\r\n  import SpeakPlaying from '../../components/speak/SpeakPlaying'\r\n  import Bottom from '../../components/speak/SpeakBottom'\r\n  import SpeakWindow from '../../components/speak/SpeakMask'\r\n  import { findBook, getCategoryName } from '../../utils/store'\r\n  import { flatList } from '../../api/store'\r\n  import { getLocalForage } from '../../utils/localForage'\r\n  import { realPx } from '../../utils/utils'\r\n  import Epub from 'epubjs'\r\n\r\n  global.ePub = Epub\r\n\r\n  const APPID = '5b4da68b'\r\n  const API_SECRET = '48487e25de82a2c167eccda30f7a3c70'\r\n  const API_KEY = '7154170219e3e4426025afef812d070e'\r\n  let isChrome = navigator.userAgent.toLowerCase().match(/chrome/)\r\n  let notSupportTip = isChrome\r\n    ? '您的浏览器暂时不支持体验功能，请升级您的浏览器'\r\n    : '您现在使用的浏览器暂时不支持体验功能，<br />推荐使用谷歌浏览器Chrome'\r\n\r\n  function getWebsocketUrl() {\r\n    return new Promise((resolve, reject) => {\r\n      var apiKey = API_KEY\r\n      var apiSecret = API_SECRET\r\n      var url = 'wss://tts-api.xfyun.cn/v2/tts'\r\n      var host = location.host\r\n      var date = new Date().toGMTString()\r\n      var algorithm = 'hmac-sha256'\r\n      var headers = 'host date request-line'\r\n      var signatureOrigin = `host: ${host}\\ndate: ${date}\\nGET /v2/tts HTTP/1.1`\r\n      var signatureSha = CryptoJS.HmacSHA256(signatureOrigin, apiSecret)\r\n      var signature = CryptoJS.enc.Base64.stringify(signatureSha)\r\n      var authorizationOrigin = `api_key=\"${apiKey}\", algorithm=\"${algorithm}\", headers=\"${headers}\", signature=\"${signature}\"`\r\n      var authorization = btoa(authorizationOrigin)\r\n      url = `${url}?authorization=${authorization}&date=${date}&host=${host}`\r\n      resolve(url)\r\n    })\r\n  }\r\n\r\n  let audioCtx\r\n  let source\r\n  let btnState = {\r\n    unTTS: '立即合成',\r\n    ttsing: '正在合成',\r\n    endTTS: '立即播放',\r\n    play: '停止播放',\r\n    pause: '继续播放',\r\n    endPlay: '重新播放',\r\n    errorTTS: '合成失败'\r\n  }\r\n\r\n  class Experience {\r\n    constructor({\r\n      speed = 50,\r\n      voice = 50,\r\n      pitch = 50,\r\n      text = '',\r\n      engineType = 'aisound',\r\n      voiceName = 'xiaoyan',\r\n      playBtn = '.js-base-play',\r\n      defaultText = ''\r\n    } = {}) {\r\n      this.speed = speed\r\n      this.voice = voice\r\n      this.pitch = pitch\r\n      this.text = text\r\n      this.defaultText = defaultText\r\n      this.engineType = engineType\r\n      this.voiceName = voiceName\r\n      this.playBtn = playBtn\r\n      this.playState = ''\r\n      this.audioDatas = []\r\n      this.pcmPlayWork = new Worker('./transform.worker.js')\r\n      this.pcmPlayWork.onmessage = e => {\r\n        this.onmessageWork(e)\r\n      }\r\n    }\r\n\r\n    setConfig({ speed, voice, pitch, text, defaultText, engineType, voiceName }) {\r\n      speed && (this.speed = speed)\r\n      voice && (this.voice = voice)\r\n      pitch && (this.pitch = pitch)\r\n      text && (this.text = text)\r\n      defaultText && (this.defaultText = defaultText)\r\n      engineType && (this.engineType = engineType)\r\n      voiceName && (this.voiceName = voiceName)\r\n      this.resetAudio()\r\n    }\r\n\r\n    onmessageWork(e) {\r\n      switch (e.data.command) {\r\n        case 'newAudioData': {\r\n          this.audioDatas.push(e.data.data)\r\n          if (this.playState === 'ttsing' && this.audioDatas.length === 1) {\r\n            this.playTimeout = setTimeout(() => {\r\n              this.audioPlay()\r\n            }, 1000)\r\n          }\r\n          break\r\n        }\r\n      }\r\n    }\r\n\r\n    setBtnState(state) {\r\n      let oldState = this.playState\r\n      this.playState = state\r\n    }\r\n\r\n    getAudio() {\r\n      this.setBtnState('ttsing')\r\n      getWebsocketUrl().then(url => {\r\n        this.connectWebsocket(url)\r\n      })\r\n    }\r\n\r\n    connectWebsocket(url) {\r\n      if ('WebSocket' in window) {\r\n        this.websocket = new WebSocket(url)\r\n      } else if ('MozWebSocket' in window) {\r\n        this.websocket = new MozWebSocket(url)\r\n      } else {\r\n        alert(notSupportTip)\r\n        return\r\n      }\r\n      let self = this\r\n      this.websocket.onopen = e => {\r\n        var params = {\r\n          common: {\r\n            app_id: APPID // APPID\r\n          },\r\n          business: {\r\n            ent: self.engineType,\r\n            aue: 'raw',\r\n            auf: 'audio/L16;rate=16000',\r\n            vcn: self.voiceName,\r\n            speed: self.speed,\r\n            volume: self.voice * 10,\r\n            pitch: self.pitch,\r\n            //'bgs': 1,\r\n            tte: 'UTF8'\r\n          },\r\n          data: {\r\n            status: 2,\r\n            text: Base64.encode(self.text || self.defaultText || DEFAULT_TEXT)\r\n          }\r\n        }\r\n        this.websocket.send(JSON.stringify(params))\r\n      }\r\n      this.websocket.onmessage = e => {\r\n        let jsonData = JSON.parse(e.data)\r\n        // 合成失败\r\n        if (jsonData.code !== 0) {\r\n          alert(`${jsonData.code}:${jsonData.message}`)\r\n          self.resetAudio()\r\n          this.websocket.close()\r\n          return\r\n        }\r\n        self.pcmPlayWork.postMessage({\r\n          command: 'transData',\r\n          data: jsonData.data.audio\r\n        })\r\n\r\n        if (jsonData.code === 0 && jsonData.data.status === 2) {\r\n          this.websocket.close()\r\n        }\r\n      }\r\n      this.websocket.onerror = e => {\r\n        console.log(e)\r\n        console.log(e.data)\r\n      }\r\n      this.websocket.onclose = e => {\r\n        console.log(e)\r\n      }\r\n    }\r\n\r\n    resetAudio() {\r\n      this.audioPause()\r\n      this.setBtnState('unTTS')\r\n      this.audioDatasIndex = 0\r\n      this.audioDatas = []\r\n      this.websocket && this.websocket.close()\r\n      clearTimeout(this.playTimeout)\r\n    }\r\n\r\n    audioPlay() {\r\n      try {\r\n        if (!audioCtx) {\r\n          audioCtx = new (window.AudioContext || window.webkitAudioContext)()\r\n        }\r\n        if (!audioCtx) {\r\n          alert(notSupportTip)\r\n          return\r\n        }\r\n      } catch (e) {\r\n        alert(notSupportTip)\r\n        return\r\n      }\r\n      this.audioDatasIndex = 0\r\n      if (this.audioDatas.length) {\r\n        this.playSource()\r\n        this.setBtnState('play')\r\n      } else {\r\n        this.getAudio()\r\n      }\r\n    }\r\n\r\n    audioPause(state) {\r\n      if (this.playState === 'play') {\r\n        this.setBtnState(state || 'endPlay')\r\n      }\r\n      clearTimeout(this.playTimeout)\r\n      try {\r\n        source && source.stop()\r\n      } catch (e) {\r\n        console.log(e)\r\n      }\r\n    }\r\n\r\n    playSource() {\r\n      let bufferLength = 0\r\n      let dataLength = this.audioDatas.length\r\n      for (let i = this.audioDatasIndex; i < dataLength; i++) {\r\n        bufferLength += this.audioDatas[i].length\r\n      }\r\n      let audioBuffer = audioCtx.createBuffer(1, bufferLength, 22050)\r\n      let offset = 0\r\n      let nowBuffering = audioBuffer.getChannelData(0)\r\n      for (let i = this.audioDatasIndex; i < dataLength; i++) {\r\n        let audioData = this.audioDatas[i]\r\n        if (audioBuffer.copyToChannel) {\r\n          audioBuffer.copyToChannel(audioData, 0, offset)\r\n        } else {\r\n          for (let j = 0; j < audioData.length; j++) {\r\n            nowBuffering[offset + j] = audioData[j]\r\n          }\r\n        }\r\n        offset += audioData.length\r\n        this.audioDatasIndex++\r\n      }\r\n\r\n      source = audioCtx.createBufferSource()\r\n      source.buffer = audioBuffer\r\n      source.connect(audioCtx.destination)\r\n      source.start()\r\n      source.onended = event => {\r\n        if (this.playState !== 'play') {\r\n          return\r\n        }\r\n        if (this.audioDatasIndex < this.audioDatas.length) {\r\n          this.playSource()\r\n        } else {\r\n          this.audioPause('endPlay')\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  let experience = new Experience({\r\n    speed: 50,\r\n    voice: 50,\r\n    pitch: 50,\r\n    playBtn: `.audio-ctrl-btn`\r\n  })\r\n\r\n  export default {\r\n    components: {\r\n      DetailTitle,\r\n      BookInfo,\r\n      Scroll,\r\n      SpeakPlaying,\r\n      Bottom,\r\n      SpeakWindow\r\n    },\r\n    computed: {\r\n      // 音频当前播放的分钟数\r\n      currentMinute() {\r\n        const m = Math.floor(this.currentPlayingTime / 60)\r\n        return m < 10 ? '0' + m : m\r\n      },\r\n      // 音频当前播放的秒数\r\n      currentSecond() {\r\n        const s = Math.floor(\r\n          this.currentPlayingTime - parseInt(this.currentMinute) * 60\r\n        )\r\n        return s < 10 ? '0' + s : s\r\n      },\r\n      // 音频的总时长\r\n      totalMinute() {\r\n        const m = Math.floor(this.totalPlayingTime / 60)\r\n        return m < 10 ? '0' + m : m\r\n      },\r\n      // 音频的总秒数\r\n      totalSecond() {\r\n        const s = Math.floor(\r\n          this.totalPlayingTime - parseInt(this.totalMinute) * 60\r\n        )\r\n        return s < 10 ? '0' + s : s\r\n      },\r\n      // 音频的剩余分钟数\r\n      leftMinute() {\r\n        const m = Math.floor(\r\n          (this.totalPlayingTime - this.currentPlayingTime) / 60\r\n        )\r\n        return m < 10 ? '0' + m : m\r\n      },\r\n      // 音频的剩余秒数\r\n      leftSecond() {\r\n        const s = Math.floor(\r\n          this.totalPlayingTime -\r\n            this.currentPlayingTime -\r\n            parseInt(this.leftMinute) * 60\r\n        )\r\n        return s < 10 ? '0' + s : s\r\n      },\r\n      // 播放信息对象\r\n      playInfo() {\r\n        if (this.audioCanPlay) {\r\n          return {\r\n            currentMinute: this.currentMinute,\r\n            currentSecond: this.currentSecond,\r\n            totalMinute: this.totalMinute,\r\n            totalSecond: this.totalSecond,\r\n            leftMinute: this.leftMinute,\r\n            leftSecond: this.leftSecond\r\n          }\r\n        } else {\r\n          return null\r\n        }\r\n      },\r\n      // 电子书的语种\r\n      lang() {\r\n        return this.metadata ? this.metadata.language : ''\r\n      },\r\n      // 当播放面板显示时，禁用滚动条（解决事件穿透问题）\r\n      disableScroll() {\r\n        if (this.$refs.speakWindow) {\r\n          return this.$refs.speakWindow.visible\r\n        } else {\r\n          return false\r\n        }\r\n      },\r\n      // 是否底部的播放面板\r\n      showPlay() {\r\n        return this.playingIndex >= 0\r\n      },\r\n      // 滚动条距底部距离，当显示播放面板时为116像素，不显示时为52像素\r\n      scrollBottom() {\r\n        return this.showPlay ? 116 : 52\r\n      },\r\n      // 当前章节信息\r\n      chapter() {\r\n        return this.flatNavigation[this.playingIndex]\r\n      },\r\n      // 电子书摘要信息\r\n      desc() {\r\n        if (this.description) {\r\n          return this.description.substring(0, 100)\r\n        } else {\r\n          return ''\r\n        }\r\n      },\r\n      // 一维数组的目录\r\n      flatNavigation() {\r\n        if (this.navigation) {\r\n          return Array.prototype.concat.apply(\r\n            [],\r\n            Array.prototype.concat.apply(\r\n              [],\r\n              this.doFlatNavigation(this.navigation.toc)\r\n            )\r\n          )\r\n        } else {\r\n          return []\r\n        }\r\n      },\r\n      // 电子书分类\r\n      category() {\r\n        return this.bookItem ? getCategoryName(this.bookItem.category) : ''\r\n      },\r\n      // 电子书书名\r\n      title() {\r\n        return this.metadata ? this.metadata.title : ''\r\n      },\r\n      // 电子书作者\r\n      author() {\r\n        return this.metadata ? this.metadata.creator : ''\r\n      }\r\n    },\r\n    data() {\r\n      return {\r\n        bookItem: null,\r\n        book: null,\r\n        rendition: null,\r\n        metadata: null,\r\n        cover: null,\r\n        navigation: null,\r\n        description: null,\r\n        ifShowContent: true,\r\n        playingIndex: -1,\r\n        paragraph: null,\r\n        currentSectionIndex: null,\r\n        currentSectionTotal: null,\r\n        section: null,\r\n        isPlaying: false,\r\n        audio: null,\r\n        audioCanPlay: false,\r\n        currentPlayingTime: 0,\r\n        totalPlayingTime: 0,\r\n        playStatus: 0, // 0 - 未播放，1 - 播放中，2 - 暂停中\r\n        toastText: '',\r\n        isOnline: false\r\n      }\r\n    },\r\n    methods: {\r\n      // 在线语音合成\r\n      createVoice(text) {\r\n        console.log('在线语音合成', text)\r\n        if (text !== experience.text) {\r\n          experience.setConfig({\r\n            text\r\n          })\r\n        }\r\n        console.log(experience)\r\n        if (experience.playState === 'play') {\r\n          experience.audioPause()\r\n          this.resetPlay()\r\n        } else {\r\n          experience.audioPlay()\r\n          this.isPlaying = true\r\n          this.playStatus = 1\r\n        }\r\n        // const xmlhttp = new XMLHttpRequest()\r\n        // // 创建HTTP请求，同步接收结果\r\n        // xmlhttp.open('GET', `${process.env.VUE_APP_VOICE_URL}/voice?text=${text}&lang=${this.lang.toLowerCase()}`, false)\r\n        // // 发送请求\r\n        // xmlhttp.send()\r\n        // // 获取响应内容\r\n        // const xmlDoc = xmlhttp.responseText\r\n        // if (xmlDoc) {\r\n        //   // 解析响应内容\r\n        //   const json = JSON.parse(xmlDoc)\r\n        //   if (json.path) {\r\n        //     // path为语音合成生成的MP3文件下载路径，将该路径赋值audio.src\r\n        //     // audio控件会自动加载音频文件\r\n        //     this.$refs.audio.src = json.path\r\n        //     // 自动播放MP3\r\n        //     this.continuePlay()\r\n        //   } else {\r\n        //     this.showToast('播放失败，未生成链接')\r\n        //   }\r\n        // } else {\r\n        //   this.showToast('播放失败')\r\n        // }\r\n      },\r\n      // 切换播放状态，如果处于播放状态则暂停，如果处于暂停状态，则播放\r\n      // 注意状态0和状态2是不通的\r\n      // 状态0 表示还未播放，所以需要先进行语音合成\r\n      // 状态2 表示已经合成，所以直接进行播放即可\r\n      togglePlay() {\r\n        if (!this.isPlaying) {\r\n          if (this.playStatus === 0) {\r\n            this.play()\r\n          } else if (this.playStatus === 2) {\r\n            this.continuePlay()\r\n          }\r\n        } else {\r\n          this.pausePlay()\r\n        }\r\n      },\r\n      // 生成语音合成的文本信息\r\n      speak(item, index) {\r\n        // 重置播放状态，停止一切播放\r\n        this.resetPlay()\r\n        this.playingIndex = index\r\n        this.$nextTick(() => {\r\n          this.$refs.scroll.refresh()\r\n          if (this.chapter) {\r\n            // 获取当前点击的章节信息\r\n            this.section = this.book.spine.get(this.chapter.href)\r\n            // 渲染章节\r\n            this.rendition.display(this.section.href).then(section => {\r\n              // 获取当前位置对象\r\n              const currentPage = this.rendition.currentLocation()\r\n              const cfibase = section.cfiBase\r\n              const cfistart = currentPage.start.cfi\r\n                .replace(/.*!/, '')\r\n                .replace(/\\)/, '')\r\n              const cfiend = currentPage.end.cfi\r\n                .replace(/.*!/, '')\r\n                .replace(/\\)/, '')\r\n              this.currentSectionIndex = currentPage.start.displayed.page\r\n              this.currentSectionTotal = currentPage.start.displayed.total\r\n              // 合成cfi信息\r\n              const cfi = `epubcfi(${cfibase}!,${cfistart},${cfiend})`\r\n              // console.log(currentPage, cfi, cfibase, cfistart, cfiend)\r\n              // 通过Book.getRange(cfi)方法获取指定片段的cfi对应的文本\r\n              this.book.getRange(cfi).then(range => {\r\n                // 获取章节片段的文本信息\r\n                let text = range.toLocaleString()\r\n                // 对文本信息进行过滤，去除其中的空格（注意是2个空格，1个空格是合理的）、换行符等特殊字符\r\n                text = text.replace(/\\s(2,)/g, '')\r\n                text = text.replace(/\\r/g, '')\r\n                text = text.replace(/\\n/g, '')\r\n                text = text.replace(/\\t/g, '')\r\n                text = text.replace(/\\f/g, '')\r\n                // 更新语音合成的文本信息\r\n                this.updateText(text)\r\n              })\r\n            })\r\n          }\r\n        })\r\n      },\r\n      // 重置播放状态\r\n      resetPlay() {\r\n        if (this.playStatus === 1) {\r\n          this.pausePlay()\r\n        }\r\n        this.isPlaying = false\r\n        this.playStatus = 0\r\n      },\r\n      // 从头开始语音合成并播放\r\n      play() {\r\n        this.createVoice(this.paragraph)\r\n      },\r\n      // 继续播放\r\n      continuePlay() {\r\n        this.$refs.audio.play().then(() => {\r\n          // 显示播放动画\r\n          this.$refs.speakPlaying[0].startAnimation()\r\n          this.isPlaying = true\r\n          this.playStatus = 1\r\n        })\r\n      },\r\n      // 暂停播放\r\n      pausePlay() {\r\n        this.$refs.audio.pause()\r\n        // 暂停播放动画\r\n        this.$refs.speakPlaying[0].stopAnimation()\r\n        this.isPlaying = false\r\n        this.playStatus = 2\r\n      },\r\n      // 当播放结束时，刷新播放信息\r\n      onAudioEnded() {\r\n        this.resetPlay()\r\n        this.currentPlayingTime = this.$refs.audio.currentTime\r\n        const percent = Math.floor(\r\n          (this.currentPlayingTime / this.totalPlayingTime) * 100\r\n        )\r\n        this.$refs.speakWindow.refreshProgress(percent)\r\n      },\r\n      // 当播放进行时，刷新播放信息\r\n      onTimeUpdate() {\r\n        this.currentPlayingTime = this.$refs.audio.currentTime\r\n        const percent = Math.floor(\r\n          (this.currentPlayingTime / this.totalPlayingTime) * 100\r\n        )\r\n        this.$refs.speakWindow.refreshProgress(percent)\r\n      },\r\n      // 调用audio.src时，audio控件会调用canplay事件\r\n      // 此时我们可以获取总播放时长和当前播放时长\r\n      onCanPlay() {\r\n        this.audioCanPlay = true\r\n        this.currentPlayingTime = this.$refs.audio.currentTime\r\n        this.totalPlayingTime = this.$refs.audio.duration\r\n      },\r\n      // 通过API找到当前电子书的详情数据\r\n      findBookFromList(fileName) {\r\n        flatList().then(response => {\r\n          if (response.status === 200) {\r\n            const bookList = response.data.data.filter(\r\n              item => item.fileName === fileName\r\n            )\r\n            if (bookList && bookList.length > 0) {\r\n              this.bookItem = bookList[0]\r\n              this.init()\r\n            }\r\n          }\r\n        })\r\n      },\r\n      // 初始化参数信息\r\n      init() {\r\n        const fileName = this.$route.query.fileName\r\n        if (!this.bookItem) {\r\n          this.bookItem = findBook(fileName)\r\n        }\r\n        if (this.bookItem) {\r\n          // 如果电子书已经缓存，则直接从IndexedDB数据库中获取\r\n          getLocalForage(fileName, (err, blob) => {\r\n            if (err || !blob) {\r\n              // 如果获取缓存失败，则拼接opf文件来获取电子书\r\n              this.isOnline = true\r\n              const opf = this.$route.query.opf\r\n              if (opf) {\r\n                this.parseBook(opf)\r\n              }\r\n            } else {\r\n              this.isOnline = false\r\n              // 解析电子书\r\n              this.parseBook(blob)\r\n            }\r\n          })\r\n        } else {\r\n          this.findBookFromList(fileName)\r\n        }\r\n      },\r\n      // 解析电子书\r\n      parseBook(blob) {\r\n        // 解析电子书\r\n        this.book = new Epub(blob)\r\n        // 获取电子书的metadata\r\n        this.book.loaded.metadata.then(metadata => {\r\n          this.metadata = metadata\r\n        })\r\n        // 如果是在线获取的电子书，则通过Book.coverUrl()方法获取封面链接\r\n        if (this.isOnline) {\r\n          this.book.coverUrl().then(url => {\r\n            this.cover = url\r\n          })\r\n        } else {\r\n          // 如果是本地获取的电子书，通过Book.loaded.cover方法获取封面链接（加快封面获取速度）\r\n          this.book.loaded.cover.then(cover => {\r\n            this.book.archive.createUrl(cover).then(url => {\r\n              this.cover = url\r\n            })\r\n          })\r\n        }\r\n        // 获取电子书的目录信息\r\n        this.book.loaded.navigation.then(nav => {\r\n          this.navigation = nav\r\n        })\r\n        // 渲染电子书\r\n        this.display()\r\n      },\r\n      back() {\r\n        this.$router.go(-1)\r\n      },\r\n      // 处理滚动条的事件，决定标题阴影是否展示\r\n      onScroll(offsetY) {\r\n        if (offsetY > realPx(42)) {\r\n          this.$refs.title.showShadow()\r\n        } else {\r\n          this.$refs.title.hideShadow()\r\n        }\r\n      },\r\n      toggleContent() {\r\n        this.ifShowContent = !this.ifShowContent\r\n      },\r\n      // 渲染电子书\r\n      display() {\r\n        const height =\r\n          window.innerHeight * 0.9 -\r\n          realPx(40) -\r\n          realPx(54) -\r\n          realPx(46) -\r\n          realPx(48) -\r\n          realPx(60) -\r\n          realPx(44)\r\n        this.rendition = this.book.renderTo('read', {\r\n          width: window.innerWidth,\r\n          height: height,\r\n          method: 'default'\r\n        })\r\n        this.rendition.display()\r\n      },\r\n      doFlatNavigation(content, deep = 1) {\r\n        const arr = []\r\n        content.forEach(item => {\r\n          item.deep = deep\r\n          arr.push(item)\r\n          if (item.subitems && item.subitems.length > 0) {\r\n            arr.push(this.doFlatNavigation(item.subitems, deep + 1))\r\n          }\r\n        })\r\n        return arr\r\n      },\r\n      showToast(text) {\r\n        this.simpleToast(text)\r\n      },\r\n      onPlayingCardClick() {\r\n        this.$refs.speakWindow.show()\r\n      },\r\n      updateText(text) {\r\n        this.paragraph = text\r\n      }\r\n    },\r\n    mounted() {\r\n      this.init()\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" rel=\"stylesheet/scss\" scoped>\r\n  @import '../../assets/styles/global';\r\n\r\n  .book-speaking {\r\n    font-size: px2rem(16);\r\n    width: 100%;\r\n    background: white;\r\n\r\n    .content-wrapper {\r\n      width: 100%;\r\n\r\n      .book-speak-title-wrapper {\r\n        display: flex;\r\n        padding: px2rem(15);\r\n        box-sizing: border-box;\r\n        border-bottom: px2rem(1) solid #eee;\r\n\r\n        .icon-speak-wrapper {\r\n          flex: 0 0 px2rem(40);\r\n          @include left;\r\n\r\n          .icon-speak {\r\n            font-size: px2rem(24);\r\n            color: #999;\r\n          }\r\n        }\r\n\r\n        .speak-title-wrapper {\r\n          flex: 1;\r\n          @include left;\r\n\r\n          .speak-title {\r\n            font-size: px2rem(16);\r\n            font-weight: bold;\r\n            color: #666;\r\n          }\r\n        }\r\n\r\n        .icon-down-wrapper {\r\n          flex: 0 0 px2rem(40);\r\n          @include right;\r\n\r\n          .icon-up {\r\n            font-size: px2rem(12);\r\n            color: #999;\r\n          }\r\n\r\n          .icon-down2 {\r\n            font-size: px2rem(12);\r\n            color: #999;\r\n          }\r\n        }\r\n      }\r\n\r\n      .book-detail-content-wrapper {\r\n        width: 100%;\r\n        border-bottom: px2rem(1) solid #eee;\r\n        box-sizing: border-box;\r\n\r\n        .book-detail-content-list-wrapper {\r\n          padding: px2rem(10) px2rem(15);\r\n\r\n          .loading-text-wrapper {\r\n            width: 100%;\r\n\r\n            .loading-text {\r\n              font-size: px2rem(14);\r\n              color: #999;\r\n            }\r\n          }\r\n\r\n          .book-detail-content-item-wrapper {\r\n            .book-detail-content-item {\r\n              display: flex;\r\n              padding: px2rem(15) 0;\r\n              font-size: px2rem(14);\r\n              line-height: px2rem(16);\r\n              color: #333;\r\n              border-bottom: px2rem(1) solid #eee;\r\n\r\n              &:last-child {\r\n                border-bottom: none;\r\n              }\r\n\r\n              .book-detail-content-navigation-text {\r\n                flex: 1;\r\n                width: 100%;\r\n                @include ellipsis;\r\n\r\n                &.is-playing {\r\n                  color: $color-blue;\r\n                  font-weight: bold;\r\n                  margin-left: px2rem(10);\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    .book-wrapper {\r\n      position: absolute;\r\n      bottom: -100%;\r\n      z-index: 100;\r\n    }\r\n  }\r\n</style>\r\n"]}]}