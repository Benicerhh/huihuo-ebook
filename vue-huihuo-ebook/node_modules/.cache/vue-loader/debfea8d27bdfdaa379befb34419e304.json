{"remainingRequest":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\src\\components\\speak\\SpeakBottom.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\src\\components\\speak\\SpeakBottom.vue","mtime":1588943258444},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHN0b3JlU2hlbGZNaXhpbiB9IGZyb20gIi4uLy4uL3V0aWxzL21peGluIjsKaW1wb3J0IHsgcmVtb3ZlRnJvbUJvb2tTaGVsZiwgYWRkVG9TaGVsZiB9IGZyb20gIi4uLy4uL3V0aWxzL3N0b3JlIjsKaW1wb3J0IHsgZ2V0Qm9va1NoZWxmLCBzYXZlQm9va1NoZWxmIH0gZnJvbSAiLi4vLi4vdXRpbHMvbG9jYWxTdG9yYWdlIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBtaXhpbnM6IFtzdG9yZVNoZWxmTWl4aW5dLAogIHByb3BzOiB7CiAgICBjaGFwdGVyOiBPYmplY3QsCiAgICBjdXJyZW50U2VjdGlvbkluZGV4OiBOdW1iZXIsCiAgICBjdXJyZW50U2VjdGlvblRvdGFsOiBOdW1iZXIsCiAgICBzaG93UGxheTogQm9vbGVhbiwKICAgIGlzUGxheWluZzogQm9vbGVhbiwKICAgIHBsYXlJbmZvOiBPYmplY3QsCiAgICBib29rSXRlbTogT2JqZWN0CiAgfSwKICBjb21wdXRlZDogewogICAgLy8g5Yik5pat5b2T5YmN55qE55S15a2Q5Lmm5piv5ZCm5a2Y5Zyo5LqO5Lmm5p62CiAgICBpbkJvb2tTaGVsZigpIHsKICAgICAgaWYgKHRoaXMuYm9va0l0ZW0gJiYgdGhpcy5zaGVsZkxpc3QpIHsKICAgICAgICAvLyDlrprkuYnkuIDkuKroh6rmiafooYzlh73mlbDvvIzlsIbkuabmnrbovazkuLrkuIDnu7TmlbDnu4Tnu5PmnoTvvIzlubbkuJTlj6rkv53nlZl0eXBl5Li6MeeahOaVsOaNru+8iHR5cGU9MeeahOS4uueUteWtkOS5pu+8iQogICAgICAgIGNvbnN0IGZsYXRTaGVsZiA9IChmdW5jdGlvbiBmbGF0dGVuKGFycikgewogICAgICAgICAgcmV0dXJuIFtdLmNvbmNhdCgKICAgICAgICAgICAgLi4uYXJyLm1hcCh2ID0+ICh2Lml0ZW1MaXN0ID8gW3YsIC4uLmZsYXR0ZW4odi5pdGVtTGlzdCldIDogdikpCiAgICAgICAgICApOwogICAgICAgIH0pKHRoaXMuc2hlbGZMaXN0KS5maWx0ZXIoaXRlbSA9PiBpdGVtLnR5cGUgPT09IDEpOwogICAgICAgIC8vIOafpeaJvuW9k+WJjeeUteWtkOS5puaYr+WQpuWtmOWcqOS6juS5puaetgogICAgICAgIGNvbnN0IGJvb2sgPSBmbGF0U2hlbGYuZmlsdGVyKAogICAgICAgICAgaXRlbSA9PiBpdGVtLmZpbGVOYW1lID09PSB0aGlzLmJvb2tJdGVtLmZpbGVOYW1lCiAgICAgICAgKTsKICAgICAgICByZXR1cm4gYm9vayAmJiBib29rLmxlbmd0aCA+IDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICB0b2dnbGVQbGF5KCkgewogICAgICB0aGlzLiRwYXJlbnQudG9nZ2xlUGxheSgpOwogICAgfSwKICAgIG9uUGxheWluZ0NhcmRDbGljaygpIHsKICAgICAgdGhpcy4kZW1pdCgib25QbGF5aW5nQ2FyZENsaWNrIik7CiAgICB9LAogICAgYWRkT3JSZW1vdmVTaGVsZigpIHsKICAgICAgLy8g5aaC5p6c55S15a2Q5Lmm5a2Y5Zyo5LqO5Lmm5p6277yM5YiZ5LuO5Lmm5p625Lit56e76Zmk55S15a2Q5LmmCiAgICAgIGlmICh0aGlzLmluQm9va1NoZWxmKSB7CiAgICAgICAgdGhpcy5zZXRTaGVsZkxpc3QocmVtb3ZlRnJvbUJvb2tTaGVsZih0aGlzLmJvb2tJdGVtKSkudGhlbigoKSA9PiB7CiAgICAgICAgICAvLyDlsIbkuabmnrbmlbDmja7kv53lrZjliLBMb2NhbFN0b3JhZ2UKICAgICAgICAgIHNhdmVCb29rU2hlbGYodGhpcy5zaGVsZkxpc3QpOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIOWmguaenOeUteWtkOS5puS4jeWtmOWcqOS6juS5puaetu+8jOWImea3u+WKoOeUteWtkOS5puWIsOS5puaetgogICAgICAgIGFkZFRvU2hlbGYodGhpcy5ib29rSXRlbSk7CiAgICAgICAgdGhpcy5zZXRTaGVsZkxpc3QoZ2V0Qm9va1NoZWxmKCkpOwogICAgICB9CiAgICAgIHRoaXMuaXNJbkJvb2tTaGVsZiA9ICF0aGlzLmlzSW5Cb29rU2hlbGY7CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["SpeakBottom.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4CA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SpeakBottom.vue","sourceRoot":"src/components/speak","sourcesContent":["<template>\n  <div class=\"bottom-wrapper\" :class=\"{ 'hide-play': !showPlay }\">\n    <div\n      class=\"bottom-playing-wrapper\"\n      @click.stop.prevent=\"onPlayingCardClick\"\n      v-if=\"showPlay\"\n    >\n      <div class=\"bottom-playing-left\">\n        <div class=\"icon-play-wrapper\" @click.stop.prevent=\"togglePlay\">\n          <span class=\"icon-play_go\" v-if=\"!isPlaying\"></span>\n          <span class=\"icon-play_pause\" v-else></span>\n        </div>\n      </div>\n      <div class=\"bottom-playing-right\">\n        <div class=\"bottom-playing-chapter-text\">\n          <span class=\"chapter-label\">{{ chapter ? chapter.label : \"\" }}</span>\n          <span\n            class=\"bottom-playing-page-text\"\n            v-if=\"currentSectionIndex && currentSectionTotal\"\n            >( {{ currentSectionIndex }} / {{ currentSectionTotal }} )</span\n          >\n        </div>\n        <div class=\"bottom-playing-page-text\">\n          {{ playInfo ? playInfo.currentMinute : \"00\" }}:{{\n            playInfo ? playInfo.currentSecond : \"00\"\n          }}\n          / {{ playInfo ? playInfo.totalMinute : \"00\" }}:{{\n            playInfo ? playInfo.totalSecond : \"00\"\n          }}\n        </div>\n      </div>\n    </div>\n    <div class=\"bottom-btn-wrapper\">\n      <span class=\"icon-check\" v-if=\"inBookShelf\"></span>\n      <span class=\"bottom-btn-text\" @click.stop.prevent=\"addOrRemoveShelf()\">{{\n        inBookShelf\n          ? $t(\"detail.isAddedToShelf\")\n          : $t(\"detail.addOrRemoveShelf\")\n      }}</span>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { storeShelfMixin } from \"../../utils/mixin\";\nimport { removeFromBookShelf, addToShelf } from \"../../utils/store\";\nimport { getBookShelf, saveBookShelf } from \"../../utils/localStorage\";\n\nexport default {\n  mixins: [storeShelfMixin],\n  props: {\n    chapter: Object,\n    currentSectionIndex: Number,\n    currentSectionTotal: Number,\n    showPlay: Boolean,\n    isPlaying: Boolean,\n    playInfo: Object,\n    bookItem: Object\n  },\n  computed: {\n    // 判断当前的电子书是否存在于书架\n    inBookShelf() {\n      if (this.bookItem && this.shelfList) {\n        // 定义一个自执行函数，将书架转为一维数组结构，并且只保留type为1的数据（type=1的为电子书）\n        const flatShelf = (function flatten(arr) {\n          return [].concat(\n            ...arr.map(v => (v.itemList ? [v, ...flatten(v.itemList)] : v))\n          );\n        })(this.shelfList).filter(item => item.type === 1);\n        // 查找当前电子书是否存在于书架\n        const book = flatShelf.filter(\n          item => item.fileName === this.bookItem.fileName\n        );\n        return book && book.length > 0;\n      } else {\n        return false;\n      }\n    }\n  },\n  methods: {\n    togglePlay() {\n      this.$parent.togglePlay();\n    },\n    onPlayingCardClick() {\n      this.$emit(\"onPlayingCardClick\");\n    },\n    addOrRemoveShelf() {\n      // 如果电子书存在于书架，则从书架中移除电子书\n      if (this.inBookShelf) {\n        this.setShelfList(removeFromBookShelf(this.bookItem)).then(() => {\n          // 将书架数据保存到LocalStorage\n          saveBookShelf(this.shelfList);\n        });\n      } else {\n        // 如果电子书不存在于书架，则添加电子书到书架\n        addToShelf(this.bookItem);\n        this.setShelfList(getBookShelf());\n      }\n      this.isInBookShelf = !this.isInBookShelf;\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" rel=\"stylesheet/scss\" scoped>\n@import \"../../assets/styles/global\";\n\n.bottom-wrapper {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  z-index: 110;\n  width: 100%;\n  height: px2rem(116);\n  background: white;\n  box-shadow: 0 px2rem(-2) px2rem(2) 0 rgba(0, 0, 0, 0.1);\n  &.hide-play {\n    height: px2rem(52);\n  }\n  .bottom-playing-wrapper {\n    display: flex;\n    width: 100%;\n    height: px2rem(64);\n    .bottom-playing-left {\n      flex: 0 0 px2rem(70);\n      width: px2rem(70);\n      @include center;\n      .icon-play-wrapper {\n        flex: 0 0 px2rem(100);\n        @include center;\n        &:active {\n          opacity: 0.5;\n        }\n        .icon-play_go {\n          font-size: px2rem(40);\n          color: $color-blue;\n        }\n        .icon-play_pause {\n          font-size: px2rem(40);\n          color: $color-blue;\n        }\n      }\n    }\n    .bottom-playing-right {\n      flex: 1;\n      padding-right: px2rem(15);\n      box-sizing: border-box;\n      @include columnLeft;\n      .bottom-playing-chapter-text {\n        max-width: px2rem(305);\n        color: #333;\n        font-size: px2rem(16);\n        line-height: px2rem(19);\n        @include ellipsis;\n      }\n      .bottom-playing-page-text {\n        color: #666;\n        font-size: px2rem(10);\n        margin-top: px2rem(5);\n      }\n    }\n  }\n  .bottom-btn-wrapper {\n    width: 100%;\n    height: px2rem(52);\n    border-top: px2rem(1) solid #eee;\n    box-sizing: border-box;\n    color: $color-blue;\n    @include center;\n    font-size: px2rem(14);\n    font-weight: bold;\n    .icon-check {\n      margin-right: px2rem(5);\n    }\n  }\n}\n</style>\n"]}]}