{"remainingRequest":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\src\\components\\shelf\\ShelfFooter.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\src\\components\\shelf\\ShelfFooter.vue","mtime":1588675141999},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBzdG9yZVNoZWxmTWl4aW4gfSBmcm9tICIuLi8uLi91dGlscy9taXhpbiI7DQppbXBvcnQgeyBzYXZlQm9va1NoZWxmIH0gZnJvbSAiLi4vLi4vdXRpbHMvbG9jYWxTdG9yYWdlIjsNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbWl4aW5zOiBbc3RvcmVTaGVsZk1peGluXSwNCiAgY29tcHV0ZWQ6IHsNCiAgICBpc1NlbGVjdGVkKCkgew0KICAgICAgcmV0dXJuIHRoaXMuc2hlbGZTZWxlY3RlZCAmJiB0aGlzLnNoZWxmU2VsZWN0ZWQubGVuZ3RoID4gMDsNCiAgICB9LA0KICAgIHRhYnMoKSB7DQogICAgICByZXR1cm4gWw0KICAgICAgICB7DQogICAgICAgICAgbGFiZWw6IHRoaXMuJHQoInNoZWxmLnByaXZhdGUiKSwNCiAgICAgICAgICBsYWJlbDI6IHRoaXMuJHQoInNoZWxmLm5vUHJpdmF0ZSIpLA0KICAgICAgICAgIGluZGV4OiAxDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBsYWJlbDogdGhpcy4kdCgic2hlbGYuZG93bmxvYWQiKSwNCiAgICAgICAgICBsYWJlbDI6IHRoaXMuJHQoInNoZWxmLmRlbGV0ZSIpLA0KICAgICAgICAgIGluZGV4OiAyDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBsYWJlbDogdGhpcy4kdCgic2hlbGYubW92ZSIpLA0KICAgICAgICAgIGluZGV4OiAzDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBsYWJlbDogdGhpcy4kdCgic2hlbGYucmVtb3ZlIiksDQogICAgICAgICAgaW5kZXg6IDQNCiAgICAgICAgfQ0KICAgICAgXTsNCiAgICB9LA0KICAgIGlzUHJpdmF0ZSgpIHsNCiAgICAgIGlmICghdGhpcy5pc1NlbGVjdGVkKSB7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiB0aGlzLnNoZWxmU2VsZWN0ZWQuZXZlcnkoaXRlbSA9PiBpdGVtLnByaXZhdGUpOw0KICAgICAgfQ0KICAgIH0sDQogICAgaXNEb3dubG9hZCgpIHsNCiAgICAgIGlmICghdGhpcy5pc1NlbGVjdGVkKSB7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiB0aGlzLnNoZWxmU2VsZWN0ZWQuZXZlcnkoaXRlbSA9PiBpdGVtLmNhY2hlKTsNCiAgICAgIH0NCiAgICB9DQogIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHBvcHVwTWVudTogbnVsbA0KICAgIH07DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBsYWJlbChpdGVtKSB7DQogICAgICBzd2l0Y2ggKGl0ZW0uaW5kZXgpIHsNCiAgICAgICAgY2FzZSAxOg0KICAgICAgICAgIHJldHVybiB0aGlzLmlzUHJpdmF0ZSA/IGl0ZW0ubGFiZWwyIDogaXRlbS5sYWJlbDsNCiAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAyOg0KICAgICAgICAgIHJldHVybiB0aGlzLmlzRG93bmxvYWQgPyBpdGVtLmxhYmVsMiA6IGl0ZW0ubGFiZWw7DQogICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgcmV0dXJuIGl0ZW0ubGFiZWw7DQogICAgICB9DQogICAgfSwNCiAgICBoaWRlUG9wdXAoKSB7DQogICAgICB0aGlzLnBvcHVwTWVudS5oaWRlKCk7DQogICAgfSwNCiAgICBzZXRQcml2YXRlKCkgew0KICAgICAgbGV0IGlzUHJpdmF0ZTsNCiAgICAgIGlmICh0aGlzLmlzUHJpdmF0ZSkgew0KICAgICAgICBpc1ByaXZhdGUgPSBmYWxzZTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGlzUHJpdmF0ZSA9IHRydWU7DQogICAgICB9DQogICAgICB0aGlzLnNoZWxmU2VsZWN0ZWQuZm9yRWFjaChib29rID0+IHsNCiAgICAgICAgYm9vay5wcml2YXRlID0gaXNQcml2YXRlOw0KICAgICAgfSk7DQogICAgICBpZiAoaXNQcml2YXRlKSB7DQogICAgICAgIHRoaXMuc2ltcGxlVG9hc3QodGhpcy4kdCgic2hlbGYuc2V0UHJpdmF0ZVN1Y2Nlc3MiKSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLnNpbXBsZVRvYXN0KHRoaXMuJHQoInNoZWxmLmNsb3NlUHJpdmF0ZVN1Y2Nlc3MiKSk7DQogICAgICB9DQogICAgICB0aGlzLm9uQ29tcGxldGUoKTsNCiAgICB9LA0KICAgIG9uQ29tcGxldGUoKSB7DQogICAgICB0aGlzLmhpZGVQb3B1cCgpOw0KICAgICAgdGhpcy5zZXRJc0VkaXRNb2RlKGZhbHNlKTsNCiAgICAgIHNhdmVCb29rU2hlbGYodGhpcy5zaGVsZkxpc3QpOw0KICAgIH0sDQogICAgYXN5bmMgZG93bmxvYWRTZWxlY3RlZEJvb2soKSB7DQogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc2hlbGZTZWxlY3RlZC5sZW5ndGg7IGkrKykgew0KICAgICAgICBhd2FpdCB0aGlzLmRvd25sb2FkQm9vayh0aGlzLnNoZWxmU2VsZWN0ZWRbaV0pLnRoZW4oYm9vayA9PiB7DQogICAgICAgICAgYm9vay5jYWNoZSA9IHRydWU7DQogICAgICAgIH0pOw0KICAgICAgfQ0KICAgIH0sDQogICAgZG93bmxvYWRCb29rKGJvb2spIHsNCiAgICAgIGxldCB0ZXh0ID0gIiI7DQogICAgICBjb25zdCB0b2FzdCA9IHRoaXMudG9hc3Qoew0KICAgICAgICB0ZXh0DQogICAgICB9KTsNCiAgICAgIHRvYXN0LmNvbnRpbnVlU2hvdygpOw0KICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsNCiAgICAgICAgZG93bmxvYWQoDQogICAgICAgICAgYm9vaywNCiAgICAgICAgICBib29rID0+IHsNCiAgICAgICAgICAgIHRvYXN0LnJlbW92ZSgpOw0KICAgICAgICAgICAgcmVzb2x2ZShib29rKTsNCiAgICAgICAgICB9LA0KICAgICAgICAgIHJlamVjdCwNCiAgICAgICAgICBwcm9ncmVzc0V2ZW50ID0+IHsNCiAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzID0NCiAgICAgICAgICAgICAgTWF0aC5mbG9vcigocHJvZ3Jlc3NFdmVudC5sb2FkZWQgLyBwcm9ncmVzc0V2ZW50LnRvdGFsKSAqIDEwMCkgKw0KICAgICAgICAgICAgICAiJSI7DQogICAgICAgICAgICB0ZXh0ID0gdGhpcy4kdCgic2hlbGYucHJvZ3Jlc3NEb3dubG9hZCIpLnJlcGxhY2UoDQogICAgICAgICAgICAgICIkMSIsDQogICAgICAgICAgICAgIGAke2Jvb2suZmlsZU5hbWV9LmVwdWIoJHtwcm9ncmVzc30pYA0KICAgICAgICAgICAgKTsNCiAgICAgICAgICAgIHRvYXN0LnVwZGF0ZVRleHQodGV4dCk7DQogICAgICAgICAgfQ0KICAgICAgICApOw0KICAgICAgfSk7DQogICAgfSwNCiAgICByZW1vdmVTZWxlY3RlZEJvb2soKSB7DQogICAgICBQcm9taXNlLmFsbCh0aGlzLnNoZWxmU2VsZWN0ZWQubWFwKGJvb2sgPT4gdGhpcy5yZW1vdmVCb29rKGJvb2spKSkudGhlbigNCiAgICAgICAgYm9va3MgPT4gew0KICAgICAgICAgIGJvb2tzLm1hcChib29rID0+IHsNCiAgICAgICAgICAgIGJvb2suY2FjaGUgPSBmYWxzZTsNCiAgICAgICAgICB9KTsNCiAgICAgICAgICBzYXZlQm9va1NoZWxmKHRoaXMuc2hlbGZMaXN0KTsNCiAgICAgICAgICB0aGlzLnNpbXBsZVRvYXN0KHRoaXMuJHQoInNoZWxmLnJlbW92ZURvd25sb2FkU3VjY2VzcyIpKTsNCiAgICAgICAgfQ0KICAgICAgKTsNCiAgICB9LA0KICAgIHJlbW92ZUJvb2soYm9vaykgew0KICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsNCiAgICAgICAgcmVtb3ZlTG9jYWxTdG9yYWdlKGAke2Jvb2suY2F0ZWdvcnlUZXh0fS8ke2Jvb2suZmlsZU5hbWV9LWluZm9gKTsNCiAgICAgICAgcmVtb3ZlTG9jYWxGb3JhZ2UoYCR7Ym9vay5maWxlTmFtZX1gKTsNCiAgICAgICAgcmVzb2x2ZShib29rKTsNCiAgICAgIH0pOw0KICAgIH0sDQogICAgc2V0RG93bmxvYWQoKSB7DQogICAgICBsZXQgaXNEb3dubG9hZDsNCiAgICAgIGlmICh0aGlzLmlzRG93bmxvYWQpIHsNCiAgICAgICAgaXNEb3dubG9hZCA9IGZhbHNlOw0KICAgICAgICB0aGlzLnJlbW92ZVNlbGVjdGVkQm9vaygpOw0KICAgICAgICB0aGlzLnNpbXBsZVRvYXN0KHRoaXMuJHQoInNoZWxmLnJlbW92ZURvd25sb2FkU3VjY2VzcyIpKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGlzRG93bmxvYWQgPSB0cnVlOw0KICAgICAgICB0aGlzLnNpbXBsZVRvYXN0KHRoaXMuJHQoInNoZWxmLnNldERvd25sb2FkU3VjY2VzcyIpKTsNCiAgICAgICAgdGhpcy5kb3dubG9hZFNlbGVjdGVkQm9vaygpOw0KICAgICAgfQ0KICAgICAgdGhpcy5vbkNvbXBsZXRlKCk7DQogICAgICB0aGlzLnNoZWxmU2VsZWN0ZWQuZm9yRWFjaChib29rID0+IHsNCiAgICAgICAgYm9vay5jYWNoZSA9IGlzRG93bmxvYWQ7DQogICAgICB9KTsNCiAgICB9LA0KICAgIHNob3dQcml2YXRlKCkgew0KICAgICAgdGhpcy5wb3B1cE1lbnUgPSB0aGlzLnBvcHVwKHsNCiAgICAgICAgdGl0bGU6IHRoaXMuaXNQcml2YXRlDQogICAgICAgICAgPyB0aGlzLiR0KCJzaGVsZi5jbG9zZVByaXZhdGVUaXRsZSIpDQogICAgICAgICAgOiB0aGlzLiR0KCJzaGVsZi5zZXRQcml2YXRlVGl0bGUiKSwNCiAgICAgICAgYnRuOiBbDQogICAgICAgICAgew0KICAgICAgICAgICAgdGV4dDogdGhpcy5pc1ByaXZhdGUNCiAgICAgICAgICAgICAgPyB0aGlzLiR0KCJzaGVsZi5jbG9zZSIpDQogICAgICAgICAgICAgIDogdGhpcy4kdCgic2hlbGYub3BlbiIpLA0KICAgICAgICAgICAgY2xpY2s6ICgpID0+IHsNCiAgICAgICAgICAgICAgdGhpcy5zZXRQcml2YXRlKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgfSwNCiAgICAgICAgICB7DQogICAgICAgICAgICB0ZXh0OiB0aGlzLiR0KCJzaGVsZi5jYW5jZWwiKSwNCiAgICAgICAgICAgIGNsaWNrOiAoKSA9PiB7DQogICAgICAgICAgICAgIHRoaXMuaGlkZVBvcHVwKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICBdDQogICAgICB9KS5zaG93KCk7DQogICAgfSwNCiAgICBzaG93RG93bmxvYWQoKSB7DQogICAgICB0aGlzLnBvcHVwTWVudSA9IHRoaXMucG9wdXAoew0KICAgICAgICB0aXRsZTogdGhpcy5pc0Rvd25sb2FkDQogICAgICAgICAgPyB0aGlzLiR0KCJzaGVsZi5yZW1vdmVEb3dubG9hZFRpdGxlIikNCiAgICAgICAgICA6IHRoaXMuJHQoInNoZWxmLnNldERvd25sb2FkVGl0bGUiKSwNCiAgICAgICAgYnRuOiBbDQogICAgICAgICAgew0KICAgICAgICAgICAgdGV4dDogdGhpcy5pc0Rvd25sb2FkDQogICAgICAgICAgICAgID8gdGhpcy4kdCgic2hlbGYuZGVsZXRlIikNCiAgICAgICAgICAgICAgOiB0aGlzLiR0KCJzaGVsZi5vcGVuIiksDQogICAgICAgICAgICBjbGljazogKCkgPT4gew0KICAgICAgICAgICAgICB0aGlzLnNldERvd25sb2FkKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgfSwNCiAgICAgICAgICB7DQogICAgICAgICAgICB0ZXh0OiB0aGlzLiR0KCJzaGVsZi5jYW5jZWwiKSwNCiAgICAgICAgICAgIGNsaWNrOiAoKSA9PiB7DQogICAgICAgICAgICAgIHRoaXMuaGlkZVBvcHVwKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICBdDQogICAgICB9KS5zaG93KCk7DQogICAgfSwNCiAgICBzaG93UmVtb3ZlKCkgew0KICAgICAgbGV0IHRpdGxlOw0KICAgICAgaWYgKHRoaXMuc2hlbGZTZWxlY3RlZC5sZW5ndGggPT09IDEpIHsNCiAgICAgICAgdGl0bGUgPSB0aGlzLiR0KCJzaGVsZi5yZW1vdmVCb29rVGl0bGUiKS5yZXBsYWNlKA0KICAgICAgICAgICIkMSIsDQogICAgICAgICAgYOOAiiR7dGhpcy5zaGVsZlNlbGVjdGVkWzBdLnRpdGxlfeOAi2ANCiAgICAgICAgKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRpdGxlID0gdGhpcy4kdCgic2hlbGYucmVtb3ZlQm9va1RpdGxlIikucmVwbGFjZSgNCiAgICAgICAgICAiJDEiLA0KICAgICAgICAgIHRoaXMuJHQoInNoZWxmLnNlbGVjdGVkQm9va3MiKQ0KICAgICAgICApOw0KICAgICAgfQ0KICAgICAgdGhpcy5wb3B1cE1lbnUgPSB0aGlzLnBvcHVwKHsNCiAgICAgICAgdGl0bGU6IHRpdGxlLA0KICAgICAgICBidG46IFsNCiAgICAgICAgICB7DQogICAgICAgICAgICB0ZXh0OiB0aGlzLiR0KCJzaGVsZi5yZW1vdmVCb29rIiksDQogICAgICAgICAgICB0eXBlOiAiZGFuZ2VyIiwNCiAgICAgICAgICAgIGNsaWNrOiAoKSA9PiB7DQogICAgICAgICAgICAgIHRoaXMucmVtb3ZlU2VsZWN0ZWQoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9LA0KICAgICAgICAgIHsNCiAgICAgICAgICAgIHRleHQ6IHRoaXMuJHQoInNoZWxmLmNhbmNlbCIpLA0KICAgICAgICAgICAgY2xpY2s6ICgpID0+IHsNCiAgICAgICAgICAgICAgdGhpcy5oaWRlUG9wdXAoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgIF0NCiAgICAgIH0pLnNob3coKTsNCiAgICB9LA0KICAgIG9uVGFiQ2xpY2soaXRlbSkgew0KICAgICAgaWYgKCF0aGlzLmlzU2VsZWN0ZWQpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgICAgfQ0KICAgICAgc3dpdGNoIChpdGVtLmluZGV4KSB7DQogICAgICAgIGNhc2UgMToNCiAgICAgICAgICB0aGlzLnNob3dQcml2YXRlKCk7DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgMjoNCiAgICAgICAgICB0aGlzLnNob3dEb3dubG9hZCgpOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlIDM6DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgNDoNCiAgICAgICAgICB0aGlzLnNob3dSZW1vdmUoKTsNCiAgICAgICAgICBicmVhazsNCiAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICBicmVhazsNCiAgICAgIH0NCiAgICB9DQogIH0NCn07DQo="},{"version":3,"sources":["ShelfFooter.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ShelfFooter.vue","sourceRoot":"src/components/shelf","sourcesContent":["<template>\r\n  <div class=\"shelf-footer\" v-show=\"isEditMode\">\r\n    <div\r\n      class=\"shelf-footer-tab-wrapper\"\r\n      v-for=\"item in tabs\"\r\n      :key=\"item.index\"\r\n      @click=\"onTabClick(item)\"\r\n    >\r\n      <div class=\"shelf-footer-tab\" :class=\"{ 'is-selected': isSelected }\">\r\n        <div\r\n          class=\"icon-private tab-icon\"\r\n          v-if=\"item.index === 1 && !isPrivate\"\r\n        ></div>\r\n        <div\r\n          class=\"icon-private-see tab-icon\"\r\n          v-if=\"item.index === 1 && isPrivate\"\r\n        ></div>\r\n        <div\r\n          class=\"icon-download tab-icon\"\r\n          v-if=\"item.index === 2 && !isDownload\"\r\n        ></div>\r\n        <div\r\n          class=\"icon-download-remove tab-icon\"\r\n          v-if=\"item.index === 2 && isDownload\"\r\n        ></div>\r\n        <div class=\"icon-move tab-icon\" v-show=\"item.index === 3\"></div>\r\n        <div class=\"icon-shelf tab-icon danger\" v-show=\"item.index === 4\"></div>\r\n        <div class=\"tab-text\" :class=\"{ danger: item.index === 4 }\">\r\n          {{ label(item) }}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { storeShelfMixin } from \"../../utils/mixin\";\r\nimport { saveBookShelf } from \"../../utils/localStorage\";\r\nexport default {\r\n  mixins: [storeShelfMixin],\r\n  computed: {\r\n    isSelected() {\r\n      return this.shelfSelected && this.shelfSelected.length > 0;\r\n    },\r\n    tabs() {\r\n      return [\r\n        {\r\n          label: this.$t(\"shelf.private\"),\r\n          label2: this.$t(\"shelf.noPrivate\"),\r\n          index: 1\r\n        },\r\n        {\r\n          label: this.$t(\"shelf.download\"),\r\n          label2: this.$t(\"shelf.delete\"),\r\n          index: 2\r\n        },\r\n        {\r\n          label: this.$t(\"shelf.move\"),\r\n          index: 3\r\n        },\r\n        {\r\n          label: this.$t(\"shelf.remove\"),\r\n          index: 4\r\n        }\r\n      ];\r\n    },\r\n    isPrivate() {\r\n      if (!this.isSelected) {\r\n        return false;\r\n      } else {\r\n        return this.shelfSelected.every(item => item.private);\r\n      }\r\n    },\r\n    isDownload() {\r\n      if (!this.isSelected) {\r\n        return false;\r\n      } else {\r\n        return this.shelfSelected.every(item => item.cache);\r\n      }\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      popupMenu: null\r\n    };\r\n  },\r\n  methods: {\r\n    label(item) {\r\n      switch (item.index) {\r\n        case 1:\r\n          return this.isPrivate ? item.label2 : item.label;\r\n          break;\r\n        case 2:\r\n          return this.isDownload ? item.label2 : item.label;\r\n        default:\r\n          return item.label;\r\n      }\r\n    },\r\n    hidePopup() {\r\n      this.popupMenu.hide();\r\n    },\r\n    setPrivate() {\r\n      let isPrivate;\r\n      if (this.isPrivate) {\r\n        isPrivate = false;\r\n      } else {\r\n        isPrivate = true;\r\n      }\r\n      this.shelfSelected.forEach(book => {\r\n        book.private = isPrivate;\r\n      });\r\n      if (isPrivate) {\r\n        this.simpleToast(this.$t(\"shelf.setPrivateSuccess\"));\r\n      } else {\r\n        this.simpleToast(this.$t(\"shelf.closePrivateSuccess\"));\r\n      }\r\n      this.onComplete();\r\n    },\r\n    onComplete() {\r\n      this.hidePopup();\r\n      this.setIsEditMode(false);\r\n      saveBookShelf(this.shelfList);\r\n    },\r\n    async downloadSelectedBook() {\r\n      for (let i = 0; i < this.shelfSelected.length; i++) {\r\n        await this.downloadBook(this.shelfSelected[i]).then(book => {\r\n          book.cache = true;\r\n        });\r\n      }\r\n    },\r\n    downloadBook(book) {\r\n      let text = \"\";\r\n      const toast = this.toast({\r\n        text\r\n      });\r\n      toast.continueShow();\r\n      return new Promise((resolve, reject) => {\r\n        download(\r\n          book,\r\n          book => {\r\n            toast.remove();\r\n            resolve(book);\r\n          },\r\n          reject,\r\n          progressEvent => {\r\n            const progress =\r\n              Math.floor((progressEvent.loaded / progressEvent.total) * 100) +\r\n              \"%\";\r\n            text = this.$t(\"shelf.progressDownload\").replace(\r\n              \"$1\",\r\n              `${book.fileName}.epub(${progress})`\r\n            );\r\n            toast.updateText(text);\r\n          }\r\n        );\r\n      });\r\n    },\r\n    removeSelectedBook() {\r\n      Promise.all(this.shelfSelected.map(book => this.removeBook(book))).then(\r\n        books => {\r\n          books.map(book => {\r\n            book.cache = false;\r\n          });\r\n          saveBookShelf(this.shelfList);\r\n          this.simpleToast(this.$t(\"shelf.removeDownloadSuccess\"));\r\n        }\r\n      );\r\n    },\r\n    removeBook(book) {\r\n      return new Promise((resolve, reject) => {\r\n        removeLocalStorage(`${book.categoryText}/${book.fileName}-info`);\r\n        removeLocalForage(`${book.fileName}`);\r\n        resolve(book);\r\n      });\r\n    },\r\n    setDownload() {\r\n      let isDownload;\r\n      if (this.isDownload) {\r\n        isDownload = false;\r\n        this.removeSelectedBook();\r\n        this.simpleToast(this.$t(\"shelf.removeDownloadSuccess\"));\r\n      } else {\r\n        isDownload = true;\r\n        this.simpleToast(this.$t(\"shelf.setDownloadSuccess\"));\r\n        this.downloadSelectedBook();\r\n      }\r\n      this.onComplete();\r\n      this.shelfSelected.forEach(book => {\r\n        book.cache = isDownload;\r\n      });\r\n    },\r\n    showPrivate() {\r\n      this.popupMenu = this.popup({\r\n        title: this.isPrivate\r\n          ? this.$t(\"shelf.closePrivateTitle\")\r\n          : this.$t(\"shelf.setPrivateTitle\"),\r\n        btn: [\r\n          {\r\n            text: this.isPrivate\r\n              ? this.$t(\"shelf.close\")\r\n              : this.$t(\"shelf.open\"),\r\n            click: () => {\r\n              this.setPrivate();\r\n            }\r\n          },\r\n          {\r\n            text: this.$t(\"shelf.cancel\"),\r\n            click: () => {\r\n              this.hidePopup();\r\n            }\r\n          }\r\n        ]\r\n      }).show();\r\n    },\r\n    showDownload() {\r\n      this.popupMenu = this.popup({\r\n        title: this.isDownload\r\n          ? this.$t(\"shelf.removeDownloadTitle\")\r\n          : this.$t(\"shelf.setDownloadTitle\"),\r\n        btn: [\r\n          {\r\n            text: this.isDownload\r\n              ? this.$t(\"shelf.delete\")\r\n              : this.$t(\"shelf.open\"),\r\n            click: () => {\r\n              this.setDownload();\r\n            }\r\n          },\r\n          {\r\n            text: this.$t(\"shelf.cancel\"),\r\n            click: () => {\r\n              this.hidePopup();\r\n            }\r\n          }\r\n        ]\r\n      }).show();\r\n    },\r\n    showRemove() {\r\n      let title;\r\n      if (this.shelfSelected.length === 1) {\r\n        title = this.$t(\"shelf.removeBookTitle\").replace(\r\n          \"$1\",\r\n          `《${this.shelfSelected[0].title}》`\r\n        );\r\n      } else {\r\n        title = this.$t(\"shelf.removeBookTitle\").replace(\r\n          \"$1\",\r\n          this.$t(\"shelf.selectedBooks\")\r\n        );\r\n      }\r\n      this.popupMenu = this.popup({\r\n        title: title,\r\n        btn: [\r\n          {\r\n            text: this.$t(\"shelf.removeBook\"),\r\n            type: \"danger\",\r\n            click: () => {\r\n              this.removeSelected();\r\n            }\r\n          },\r\n          {\r\n            text: this.$t(\"shelf.cancel\"),\r\n            click: () => {\r\n              this.hidePopup();\r\n            }\r\n          }\r\n        ]\r\n      }).show();\r\n    },\r\n    onTabClick(item) {\r\n      if (!this.isSelected) {\r\n        return;\r\n      }\r\n      switch (item.index) {\r\n        case 1:\r\n          this.showPrivate();\r\n          break;\r\n        case 2:\r\n          this.showDownload();\r\n          break;\r\n        case 3:\r\n          break;\r\n        case 4:\r\n          this.showRemove();\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n@import \"../../assets/styles/global.scss\";\r\n.shelf-footer {\r\n  position: fixed;\r\n  bottom: 0;\r\n  left: 0;\r\n  z-index: 120;\r\n  display: flex;\r\n  width: 100%;\r\n  height: px2rem(48);\r\n  background: white;\r\n  box-shadow: 0 px2rem(-2) px2rem(4) 0 rgba(0, 0, 0, 0.1);\r\n  .shelf-footer-tab-wrapper {\r\n    flex: 1;\r\n    width: 25%;\r\n    height: 100%;\r\n    .shelf-footer-tab {\r\n      width: 100%;\r\n      height: 100%;\r\n      opacity: 0.5;\r\n      @include columnCenter;\r\n      .tab-icon {\r\n        font-size: px2rem(20);\r\n        color: #666;\r\n      }\r\n      .tab-text {\r\n        margin-top: px2rem(5);\r\n        font-size: px2rem(12);\r\n        color: #666;\r\n      }\r\n      &.is-selected {\r\n        opacity: 1;\r\n      }\r\n      .danger {\r\n        color: $color-pink;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}