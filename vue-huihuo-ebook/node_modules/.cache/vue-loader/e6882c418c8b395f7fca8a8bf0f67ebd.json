{"remainingRequest":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\src\\components\\Ebook\\EbookReader.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\src\\components\\Ebook\\EbookReader.vue","mtime":1587897303924},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KDQppbXBvcnQgRXB1YiBmcm9tICJlcHVianMiOw0KaW1wb3J0IHsgZWJvb2tNaXhpbiB9IGZyb20gIi4uLy4uL3V0aWxzL21peGluIjsNCmdsb2JhbC5lUHViID0gRXB1YjsNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbWl4aW5zOiBbZWJvb2tNaXhpbl0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGlmVGl0bGVBbmRNZW51U2hvdzogZmFsc2UsDQogICAgICBkZWZhdWx0VGhlbWU6IDAsDQogICAgICBib29rQXZhaWxhYmxlOiBmYWxzZSwgLy/kuabmmK/lkKblpITkuo7lj6/nlKjnirbmgIENCiAgICAgIHRoZW1lTGlzdDogWw0KICAgICAgICB7DQogICAgICAgICAgbmFtZTogImRlZmF1bHQiLA0KICAgICAgICAgIHN0eWxlOiB7DQogICAgICAgICAgICBib2R5OiB7DQogICAgICAgICAgICAgIGNvbG9yOiAiIzAwMCIsDQogICAgICAgICAgICAgIGJhY2tncm91bmQ6ICIjZmZmIg0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIG5hbWU6ICJleWUiLA0KICAgICAgICAgIHN0eWxlOiB7DQogICAgICAgICAgICBib2R5OiB7DQogICAgICAgICAgICAgIGNvbG9yOiAiIzAwMCIsDQogICAgICAgICAgICAgIGJhY2tncm91bmQ6ICIjY2VlYWJhIg0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIG5hbWU6ICJuaWdodCIsDQogICAgICAgICAgc3R5bGU6IHsNCiAgICAgICAgICAgIGJvZHk6IHsNCiAgICAgICAgICAgICAgY29sb3I6ICIjZmZmIiwNCiAgICAgICAgICAgICAgYmFja2dyb3VuZDogIiMwMDAiDQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgbmFtZTogImdvbGQiLA0KICAgICAgICAgIHN0eWxlOiB7DQogICAgICAgICAgICBib2R5OiB7DQogICAgICAgICAgICAgIGNvbG9yOiAiIzAwMCIsDQogICAgICAgICAgICAgIGJhY2tncm91bmQ6ICJyZ2IoMjQxLDIzNiwyMjYpIg0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgIG5hdmlnYXRpb246IHt9DQogICAgfTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIHByZXZQYWdlKCkgew0KICAgICAgLy/osIPnlKhSZW5kaXRpb27nmoRwcmV25pa55rOV6L+U5Zue5LiK5LiA6aG1DQogICAgICBpZiAodGhpcy5yZW5kaXRpb24pIHsNCiAgICAgICAgdGhpcy5yZW5kaXRpb24ucHJldigpOw0KICAgICAgICB0aGlzLmhpZGVUaXRsZUFuZE1lbnUoKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIG5leHRQYWdlKCkgew0KICAgICAgLy/osIPnlKhSZW5kaXRpb27nmoRuZXh05pa55rOV6L+U5Zue5LiK5LiA6aG1DQogICAgICBpZiAodGhpcy5yZW5kaXRpb24pIHsNCiAgICAgICAgdGhpcy5yZW5kaXRpb24ubmV4dCgpOw0KICAgICAgICB0aGlzLmhpZGVUaXRsZUFuZE1lbnUoKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIHRvZ2dsZVRpdGxlQW5kTWVudSgpIHsNCiAgICAgIHRoaXMuc2V0TWVudVZpc2libGUoIXRoaXMubWVudVZpc2libGUpOw0KICAgIH0sDQogICAgaGlkZVRpdGxlQW5kTWVudSgpIHsNCiAgICAgIHRoaXMuc2V0TWVudVZpc2libGUoZmFsc2UpOw0KICAgIH0sDQogICAgaW5pdEVwdWIoKSB7DQogICAgICBjb25zdCB1cmwgPSAiaHR0cDovL2xvY2FsaG9zdDo4MDgxL2VwdWIvIiArIHRoaXMuZmlsZW5hbWUgKyAiLmVwdWIiOw0KICAgICAgLy/nlLXlrZDkuabnmoTop6PmnpDlkozmuLLmn5MNCiAgICAgIC8v55Sf5oiQRWJvb2vlr7nosaENCiAgICAgIHRoaXMuYm9vayA9IG5ldyBFcHViKHVybCk7DQogICAgICAvL+eUn+aIkFJlbmRpdGlvbuWvueixoQ0KICAgICAgdGhpcy5yZW5kaXRpb24gPSB0aGlzLmJvb2sucmVuZGVyVG8oInJlYWQiLCB7DQogICAgICAgIHdpZHRoOiB3aW5kb3cuaW5uZXJXaWR0aCwNCiAgICAgICAgaGVpZ2h0OiB3aW5kb3cuaW5uZXJIZWlnaHQsDQogICAgICAgIG1ldGhvZDogImRlZmF1bHQiDQogICAgICB9KTsNCiAgICAgIC8v6YCa6L+HUmVuZGl0aW9u5a+56LGh55qEZGlzcGxheeaWueazlea4suafk+eUteWtkOS5pg0KICAgICAgdGhpcy5yZW5kaXRpb24uZGlzcGxheSgpOw0KICAgICAgLy/pgJrov4dvbuaWueazlee7keWumuS6i+S7tg0KICAgICAgdGhpcy5yZW5kaXRpb24ub24oInRvdWNoc3RhcnQiLCBldmVudCA9PiB7DQogICAgICAgIHRoaXMudG91Y2hTdGFydFggPSBldmVudC5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRYOw0KICAgICAgICB0aGlzLnRvdWNoU3RhcnRUaW1lID0gZXZlbnQudGltZVN0YW1wOw0KICAgICAgfSk7DQogICAgICB0aGlzLnJlbmRpdGlvbi5vbigidG91Y2hlbmQiLCBldmVudCA9PiB7DQogICAgICAgIGNvbnN0IG9mZnNldFggPSBldmVudC5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRYIC0gdGhpcy50b3VjaFN0YXJ0WDsNCiAgICAgICAgY29uc3QgdGltZSA9IGV2ZW50LnRpbWVTdGFtcCAtIHRoaXMudG91Y2hTdGFydFRpbWU7DQogICAgICAgIC8v5qC55o2u5omL5Yq/5LqL5Lu25a6e546w57+76aG15Yqf6IO9DQogICAgICAgIGlmICh0aW1lIDwgNTAwICYmIG9mZnNldFggPiA0MCkgew0KICAgICAgICAgIHRoaXMucHJldlBhZ2UoKTsNCiAgICAgICAgfSBlbHNlIGlmICh0aW1lIDwgNTAwICYmIG9mZnNldFggPCAtNDApIHsNCiAgICAgICAgICB0aGlzLm5leHRQYWdlKCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdGhpcy50b2dnbGVUaXRsZUFuZE1lbnUoKTsNCiAgICAgICAgfQ0KICAgICAgICAvL+e7hOe7h+m7mOiupOS6i+S7tuWSjOWGkuazoQ0KICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgIH0pOw0KICAgIH0NCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICBjb25zdCBmaWxlbmFtZSA9IHRoaXMuJHJvdXRlLnBhcmFtcy5maWxlbmFtZS5zcGxpdCgifCIpLmpvaW4oIi8iKTsNCiAgICAvL+iOt+WPlumdmeaAgei1hOa6kOeahOi3r+W+hA0KICAgIHRoaXMuc2V0RmlsZW5hbWUoZmlsZW5hbWUpLnRoZW4oKCkgPT4gew0KICAgICAgdGhpcy5pbml0RXB1YigpOw0KICAgIH0pOw0KICB9DQp9Ow0K"},{"version":3,"sources":["EbookReader.vue"],"names":[],"mappings":";;;;;;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EbookReader.vue","sourceRoot":"src/components/Ebook","sourcesContent":["<template>\r\n  <div class=\"ebook-reader\">\r\n    <div id=\"read\" @click=\"toggleTitleAndMenu\"></div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport Epub from \"epubjs\";\r\nimport { ebookMixin } from \"../../utils/mixin\";\r\nglobal.ePub = Epub;\r\nexport default {\r\n  mixins: [ebookMixin],\r\n  data() {\r\n    return {\r\n      ifTitleAndMenuShow: false,\r\n      defaultTheme: 0,\r\n      bookAvailable: false, //书是否处于可用状态\r\n      themeList: [\r\n        {\r\n          name: \"default\",\r\n          style: {\r\n            body: {\r\n              color: \"#000\",\r\n              background: \"#fff\"\r\n            }\r\n          }\r\n        },\r\n        {\r\n          name: \"eye\",\r\n          style: {\r\n            body: {\r\n              color: \"#000\",\r\n              background: \"#ceeaba\"\r\n            }\r\n          }\r\n        },\r\n        {\r\n          name: \"night\",\r\n          style: {\r\n            body: {\r\n              color: \"#fff\",\r\n              background: \"#000\"\r\n            }\r\n          }\r\n        },\r\n        {\r\n          name: \"gold\",\r\n          style: {\r\n            body: {\r\n              color: \"#000\",\r\n              background: \"rgb(241,236,226)\"\r\n            }\r\n          }\r\n        }\r\n      ],\r\n      navigation: {}\r\n    };\r\n  },\r\n  methods: {\r\n    prevPage() {\r\n      //调用Rendition的prev方法返回上一页\r\n      if (this.rendition) {\r\n        this.rendition.prev();\r\n        this.hideTitleAndMenu();\r\n      }\r\n    },\r\n    nextPage() {\r\n      //调用Rendition的next方法返回上一页\r\n      if (this.rendition) {\r\n        this.rendition.next();\r\n        this.hideTitleAndMenu();\r\n      }\r\n    },\r\n    toggleTitleAndMenu() {\r\n      this.setMenuVisible(!this.menuVisible);\r\n    },\r\n    hideTitleAndMenu() {\r\n      this.setMenuVisible(false);\r\n    },\r\n    initEpub() {\r\n      const url = \"http://localhost:8081/epub/\" + this.filename + \".epub\";\r\n      //电子书的解析和渲染\r\n      //生成Ebook对象\r\n      this.book = new Epub(url);\r\n      //生成Rendition对象\r\n      this.rendition = this.book.renderTo(\"read\", {\r\n        width: window.innerWidth,\r\n        height: window.innerHeight,\r\n        method: \"default\"\r\n      });\r\n      //通过Rendition对象的display方法渲染电子书\r\n      this.rendition.display();\r\n      //通过on方法绑定事件\r\n      this.rendition.on(\"touchstart\", event => {\r\n        this.touchStartX = event.changedTouches[0].clientX;\r\n        this.touchStartTime = event.timeStamp;\r\n      });\r\n      this.rendition.on(\"touchend\", event => {\r\n        const offsetX = event.changedTouches[0].clientX - this.touchStartX;\r\n        const time = event.timeStamp - this.touchStartTime;\r\n        //根据手势事件实现翻页功能\r\n        if (time < 500 && offsetX > 40) {\r\n          this.prevPage();\r\n        } else if (time < 500 && offsetX < -40) {\r\n          this.nextPage();\r\n        } else {\r\n          this.toggleTitleAndMenu();\r\n        }\r\n        //组织默认事件和冒泡\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n      });\r\n    }\r\n  },\r\n  mounted() {\r\n    const filename = this.$route.params.filename.split(\"|\").join(\"/\");\r\n    //获取静态资源的路径\r\n    this.setFilename(filename).then(() => {\r\n      this.initEpub();\r\n    });\r\n  }\r\n};\r\n</script>\r\n"]}]}