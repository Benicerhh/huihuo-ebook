{"remainingRequest":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\src\\components\\shelf\\ShelfGroupDialog.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\src\\components\\shelf\\ShelfGroupDialog.vue","mtime":1588736485906},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\JodPreparation\\Practice\\项目\\huihuo-ebook\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBFYm9va0RpYWxvZyBmcm9tICcuLi9jb21tb24vRGlhbG9nJwppbXBvcnQgeyBzdG9yZVNoZWxmTWl4aW4gfSBmcm9tICcuLi8uLi91dGlscy9taXhpbicKaW1wb3J0IHsgcmVtb3ZlQWRkRnJvbVNoZWxmLCBhcHBlbmRBZGRUb1NoZWxmIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3RvcmUnCmltcG9ydCB7IHNhdmVCb29rU2hlbGYgfSBmcm9tICcuLi8uLi91dGlscy9sb2NhbFN0b3JhZ2UnCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ2dyb3VwLWRpYWxvZycsCiAgbWl4aW5zOiBbc3RvcmVTaGVsZk1peGluXSwKICBjb21wb25lbnRzOiB7CiAgICBFYm9va0RpYWxvZwogIH0sCiAgcHJvcHM6IHsKICAgIHNob3dOZXdHcm91cDogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfSwKICAgIGdyb3VwTmFtZTogU3RyaW5nCiAgfSwKICBjb21wdXRlZDogewogICAgaXNJbkdyb3VwKCkgewogICAgICByZXR1cm4gdGhpcy5jdXJyZW50VHlwZSA9PT0gMgogICAgfSwKICAgIGRlZmF1bHRDYXRlZ29yeSgpIHsKICAgICAgcmV0dXJuIFsKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogdGhpcy4kdCgnc2hlbGYubmV3R3JvdXAnKSwKICAgICAgICAgIGVkaXQ6IDEKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiB0aGlzLiR0KCdzaGVsZi5ncm91cE91dCcpLAogICAgICAgICAgZWRpdDogMgogICAgICAgIH0KICAgICAgXQogICAgfSwKICAgIGNhdGVnb3J5KCkgewogICAgICByZXR1cm4gdGhpcy5zaGVsZkxpc3QuZmlsdGVyKGl0ZW0gPT4gaXRlbS50eXBlID09PSAyKQogICAgfSwKICAgIGNhdGVnb3J5TGlzdCgpIHsKICAgICAgcmV0dXJuIFsuLi50aGlzLmRlZmF1bHRDYXRlZ29yeSwgLi4udGhpcy5jYXRlZ29yeV0KICAgIH0sCiAgICB0aXRsZSgpIHsKICAgICAgcmV0dXJuICF0aGlzLmlmTmV3R3JvdXAKICAgICAgICA/IHRoaXMuJHQoJ3NoZWxmLm1vdmVCb29rJykKICAgICAgICA6IHRoaXMuJHQoJ3NoZWxmLm5ld0dyb3VwJykKICAgIH0KICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBpZk5ld0dyb3VwOiBmYWxzZSwKICAgICAgbmV3R3JvdXBOYW1lOiAnJwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgc2hvdygpIHsKICAgICAgdGhpcy5pZk5ld0dyb3VwID0gdGhpcy5zaG93TmV3R3JvdXAKICAgICAgdGhpcy5uZXdHcm91cE5hbWUgPSB0aGlzLmdyb3VwTmFtZQogICAgICB0aGlzLiRyZWZzLmRpYWxvZy5zaG93KCkKICAgIH0sCiAgICBoaWRlKCkgewogICAgICB0aGlzLiRyZWZzLmRpYWxvZy5oaWRlKCkKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgdGhpcy5pZk5ld0dyb3VwID0gZmFsc2UKICAgICAgfSwgMjAwKQogICAgfSwKICAgIG9uR3JvdXBDbGljayhpdGVtKSB7CiAgICAgIGlmIChpdGVtLmVkaXQgJiYgaXRlbS5lZGl0ID09PSAxKSB7CiAgICAgICAgLy/mlrDlu7rliIbnu4QKICAgICAgICB0aGlzLmlmTmV3R3JvdXAgPSB0cnVlCiAgICAgIH0gZWxzZSBpZiAoaXRlbS5lZGl0ICYmIGl0ZW0uZWRpdCA9PT0gMikgewogICAgICAgIC8v56e76Zmk5YiG57uECiAgICAgICAgdGhpcy5tb3ZlT3V0RnJvbUdyb3VwKGl0ZW0pCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5tb3ZlVG9Hcm91cChpdGVtKQogICAgICB9CiAgICB9LAogICAgY2xlYXIoKSB7CiAgICAgIHRoaXMubmV3R3JvdXBOYW1lID0gJycKICAgIH0sCiAgICBtb3ZlVG9Hcm91cChncm91cCkgewogICAgICB0aGlzLnNldFNoZWxmTGlzdCgKICAgICAgICB0aGlzLnNoZWxmTGlzdC5maWx0ZXIoYm9vayA9PiB7CiAgICAgICAgICBpZiAoYm9vay5pdGVtTGlzdCkgewogICAgICAgICAgICBib29rLml0ZW1MaXN0ID0gYm9vay5pdGVtTGlzdC5maWx0ZXIoCiAgICAgICAgICAgICAgc3ViQm9vayA9PiB0aGlzLnNoZWxmU2VsZWN0ZWQuaW5kZXhPZihzdWJCb29rKSA8IDAKICAgICAgICAgICAgKQogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIHRoaXMuc2hlbGZTZWxlY3RlZC5pbmRleE9mKGJvb2spIDwgMAogICAgICAgIH0pCiAgICAgICkudGhlbigoKSA9PiB7CiAgICAgICAgaWYgKGdyb3VwICYmIGdyb3VwLml0ZW1MaXN0KSB7CiAgICAgICAgICBncm91cC5pdGVtTGlzdCA9IFsuLi5ncm91cC5pdGVtTGlzdCwgLi4udGhpcy5zaGVsZlNlbGVjdGVkXQogICAgICAgIH0KICAgICAgICBncm91cC5pdGVtTGlzdC5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4gewogICAgICAgICAgaXRlbS5pZCA9IGluZGV4ICsgMQogICAgICAgIH0pCiAgICAgICAgdGhpcy5zaW1wbGVUb2FzdCgKICAgICAgICAgIHRoaXMuJHQoJ3NoZWxmLm1vdmVCb29rSW5TdWNjZXNzJykucmVwbGFjZSgnJDEnLCBncm91cC50aXRsZSkKICAgICAgICApCiAgICAgICAgdGhpcy5vbkNvbXBsZXRlKCkKICAgICAgfSkKICAgIH0sCiAgICBtb3ZlT3V0RnJvbUdyb3VwKCkgewogICAgICB0aGlzLm1vdmVPdXRPZkdyb3VwKHRoaXMub25Db21wbGV0ZSkKICAgIH0sCiAgICBjcmVhdGVOZXdHcm91cCgpIHsKICAgICAgaWYgKCF0aGlzLm5ld0dyb3VwTmFtZSB8fCB0aGlzLm5ld0dyb3VwTmFtZS5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm4KICAgICAgfQogICAgICBpZiAodGhpcy5zaG93TmV3R3JvdXApIHsKICAgICAgICB0aGlzLnNoZWxmQ2F0ZWdvcnkudGl0bGUgPSB0aGlzLm5ld0dyb3VwTmFtZQogICAgICAgIHRoaXMub25Db21wbGV0ZSgpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgZ3JvdXAgPSB7CiAgICAgICAgICBpZDogdGhpcy5zaGVsZkxpc3RbdGhpcy5zaGVsZkxpc3QubGVuZ3RoIC0gMl0uaWQgKyAxLAogICAgICAgICAgaXRlbUxpc3Q6IFtdLAogICAgICAgICAgc2VsZWN0ZWQ6IGZhbHNlLAogICAgICAgICAgdGl0bGU6IHRoaXMubmV3R3JvdXBOYW1lLAogICAgICAgICAgdHlwZTogMgogICAgICAgIH0KICAgICAgICBsZXQgbGlzdCA9IHJlbW92ZUFkZEZyb21TaGVsZih0aGlzLnNoZWxmTGlzdCkKICAgICAgICBsaXN0LnB1c2goZ3JvdXApCiAgICAgICAgbGlzdCA9IGFwcGVuZEFkZFRvU2hlbGYobGlzdCkKICAgICAgICB0aGlzLnNldFNoZWxmTGlzdChsaXN0KS50aGVuKCgpID0+IHsKICAgICAgICAgIHRoaXMubW92ZVRvR3JvdXAoZ3JvdXApCiAgICAgICAgfSkKICAgICAgfQogICAgfSwKICAgIG9uQ29tcGxldGUoKSB7CiAgICAgIHNhdmVCb29rU2hlbGYodGhpcy5zaGVsZkxpc3QpCiAgICAgIHRoaXMuaGlkZSgpCiAgICAgIHRoaXMuc2V0SXNFZGl0TW9kZShmYWxzZSkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["ShelfGroupDialog.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwDA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ShelfGroupDialog.vue","sourceRoot":"src/components/shelf","sourcesContent":["<template>\r\n  <ebook-dialog :title=\"title\" ref=\"dialog\">\r\n    <!--插槽/slot-->\r\n    <div class=\"dialog-list-wrapper\" v-if=\"!ifNewGroup\">\r\n      <div\r\n        class=\"dialog-list-item\"\r\n        :class=\"{'is-add': item.edit  ? item.edit === 1 : false}\"\r\n        v-for=\"(item, index) in categoryList\"\r\n        :key=\"index\"\r\n        @click=\"onGroupClick(item)\"\r\n        v-show=\"(item.edit === 2 && isInGroup) || item.edit !== 2 || !item.edit\"\r\n      >\r\n        <div class=\"dialog-list-item-text\">{{item.title}}</div>\r\n        <div\r\n          class=\"dialog-list-icon-wrapper\"\r\n          v-if=\"isInGroup && shelfCategory.id === item.id\"\r\n        >\r\n          <span class=\"icon-check\"></span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"dialog-new-group-wrapper\" v-else>\r\n      <div class=\"dialog-input-title-wrapper\">\r\n        <span class=\"dialog-input-title\">{{$t('shelf.groupName')}}</span>\r\n      </div>\r\n      <div class=\"dialog-input-wrapper\">\r\n        <div class=\"dialog-input-inner-wrapper\">\r\n          <input\r\n            type=\"text\"\r\n            class=\"dialog-input\"\r\n            v-model=\"newGroupName\"\r\n            ref=\"dialogInput\"\r\n          />\r\n          <div\r\n            class=\"dialog-input-clear-wrapper\"\r\n            @click=\"clear\"\r\n            v-show=\"newGroupName && newGroupName.length > 0\"\r\n          >\r\n            <span class=\"icon-close-circle-fill\"></span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div slot=\"btn\" class=\"group-dialog-btn-wrapper\">\r\n      <div class=\"dialog-btn\" @click=\"hide\">{{$t('shelf.cancel')}}</div>\r\n      <div\r\n        class=\"dialog-btn\"\r\n        @click=\"createNewGroup\"\r\n        :class=\"{'is-empty': newGroupName && newGroupName.length === 0}\"\r\n        v-if=\"ifNewGroup\"\r\n      >{{$t('shelf.confirm')}}</div>\r\n    </div>\r\n  </ebook-dialog>\r\n</template>\r\n\r\n<script>\r\n  import EbookDialog from '../common/Dialog'\r\n  import { storeShelfMixin } from '../../utils/mixin'\r\n  import { removeAddFromShelf, appendAddToShelf } from '../../utils/store'\r\n  import { saveBookShelf } from '../../utils/localStorage'\r\n\r\n  export default {\r\n    name: 'group-dialog',\r\n    mixins: [storeShelfMixin],\r\n    components: {\r\n      EbookDialog\r\n    },\r\n    props: {\r\n      showNewGroup: {\r\n        type: Boolean,\r\n        default: false\r\n      },\r\n      groupName: String\r\n    },\r\n    computed: {\r\n      isInGroup() {\r\n        return this.currentType === 2\r\n      },\r\n      defaultCategory() {\r\n        return [\r\n          {\r\n            title: this.$t('shelf.newGroup'),\r\n            edit: 1\r\n          },\r\n          {\r\n            title: this.$t('shelf.groupOut'),\r\n            edit: 2\r\n          }\r\n        ]\r\n      },\r\n      category() {\r\n        return this.shelfList.filter(item => item.type === 2)\r\n      },\r\n      categoryList() {\r\n        return [...this.defaultCategory, ...this.category]\r\n      },\r\n      title() {\r\n        return !this.ifNewGroup\r\n          ? this.$t('shelf.moveBook')\r\n          : this.$t('shelf.newGroup')\r\n      }\r\n    },\r\n    data() {\r\n      return {\r\n        ifNewGroup: false,\r\n        newGroupName: ''\r\n      }\r\n    },\r\n    methods: {\r\n      show() {\r\n        this.ifNewGroup = this.showNewGroup\r\n        this.newGroupName = this.groupName\r\n        this.$refs.dialog.show()\r\n      },\r\n      hide() {\r\n        this.$refs.dialog.hide()\r\n        setTimeout(() => {\r\n          this.ifNewGroup = false\r\n        }, 200)\r\n      },\r\n      onGroupClick(item) {\r\n        if (item.edit && item.edit === 1) {\r\n          //新建分组\r\n          this.ifNewGroup = true\r\n        } else if (item.edit && item.edit === 2) {\r\n          //移除分组\r\n          this.moveOutFromGroup(item)\r\n        } else {\r\n          this.moveToGroup(item)\r\n        }\r\n      },\r\n      clear() {\r\n        this.newGroupName = ''\r\n      },\r\n      moveToGroup(group) {\r\n        this.setShelfList(\r\n          this.shelfList.filter(book => {\r\n            if (book.itemList) {\r\n              book.itemList = book.itemList.filter(\r\n                subBook => this.shelfSelected.indexOf(subBook) < 0\r\n              )\r\n            }\r\n            return this.shelfSelected.indexOf(book) < 0\r\n          })\r\n        ).then(() => {\r\n          if (group && group.itemList) {\r\n            group.itemList = [...group.itemList, ...this.shelfSelected]\r\n          }\r\n          group.itemList.forEach((item, index) => {\r\n            item.id = index + 1\r\n          })\r\n          this.simpleToast(\r\n            this.$t('shelf.moveBookInSuccess').replace('$1', group.title)\r\n          )\r\n          this.onComplete()\r\n        })\r\n      },\r\n      moveOutFromGroup() {\r\n        this.moveOutOfGroup(this.onComplete)\r\n      },\r\n      createNewGroup() {\r\n        if (!this.newGroupName || this.newGroupName.length === 0) {\r\n          return\r\n        }\r\n        if (this.showNewGroup) {\r\n          this.shelfCategory.title = this.newGroupName\r\n          this.onComplete()\r\n        } else {\r\n          const group = {\r\n            id: this.shelfList[this.shelfList.length - 2].id + 1,\r\n            itemList: [],\r\n            selected: false,\r\n            title: this.newGroupName,\r\n            type: 2\r\n          }\r\n          let list = removeAddFromShelf(this.shelfList)\r\n          list.push(group)\r\n          list = appendAddToShelf(list)\r\n          this.setShelfList(list).then(() => {\r\n            this.moveToGroup(group)\r\n          })\r\n        }\r\n      },\r\n      onComplete() {\r\n        saveBookShelf(this.shelfList)\r\n        this.hide()\r\n        this.setIsEditMode(false)\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" rel=\"stylesheet/scss\" scoped>\r\n  @import '../../assets/styles/global';\r\n\r\n  .dialog-list-wrapper {\r\n    width: 100%;\r\n    padding: 0 px2rem(20);\r\n    box-sizing: border-box;\r\n    font-size: px2rem(14);\r\n    @include scroll;\r\n    .dialog-list-item {\r\n      display: flex;\r\n      padding: px2rem(15) 0;\r\n      box-sizing: border-box;\r\n      color: #666;\r\n      position: relative;\r\n      &.is-add {\r\n        color: $color-blue;\r\n        &:active {\r\n          color: $color-blue-transparent;\r\n        }\r\n      }\r\n      &:active {\r\n        color: rgba(102, 102, 102, 0.5);\r\n      }\r\n      .dialog-list-item-text {\r\n        flex: 1;\r\n      }\r\n      .dialog-list-icon-wrapper {\r\n        //flex: 0 0 px2rem(30);\r\n        color: $color-blue;\r\n        //@include right;\r\n        position: absolute;\r\n        right: px2rem(5);\r\n      }\r\n    }\r\n  }\r\n\r\n  .dialog-new-group-wrapper {\r\n    width: 100%;\r\n    padding: 0 px2rem(20);\r\n    box-sizing: border-box;\r\n    .dialog-input-title-wrapper {\r\n      font-size: px2rem(10);\r\n      margin-top: px2rem(20);\r\n    }\r\n    .dialog-input-wrapper {\r\n      width: 100%;\r\n      padding: 0 0 px2rem(30) 0;\r\n      box-sizing: border-box;\r\n      .dialog-input-inner-wrapper {\r\n        display: flex;\r\n        width: 100%;\r\n        padding: px2rem(10) 0;\r\n        box-sizing: border-box;\r\n        border-bottom: px2rem(1) solid #eee;\r\n        font-size: px2rem(14);\r\n        color: #666;\r\n        .dialog-input {\r\n          flex: 1;\r\n          border: none;\r\n          &:focus {\r\n            outline: none;\r\n          }\r\n        }\r\n        .dialog-input-clear-wrapper {\r\n          flex: 0 0 px2rem(30);\r\n          color: #ccc;\r\n          @include center;\r\n          &:active {\r\n            color: #999;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .group-dialog-btn-wrapper {\r\n    width: 100%;\r\n    @include center;\r\n  }\r\n\r\n  .dialog-btn {\r\n    flex: 1;\r\n    &.is-empty {\r\n      color: rgba(255, 255, 255, 0.5);\r\n    }\r\n    &:active {\r\n      color: rgba(255, 255, 255, 0.5);\r\n    }\r\n  }\r\n</style>\r\n"]}]}